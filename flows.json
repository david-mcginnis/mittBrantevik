[
    {
        "id": "8475ab9.3d26058",
        "type": "tab",
        "label": "Web App Socket Router",
        "disabled": false,
        "info": ""
    },
    {
        "id": "2b074b3a.632fb4",
        "type": "tab",
        "label": "Brantevik",
        "disabled": false,
        "info": ""
    },
    {
        "id": "e17f7487.2a78e8",
        "type": "tab",
        "label": "blinky-lite-dataLogger",
        "disabled": false,
        "info": ""
    },
    {
        "id": "90f83725.6dae08",
        "type": "tab",
        "label": "blinky-lite-Utility Apps",
        "disabled": false,
        "info": ""
    },
    {
        "id": "ca529822.9112f8",
        "type": "subflow",
        "name": "HTML",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 40,
                "wires": [
                    {
                        "id": "99bb1519.85fc18"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "f22a539a.a67b3",
        "type": "subflow",
        "name": "Core HTML",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "48e0f477.ea0e4c"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "8341090a.df9758",
        "type": "subflow",
        "name": "App HTML",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "a3eb7ad8.27c498"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "e13648d6.d698c8",
        "type": "subflow",
        "name": "Log Setting",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 160,
                "wires": [
                    {
                        "id": "347f36fe.94ed7a"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "2dba0745.a98d98",
        "type": "subflow",
        "name": "Role Check",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 120,
                "wires": [
                    {
                        "id": "3deefd6d.1dde92"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1120,
                "y": 60,
                "wires": [
                    {
                        "id": "f3358361.19029",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1120,
                "y": 120,
                "wires": [
                    {
                        "id": "f728a8f0.ad8b68",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "2d027d69.1fdeb2",
        "type": "subflow",
        "name": "App Role Check",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "3966deae.453262"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 320,
                "y": 60,
                "wires": [
                    {
                        "id": "3966deae.453262",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "495f0879.c831c8",
        "type": "subflow",
        "name": "Core Role Check",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 80,
                "y": 80,
                "wires": [
                    {
                        "id": "8e411315.2b09f"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 340,
                "y": 40,
                "wires": [
                    {
                        "id": "8e411315.2b09f",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "fee416c.fb205e8",
        "type": "subflow",
        "name": "Action Permission Check",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 80,
                "y": 80,
                "wires": [
                    {
                        "id": "54f691be.e6b47"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 760,
                "y": 40,
                "wires": [
                    {
                        "id": "92d40c38.2026a",
                        "port": 0
                    }
                ]
            },
            {
                "x": 760,
                "y": 120,
                "wires": [
                    {
                        "id": "92d40c38.2026a",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "d7162906.0afcd8",
        "type": "subflow",
        "name": "Public HTML",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "5346f693.8ea928"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "adce79c2.bd6fa8",
        "type": "subflow",
        "name": "Widget Html",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 80,
                "wires": [
                    {
                        "id": "132e93cb.ae000c"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "698c1306.31662c",
        "type": "subflow",
        "name": "mailfooter",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "1062d234.2ee27e"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 340,
                "y": 80,
                "wires": [
                    {
                        "id": "1062d234.2ee27e",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "3fec913b325ae6ff",
        "type": "subflow",
        "name": "HTTPS Check",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "30495fc00067bd92"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 300,
                "y": 40,
                "wires": [
                    {
                        "id": "30495fc00067bd92",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#487895",
        "icon": "font-awesome/fa-key"
    },
    {
        "id": "6ad7c930.1a06b8",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#000000",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey"
            }
        },
        "site": {
            "name": "Chill Detector",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "84d80994.260508",
        "type": "mqtt-broker",
        "name": "MQTT Broker",
        "broker": "$(MQTTSERVERIP)",
        "port": "1883",
        "clientid": "$(MQTTCLIENTID)",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "9cd5ff5e.caf86",
        "type": "mongodb3",
        "uri": "$(MONGODBIP)",
        "name": "blinky-lite",
        "options": "",
        "parallelism": "-1"
    },
    {
        "id": "6acefdd9.69f124",
        "type": "JsonWebToken_config",
        "name": "blinky-lite-core-jwt-key",
        "secret": "$(JWTKEYSECRET)"
    },
    {
        "id": "47794345.2e8b8c",
        "type": "websocket-listener",
        "path": "/access-log/websocket",
        "wholemsg": "false"
    },
    {
        "id": "fcd0f0f1.e1a0f",
        "type": "websocket-listener",
        "path": "/settings-log/websocket",
        "wholemsg": "false"
    },
    {
        "id": "c1211ec2.5887d",
        "type": "websocket-listener",
        "path": "/blinky-wind/websocket",
        "wholemsg": "false"
    },
    {
        "id": "fc576385.12f95",
        "type": "websocket-listener",
        "path": "/blinky-DS18B20/websocket",
        "wholemsg": "false"
    },
    {
        "id": "417794ff.011e5c",
        "type": "websocket-listener",
        "path": "/blinky-turnstile/websocket",
        "wholemsg": "false"
    },
    {
        "id": "dddd1a95.f87278",
        "type": "websocket-listener",
        "path": "/blinky-webcam/websocket",
        "wholemsg": "false"
    },
    {
        "id": "e865fc91.88a2a",
        "type": "websocket-listener",
        "path": "/brantevik-weather-widget/websocket",
        "wholemsg": "false"
    },
    {
        "id": "4fbbe9375c5eb4a7",
        "type": "websocket-listener",
        "path": "/w/websocket",
        "wholemsg": "false"
    },
    {
        "id": "b9df3f26.ab53f",
        "type": "template",
        "z": "ca529822.9112f8",
        "name": "HTML",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n{{{payload.head}}}\n  </head>\n  <body>\n{{{payload.navBar}}}\n{{{payload.html.websocket}}}\n{{{payload.body}}}\n{{{payload.foot}}}\n  </body>\n</html>",
        "output": "str",
        "x": 1150,
        "y": 40,
        "wires": [
            [
                "d1d9e12b.926ff"
            ]
        ]
    },
    {
        "id": "895ba39c.86e59",
        "type": "template",
        "z": "ca529822.9112f8",
        "name": "Foot",
        "field": "payload.foot",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div id=\"acknowledgeDialog\" title=\"Acknowledge\" class='card'>\n        <p class='card-title' id='acknowledgeDialogTitle'>Warning</p>\n        <div class='card-body'>\n            <p class='tableText' id='acknowledgeDialogText'>Text</p>\n        </div>\n    </div>\n    <div id=\"optionDialog\" title=\"Option\" class='card'>\n        <p class='card-title' id='optionDialogTitle'>Choice</p>\n        <div class='card-body'>\n            <p class='tableText' id='optionDialogText'>Text</p>\n        </div>\n    </div>\n    <div id=\"messageDialog\" title=\"Message\" class='card'>\n        <p class='card-title' id='messageDialogTitle'>Warning</p>\n        <div class='card-body'>\n            <p class='tableText' id='messageDialogText'>Text</p>\n        </div>\n    </div>\n    <script src=\"/scripts/popper.js\"></script>\n    <script src=\"/scripts/bootstrap.js\"></script>",
        "output": "str",
        "x": 690,
        "y": 40,
        "wires": [
            [
                "a9a62959.7c01e8"
            ]
        ]
    },
    {
        "id": "aa17ff35.7cdfd",
        "type": "template",
        "z": "ca529822.9112f8",
        "name": "Head",
        "field": "payload.head",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <meta charset=\"UTF-8\">\n    <link rel=\"icon\" href=\"/img/favicon.ico?v=4\" type=\"image/x-icon\"/>\n    <title>{{payload.title}}</title>\n    <link rel=\"stylesheet\" href=\"/css/bootstrap.css\"/>\n    <link rel=\"stylesheet\" href=\"/jquery/jquery-ui.css\"/>\n    <link rel=\"stylesheet\" href=\"/jquery/jquery-ui-timepicker-addon.css\"/>\n    <script src=\"/jquery/jquery.js\"></script>\n    <script src=\"/jquery/jquery-ui.js\"></script>\n    <script src=\"/jquery/jquery-ui-timepicker-addon.js\"></script>\n    <script src=\"/scripts/plotly-latest.min.js\"></script>\n    <script src=\"/scripts/pako.min.js\"></script>\n{{{payload.extraScripts}}}\n    <style>\n{{{payload.css}}}\n    </style>\n    <style>\n{{{payload.extraCss}}}\n    </style>\n    <script>\n{{{payload.utilityScripts}}}\n    </script>\n    <script>\n{{{payload.javascript}}}\n    </script>",
        "output": "str",
        "x": 570,
        "y": 40,
        "wires": [
            [
                "895ba39c.86e59"
            ]
        ]
    },
    {
        "id": "d1d9e12b.926ff",
        "type": "http response",
        "z": "ca529822.9112f8",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1270,
        "y": 40,
        "wires": []
    },
    {
        "id": "c4ed2505.8c07e8",
        "type": "template",
        "z": "ca529822.9112f8",
        "name": "Utility Scripts",
        "field": "payload.utilityScripts",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "        var remoteApp = true;\n        var ws;\n        var userID = -1;\n        var useWebSocketsFlag = true;\n        var project = '{{{payload.project}}}';\n        var heartBeatImage = false;\n        var wsUri = '';\n        var wsConnected = false;\n\n        function setRemoteApp(remoteAppSet)\n        {\n            remoteApp  = remoteAppSet;\n        }\n        function webSocketConnected()\n        {\n            return wsConnected;\n        }\n        function useWebSockets(webSocketsFlag)\n        {\n            useWebSocketsFlag = webSocketsFlag;\n        }\n        function wsConnectC()\n        {\n            if (!useWebSocketsFlag)\n            {\n                return;\n            }\n            if (wsUri.length < 1)\n            {\n                var uri = window.location.href.split('://');\n                var wslead = 'ws://';\n                if (uri[0] == 'https') wslead = 'wss://';\n                var questionLocation = uri[1].indexOf('?');\n                if (questionLocation >= 0)\n                {\n                    uri[1] = uri[1].substring(0,questionLocation);\n//                    console.log(uri[1]);\n                }\n                if (uri[1].indexOf('/') < (uri[1].length - 1))\n                {\n                    wsUri = wslead + uri[1] + '/websocket';\n                }\n                else\n                {\n                    wsUri = wslead + uri[1] + 'websocket';\n                }\n            }\n            ws = new WebSocket(wsUri);\n            ws.onmessage = function(event)\n            {\n                onWebSocketMessage(JSON.parse(event.data));\n        \n            };\n            ws.onopen = function()\n            {\n                console.log(\"Websocket connected\");\n                wsConnected = true;\n                $('#webSocketStatus').html('Open');\n                $('#reOpenWebSocketButton').hide();\n                $('#webSocketStatusRow').css('padding-bottom','0px');\n                $('#webSocketStatusCard').hide();\n                onWebSocketOpen();\n            };\n            ws.onclose = function()\n            {\n                console.log(\"Websocket closed\");\n                wsConnected = false;\n                $('#webSocketStatus').html('Closed');\n                $('#reOpenWebSocketButton').show();\n                $('#webSocketStatusCard').show();\n                $('#webSocketStatusRow').css('padding-bottom','25px');\n                onWebSocketClose();\n                wsConnectC();\n            };\n        }\n\n        function getRandomInt(max)\n        {\n          return Math.floor(Math.random() * Math.floor(max));\n        }\n        $( document ).ready(function()\n        {\n            userID  = {{{payload.userID}}};\n            if (!useWebSocketsFlag)\n            {\n                $('#webSocketStatusRow').css('padding-bottom','0px');\n                $('#webSocketStatusCard').hide();\n            }\n            wsConnectC();\n            onDocumentReady();\n       });\n        $( function() \n        {\n            $( \"#acknowledgeDialog\" ).dialog(\n                {\n                    width:    500,\n                    autoOpen: false,\n                    buttons:\n                    [\n                        {\n                            text: \"Ok\",\n                            click: function() { $( this ).dialog( \"close\" );},\n                            showText: false\n                        },\n                   ]\n                });\n            $( \"#messageDialog\" ).dialog(\n                {\n                    width:    500,\n                    autoOpen: false,\n                    buttons:[]\n                });\n        } );\n        function optionDialog(headerText, title, text, buttonTexts, buttonFunctions)\n        {\n            var buttonDefinitions = [];\n            for (var ii = 0; ii < buttonTexts.length; ++ii)\n            {\n                buttonDefinitions[ii] = \n                    {\n                        text: buttonTexts[ii],\n                        click: buttonFunctions[ii],\n                        showText: false\n                    };\n            }\n            $( \"#optionDialog\" ).dialog( \"option\", \"title\", headerText );   \n            $( \"#optionDialog\" ).dialog( \"option\", \"buttons\", buttonDefinitions);\n            $( \"#optionDialogTitle\" ).html(title);\n            $( \"#optionDialogText\" ).html(text);\n            $( \"#optionDialog\" ).dialog( \"open\" );\n        }\n        $( function() \n        {\n            $( \"#optionDialog\" ).dialog(\n                {\n                    width:    500,\n                    autoOpen: false,\n                    buttons:\n                    [\n                        {\n                            text: \"Ok\",\n                            click: function() {$( this ).dialog( \"close\" );},\n                            showText: false\n                        },\n                        {\n                            text: \"Cancel\",\n                            click: function() {$( this ).dialog( \"close\" );},\n                            showText: false\n                        },\n                   ]\n                });\n        } );\n        function acknowledgeDialog(headerText, title, text)\n        {\n            $( \"#acknowledgeDialog\" ).dialog( \"option\", \"title\", headerText );    \n            $( \"#acknowledgeDialogTitle\" ).html(title);\n            $( \"#acknowledgeDialogText\" ).html(text);\n            $( \"#acknowledgeDialog\" ).dialog( \"open\" );\n        }\n        function messageDialog(headerText, title, text)\n        {\n            $( \"#messageDialog\" ).dialog( \"option\", \"title\", headerText );    \n            $( \"#messageDialogTitle\" ).html(title);\n            $( \"#messageDialogText\" ).html(text);\n            $( \"#messageDialog\" ).dialog( \"open\" );\n        }\n        function heartbeat()\n        {\n            heartBeatImage = !heartBeatImage;\n            var heartBeatImageSrc = '/img/heartRed.png';\n            if (heartBeatImage) heartBeatImageSrc = '/img/heartPink.png';\n            $('#heartBeatID').attr('src',heartBeatImageSrc);\n        }\n        function getCookie(extension)\n        {\n            var cookies = document.cookie.split(';');\n            var token = null;\n            var cookieName = project + extension + \"=\";\n            for (var icookie = 0; icookie < cookies.length; ++icookie)\n            {\n                var index = cookies[icookie].indexOf(cookieName);\n                if (index >= 0)\n                {\n                    token = cookies[icookie].substring(index + cookieName.length);\n                }\n            }\n            return token;\n        }\n        function sendActionMsg(topic,role,actionMsg)\n        {\n            var roleToken = \"\";\n            if (remoteApp) roleToken  = getCookie('Role');\n            if (roleToken == null)\n            {\n                location.reload();\n                return;\n            }\n            var webSocketMsg = \n            {\n                topic     : topic,\n                payload   : actionMsg,\n                userID    : userID,\n                token     : getCookie('Role'),\n                role      : role\n            };\n            ws.send(JSON.stringify(webSocketMsg));\n        }\n",
        "output": "str",
        "x": 430,
        "y": 40,
        "wires": [
            [
                "aa17ff35.7cdfd"
            ]
        ]
    },
    {
        "id": "99bb1519.85fc18",
        "type": "function",
        "z": "ca529822.9112f8",
        "name": "Get project name and userID",
        "func": "function getRandomInt(max)\n{\n  return Math.floor(Math.random() * Math.floor(max));\n}\nmsg.payload['project'] = global.get('project')\nmsg.payload['userID'] = getRandomInt(32768);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 220,
        "y": 40,
        "wires": [
            [
                "c4ed2505.8c07e8"
            ]
        ]
    },
    {
        "id": "a9a62959.7c01e8",
        "type": "template",
        "z": "ca529822.9112f8",
        "name": "html.websocket",
        "field": "payload.html.websocket",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- websocket status HTML -->\n    <div width=\"100%\">\n        <div class='row' id='webSocketStatusRow' style='padding-bottom: 0px;'>\n            <div class='col-md-12' align='center'>\n\n                <div class='card' id='webSocketStatusCard' >\n                    <p class='card-title'>Web Socket Status</p>\n                    <div class='card-body' align=\"center\">\n                        <div class='row'  style='padding-top: 0px;'>\n                            <table width='100%'>\n                                <tr>\n                                    <td width='60%' >\n                                        <span class='card-text' >Websocket Status</span>\n                                    </td>\n                                    <td width='20%' align='center'>\n                                        <button class='btn card-button btn-block big-text' id='reOpenWebSocketButton' onclick=\"wsConnectC()\">Re-open</button>\n                                    </td>\n                                    <td width='20%' align='center'>\n                                        <span class='card-text' id='webSocketStatus' >Closed</span>\n                                   </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n",
        "output": "str",
        "x": 840,
        "y": 40,
        "wires": [
            [
                "35ffcf83.1547"
            ]
        ]
    },
    {
        "id": "f46a4c46.e6b3a",
        "type": "mongodb3 in",
        "z": "ca529822.9112f8",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "accessLog",
        "operation": "insertOne",
        "x": 1090,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "35ffcf83.1547",
        "type": "function",
        "z": "ca529822.9112f8",
        "name": "IP filter",
        "func": "var ipfilter = [\n    \"127.0.0.16\"];\nvar ipAddress = ( msg.req.headers['x-forwarded-for'] || '').split(',').pop() || \n          msg.req.connection.remoteAddress || \n          msg.req.socket.remoteAddress || \n          msg.req.connection.socket.remoteAddress;\nif (ipAddress==undefined) return null;\nvar ipAddressSplit = ipAddress.split(\".\");\nfor (var ii =  0; ii < ipfilter.length; ++ii)\n{\n    var ipfilterSplit = ipfilter[ii].split(\".\");\n    if (ipAddress == ipfilter[ii])\n    { \n        return null;\n    }\n    if (ipfilterSplit[2] == '*')\n    {\n        if ((ipfilterSplit[0] == ipAddressSplit[0]) && (ipfilterSplit[1] == ipAddressSplit[1]))\n        {\n            return null;\n        }\n    }\n}\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 990,
        "y": 40,
        "wires": [
            [
                "b9df3f26.ab53f",
                "41efb541.ee2eec"
            ]
        ]
    },
    {
        "id": "9ac12bdb.3cd258",
        "type": "function",
        "z": "ca529822.9112f8",
        "name": "parseIpRequest",
        "func": "var data = msg.payload.data.geo;\ndata['url'] = 'mittbrantevik' + msg.extraInfo.url;\ndata['userID'] = msg.extraInfo.userID;\ndata['timeStamp'] = new Date().getTime();\nreturn {topic:'ipData', payload:data};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 180,
        "wires": [
            [
                "f46a4c46.e6b3a"
            ]
        ]
    },
    {
        "id": "de38cb39.638048",
        "type": "http request",
        "z": "ca529822.9112f8",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://tools.keycdn.com/geo.json?host={{{payload.ipAddress}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1030,
        "y": 140,
        "wires": [
            [
                "9ac12bdb.3cd258"
            ]
        ]
    },
    {
        "id": "41efb541.ee2eec",
        "type": "function",
        "z": "ca529822.9112f8",
        "name": "ClientInfo",
        "func": "var ipAddress = ( msg.req.headers['x-forwarded-for'] || '').split(',').pop() || \n          msg.req.connection.remoteAddress || \n          msg.req.socket.remoteAddress || \n          msg.req.connection.socket.remoteAddress;\nvar url = msg.req.url;\nvar header = {};\nheader['User-Agent'] = 'keycdn-tools:' + global.get('ipRefWeb');\nreturn {\n    topic:'clientInfo', \n    headers: header,\n    payload:{\n        ipAddress   : ipAddress\n    },\n    extraInfo       : {url:url, userID:msg.payload.userID},\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1020,
        "y": 100,
        "wires": [
            [
                "de38cb39.638048"
            ]
        ]
    },
    {
        "id": "8a439be9.030ab8",
        "type": "subflow:ca529822.9112f8",
        "z": "f22a539a.a67b3",
        "name": "",
        "x": 410,
        "y": 80,
        "wires": []
    },
    {
        "id": "48e0f477.ea0e4c",
        "type": "template",
        "z": "f22a539a.a67b3",
        "name": "CSS",
        "field": "payload.css",
        "fieldType": "msg",
        "format": "css",
        "syntax": "mustache",
        "template": "        :root \n        {\n          --color1: #415c71;\n          --color2: #547792;\n          --color3: #9eb5c7;\n          --color4: #c6c2bb;\n          --color5: #fdc300;\n          --big-text-size :300%;\n          --bold-text :900;\n          --vert-pad : 25px;\n          --horz-pad : 25px;\n        }\n        body \n        {\n          background-color: white;\n          padding-left:25px;\n          padding-right:25px;\n        }\n        img \n        {\n          object-fit: contain;\n        }\n        a\n        {\n            color: white;\n        }\n        a:visited \n        { \n            color: var(--white);\n        }\n        a:hover \n        { \n            color: var(--color5);\n        }\n        .jumbotron \n        {\n          background-color: var(--color2) !important;\n          color:var(--white);\n          padding-bottom: 10px;\n          padding-top: 10px;\n        }\n        .jumbotron-title\n        {\n          color:var(--color5);\n        }\n        .jumbotron-button\n        {\n          color: white;\n          background-color: var(--color1);\n          font-weight: 900;\n        }\n        .card\n        {\n          background-color: var(--color2) !important;\n          text-align: center;\n          padding: 10px;\n        }\n        .card-body\n        {\n          background-color: var(--color3);\n        }\n        .card-button\n        {\n          color: var(--color5);\n          background-color: var(--color1) !important;\n          font-weight: bold;\n        }\n        .card-title\n        {\n          color: var(--color5);\n          font-weight: bold;\n        }\n        .card-text\n        {\n          color: white;\n          text-align: left;\n        }\n        .tableHeading\n        {\n          color:var(--color1);\n          font-weight: 900;\n        }\n        .tableText\n        {\n          color:var(--color1);\n          font-weight: 900;\n        }\n        .custom-select\n        {\n          color: white;\n          background-color: var(--color3);\n        \n        }\n        .form-control\n        {\n          text-align: center;\n        }\n        .checkbox-align\n        {\n          vertical-align: middle;\n          text-align: center;\n        }\n        .csv-linked\n        {\n            color: blue;\n        }\n        .csv-unlinked\n        {\n            color: red;\n        }\n        .vert-pad\n        {\n            padding-top:var(--vert-pad);;\n            padding-bottom:var(--vert-pad);;\n        }\n        .horz-pad\n        {\n            padding-left:var(--horz-pad);;\n            padding-right:var(--horz-pad);;\n        }\n        .big-text\n        {\n            font-size: var(--big-text-size);\n        }\n        .bold-text\n        {\n            font-weight: var(--bold-text);\n        }\n        .ui-dialog-titlebar-close \n        {\n            visibility: hidden;\n        }\n        div.ui-datepicker\n        {\n            font-size:30px;\n        }",
        "output": "str",
        "x": 150,
        "y": 80,
        "wires": [
            [
                "b7076b42.4012e8"
            ]
        ]
    },
    {
        "id": "b7076b42.4012e8",
        "type": "template",
        "z": "f22a539a.a67b3",
        "name": "navBar",
        "field": "payload.navBar",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div class=\"jumbotron\" width=\"100%\">\n        <table width=\"100%\">\n            <tr>\n                <td style=\"text-align:left; vertical-align:middle;\"  width=\"20%\">\n                    <a href='/' >\n                        <img src=\"/img/bl-mc-icon-inverse.png\" height=\"75px\"/>\n                    </a>                \n                </td>\n                <td width=\"60%\" style=\"text-align:center; vertical-align:middle;\">\n                    <h1 class=\"jumbotron-title big-text bold-text\">{{{payload.title}}}</h1>\n                </td>\n                <td style=\"text-align:right; vertical-align:middle;\" width=\"20%\">\n                    <a href='/core'><img src=\"/img/coreYellow.png\" height=\"75px\"/></a>\n                </td>\n            </tr>\n        </table>\n    </div>\n    \n",
        "output": "str",
        "x": 280,
        "y": 80,
        "wires": [
            [
                "8a439be9.030ab8"
            ]
        ]
    },
    {
        "id": "9460eaf0.da7628",
        "type": "subflow:ca529822.9112f8",
        "z": "8341090a.df9758",
        "name": "",
        "x": 410,
        "y": 80,
        "wires": []
    },
    {
        "id": "a3eb7ad8.27c498",
        "type": "template",
        "z": "8341090a.df9758",
        "name": "CSS",
        "field": "payload.css",
        "fieldType": "msg",
        "format": "css",
        "syntax": "mustache",
        "template": "        :root \n        {\n          --color1: #1c6e97;\n          --color2: #289dd7;\n          --color3: #e7e7e7;\n          --color4: #c6c2bb;\n          --color5: #ffffff;\n          --color6: #289dd7;\n          --big-text-size :300%;\n          --bold-text :900;\n          --vert-pad : 25px;\n          --horz-pad : 25px;\n        }\n        body \n        {\n          background-color: white !important;\n          padding-left:25px;\n          padding-right:25px;\n        }\n        \n        img \n        {\n          object-fit: contain;\n        }\n        a\n        {\n            color: white;\n        }\n        a:visited \n        { \n            color: var(--white);\n        }\n        a:hover \n        { \n            color: var(--color5);\n        }\n\n        .jumbotron \n        {\n          background-color: var(--color2) !important;\n          color: white;\n          padding-top:25px;\n          padding-bottom:25px;\n        }\n        .jumbotron-title\n        {\n          color:var(--color5);\n        }\n        .jumbotron-button\n        {\n          color: white;\n          background-color: var(--color1);\n       }\n        .card\n        {\n          background-color: var(--color2) !important;\n          text-align: center;\n        }\n        .card-body\n        {\n          background-color: var(--color3);;\n        }\n        .card-button\n        {\n          color: var(--color5) !important;\n          background-color: var(--color1) !important;\n          font-weight: bold;\n        }\n        .card-title\n        {\n          color: var(--color5);\n          font-weight: var(--bold-text);\n          font-size: var(--big-text-size);\n         }\n        .card-text\n        {\n          color: white;\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .danger-card\n        {\n          background-color: yellow !important;\n          text-align: center;\n        }\n        .danger-card-body\n        {\n          background-color: yellow;\n        }\n        .danger-card-button\n        {\n          color: yellow !important;\n          background-color: red !important;\n          font-weight: bold;\n        }\n        .danger-card-title\n        {\n          color: red;\n          font-weight: var(--bold-text);\n          font-size: var(--big-text-size);\n         }\n        .danger-card-text\n        {\n          color: white;\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .tableHeading\n        {\n          color:var(--container-title-color);\n        }\n        .tableText\n        {\n          color:var(--container-text-color);\n          font-size: var(--big-text-size);\n        }\n       .vert-pad\n        {\n            padding-top:var(--vert-pad);;\n            padding-bottom:var(--vert-pad);;\n        }\n        .horz-pad\n        {\n            padding-left:var(--horz-pad);;\n            padding-right:var(--horz-pad);;\n        }\n        .big-text\n        {\n            font-size: var(--big-text-size);\n        }\n        .bold-text\n        {\n            font-weight: var(--bold-text);\n        }\n       .ui-dialog-titlebar-close \n        {\n            visibility: hidden;\n        }\n        input.inputLarger \n        { \n            transform: scale(3); \n            margin: 1px;\n        }\n        .googleSlide4by3-container \n        {\n            position: relative;\n            overflow: hidden;\n            padding-top: 75.0%;\n        }\n        .googleSlide4by3-iframe {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            border: 0;\n        }        \n        .custom-select\n        {\n            color: black;\n            background-color: white;\n            height:80px;\n            line-height:70px;\n        }\n",
        "output": "str",
        "x": 150,
        "y": 80,
        "wires": [
            [
                "6f95e75a.75d6d8"
            ]
        ]
    },
    {
        "id": "6f95e75a.75d6d8",
        "type": "template",
        "z": "8341090a.df9758",
        "name": "navBar",
        "field": "payload.navBar",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- navBar -->\n    <div class=\"jumbotron\" width=\"100%\">\n        <table width=\"100%\">\n            <tr>\n                <td style=\"text-align:left; vertical-align:middle;\"  width=\"20%\">\n                    <a href='/' >\n                        <img src=\"/img/bl-mc-icon-inverse.png\" height=\"75px\"/>\n                    </a>                \n                </td>\n                <td width=\"60%\" style=\"text-align:center; vertical-align:middle;\">\n                    <h1 class=\"jumbotron-title big-text bold-text\">\n                        <img src=\"/img/{{{payload.navBarIcon}}}\" height=\"75px\" style=\"padding-right:20px;\"/><span>{{{payload.title}}}</span>\n                    </h1>\n                </td>\n                <td style=\"text-align:right; vertical-align:middle;\" width=\"20%\">\n                    <a href='/control-apps'><img src=\"/img/home.png\" height=\"75px\"/></a>\n                </td>\n            </tr>\n        </table>\n    </div>",
        "output": "str",
        "x": 280,
        "y": 80,
        "wires": [
            [
                "9460eaf0.da7628"
            ]
        ]
    },
    {
        "id": "347f36fe.94ed7a",
        "type": "function",
        "z": "e13648d6.d698c8",
        "name": "Setup accessLog Query",
        "func": "var projectionFilter =  \n{\n    projection:\n    {\n        _id                         :   0, \n    } \n};\nvar queryFilter = \n{\n    userID: msg.userID\n}\nvar settingLogEntry = {topic:msg.topic, userID: msg.userID, device:msg.payload, timeStamp: new Date().getTime()};\nvar newMsg = \n{\n    topic           : 'getAccessLog',\n    payload         : [queryFilter, projectionFilter],\n    settingLogEntry : settingLogEntry\n};\nreturn newMsg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 250,
        "y": 160,
        "wires": [
            [
                "e24c42fb.5b61a"
            ]
        ]
    },
    {
        "id": "e24c42fb.5b61a",
        "type": "mongodb3 in",
        "z": "e13648d6.d698c8",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "accessLog",
        "operation": "findOne",
        "x": 500,
        "y": 160,
        "wires": [
            [
                "c006fe2c.abbb1"
            ]
        ]
    },
    {
        "id": "c006fe2c.abbb1",
        "type": "function",
        "z": "e13648d6.d698c8",
        "name": "setup settingLogEntry",
        "func": "var settingLogEntry = \n{\n    topic       :   msg.settingLogEntry.topic, \n    userID      :   msg.settingLogEntry.userID,\n    device      :   msg.settingLogEntry.device,\n    timeStamp   :   msg.settingLogEntry.timeStamp,\n    ipInfo      :   msg.payload\n}\nreturn {topic: 'settingLogEntry', payload: settingLogEntry};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 160,
        "wires": [
            [
                "9c60f57c.b85078"
            ]
        ]
    },
    {
        "id": "9c60f57c.b85078",
        "type": "mongodb3 in",
        "z": "e13648d6.d698c8",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "settingsLog",
        "operation": "insertOne",
        "x": 990,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "29822a72.7731e6",
        "type": "JsonWebToken",
        "z": "2dba0745.a98d98",
        "name": "decrypt Token",
        "tokenconfig": "6acefdd9.69f124",
        "x": 400,
        "y": 60,
        "wires": [
            [
                "f3358361.19029"
            ]
        ]
    },
    {
        "id": "3deefd6d.1dde92",
        "type": "function",
        "z": "2dba0745.a98d98",
        "name": "Check for Project Cookies",
        "func": "var projectCookie = msg.req.cookies[global.get('project') + 'Role'];\nif(projectCookie == undefined)\n{\n    msg.cookies = { };\n    msg.payload.errorMsg = \"Credentials needed\";\n    return [null,msg];\n}\nmsg.token = projectCookie;\nmsg.payload['roleToken'] = msg.token;\nreturn [msg,null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 190,
        "y": 120,
        "wires": [
            [
                "29822a72.7731e6"
            ],
            [
                "c0be6557.9ceae8"
            ]
        ]
    },
    {
        "id": "f3358361.19029",
        "type": "function",
        "z": "2dba0745.a98d98",
        "name": "Check permitted roles",
        "func": "var tokenError = msg.error;\nif (tokenError != undefined)\n{\n    msg.payload.errorMsg = tokenError;\n    msg.cookies = { };\n    return [null,msg];\n}\nif (msg.token.expDate > 0)\n{\n    if (msg.token.expDate < new Date().getTime())\n    {\n        msg.payload.errorMsg = 'Login Expired. Please login again';\n        msg.cookies = { };\n        return [null,msg];\n    }\n}\nvar permittedRole = false;\nfor (irole = 0; irole < msg.payload.allowedRoles.length; ++irole)\n{\n    for (itoken = 0; itoken < msg.token.roles.length; ++itoken)\n    {\n        if (msg.token.roles[itoken] == msg.payload.allowedRoles[irole]) permittedRole = true;\n    }\n}\nif (!permittedRole)\n{\n    msg.payload.errorMsg = 'Credentials not valid for App';\n    msg.cookies = { };\n    return [null,msg];\n}\nmsg.payload['profile'] = JSON.stringify(msg.token);\nreturn [msg,null];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 600,
        "y": 60,
        "wires": [
            [],
            [
                "c0be6557.9ceae8"
            ]
        ]
    },
    {
        "id": "f728a8f0.ad8b68",
        "type": "template",
        "z": "2dba0745.a98d98",
        "name": "Body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- Body HTML -->\n    <h1 style=\"text-align:center;color:#415c71;\">{{{payload.errorMsg}}}</h1>\n    <form action=\"/process-login\" method=\"POST\">\n        <table align='center'>\n            <tr>\n                <td>\n                    <label for=\"username\" class=\"big-text\">User</label>\n                </td>\n                <td>\n                    <input name=\"username\" type=\"text\" class=\"big-text\"/>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label for=\"password\" class=\"big-text\">Password</label>\n                </td>\n                <td>\n                    <input name=\"password\" type=\"password\" class=\"big-text\"/>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                </td>\n                <td>\n                    <input type=\"submit\" class=\"btn jumbotron-button btn-block big-text bold-text\"/>\n                </td>\n            </tr>\n        </table>    \n        <input type=\"hidden\" name=\"url\" value=\"{{{req.url}}}\" />\n    </form>  ",
        "output": "str",
        "x": 1030,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "9c382ca2.1a311",
        "type": "template",
        "z": "2dba0745.a98d98",
        "name": "Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Log-in",
        "output": "str",
        "x": 750,
        "y": 120,
        "wires": [
            [
                "5896b9d2.764738"
            ]
        ]
    },
    {
        "id": "c0be6557.9ceae8",
        "type": "template",
        "z": "2dba0745.a98d98",
        "name": "JavaScript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "        useWebSockets(false);\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n\n",
        "output": "str",
        "x": 610,
        "y": 120,
        "wires": [
            [
                "9c382ca2.1a311"
            ]
        ]
    },
    {
        "id": "5896b9d2.764738",
        "type": "template",
        "z": "2dba0745.a98d98",
        "name": "navBarIcon",
        "field": "payload.navBarIcon",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "basicYellow.png",
        "output": "str",
        "x": 890,
        "y": 120,
        "wires": [
            [
                "f728a8f0.ad8b68"
            ]
        ]
    },
    {
        "id": "3966deae.453262",
        "type": "subflow:2dba0745.a98d98",
        "z": "2d027d69.1fdeb2",
        "name": "",
        "x": 200,
        "y": 80,
        "wires": [
            [],
            [
                "6a38d804.df8fa8"
            ]
        ]
    },
    {
        "id": "6a38d804.df8fa8",
        "type": "subflow:8341090a.df9758",
        "z": "2d027d69.1fdeb2",
        "name": "",
        "x": 370,
        "y": 120,
        "wires": []
    },
    {
        "id": "8e411315.2b09f",
        "type": "subflow:2dba0745.a98d98",
        "z": "495f0879.c831c8",
        "name": "",
        "x": 200,
        "y": 80,
        "wires": [
            [],
            [
                "ecfe972c.7c72e8"
            ]
        ]
    },
    {
        "id": "ecfe972c.7c72e8",
        "type": "subflow:f22a539a.a67b3",
        "z": "495f0879.c831c8",
        "name": "",
        "x": 370,
        "y": 100,
        "wires": []
    },
    {
        "id": "54f691be.e6b47",
        "type": "json",
        "z": "fee416c.fb205e8",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 200,
        "y": 80,
        "wires": [
            [
                "7de7a240.cf57fc"
            ]
        ]
    },
    {
        "id": "7de7a240.cf57fc",
        "type": "function",
        "z": "fee416c.fb205e8",
        "name": "Shift msg",
        "func": "return msg.payload;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 340,
        "y": 80,
        "wires": [
            [
                "632b2f1c.15e43"
            ]
        ]
    },
    {
        "id": "632b2f1c.15e43",
        "type": "JsonWebToken",
        "z": "fee416c.fb205e8",
        "name": "roleToken",
        "tokenconfig": "6acefdd9.69f124",
        "x": 480,
        "y": 80,
        "wires": [
            [
                "92d40c38.2026a"
            ]
        ]
    },
    {
        "id": "92d40c38.2026a",
        "type": "function",
        "z": "fee416c.fb205e8",
        "name": "Check Role",
        "func": "var errMsg = null;\nvar tokenError = msg.error;\nif (tokenError != undefined)\n{\n    errMsg = \n    {\n        topic : msg.topic, \n        payload:\n        {\n            topic:'badToken', \n            payload: msg.topic + \" badToken\",\n            userID : msg.userID,\n            role   : msg.role\n        }\n    };\n    return [null,errMsg];\n}\nif (msg.token.expDate > 0)\n{\n    if (msg.token.expDate < new Date().getTime())\n    {\n        errMsg = \n        {\n            topic : msg.topic, \n            payload:\n            {\n                topic:'loginExpired', \n                payload: msg.topic + \" login expired\",\n                userID : msg.userID,\n                role   : msg.role\n            }\n        };\n        return [null,errMsg];\n    }\n}\npermittedRole = false;\nfor (itoken = 0; itoken < msg.token.roles.length; ++itoken)\n{\n    if (msg.token.roles[itoken] == msg.role) permittedRole = true;\n}\nif (permittedRole) return [msg,null];\n\nerrMsg = \n{\n    topic : msg.topic, \n    payload:\n    {\n        topic  : 'permissionError', \n        payload: msg.topic + \" not permitted\",\n        userID : msg.userID,\n        role   : msg.role\n    }\n};\n\nreturn [null,errMsg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 630,
        "y": 80,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "30c36625.0c37ca",
        "type": "subflow:ca529822.9112f8",
        "z": "d7162906.0afcd8",
        "name": "",
        "x": 450,
        "y": 80,
        "wires": []
    },
    {
        "id": "5346f693.8ea928",
        "type": "template",
        "z": "d7162906.0afcd8",
        "name": "CSS",
        "field": "payload.css",
        "fieldType": "msg",
        "format": "css",
        "syntax": "mustache",
        "template": "        :root \n        {\n          --color1: #083357;\n          --color2: #487895;\n          --color3: #e7e7e7;\n          --color4: #c6c2bb;\n          --color5: #ffffff;\n          --big-text-size :300%;\n          --bold-text :900;\n          --vert-pad : 25px;\n          --horz-pad : 25px;\n        }\n        body \n        {\n            background-color: var(--color1) !important;\n            margin: auto;\n            padding-left:25px;\n            padding-right:25px;\n        }\n        \n        img \n        {\n          object-fit: contain;\n        }\n        a\n        {\n            color: var(--color5);\n        }\n        a:visited \n        { \n            color: var(--color5);\n        }\n        a:hover \n        { \n            color: var(--color5);\n        }\n\n        .jumbotron \n        {\n          background-color: var(--color1) !important;\n          color: var(--color5);\n          padding-top:25px;\n          padding-bottom:25px;\n        }\n        .jumbotron-title\n        {\n          color:var(--color5);\n        }\n        .jumbotron-button\n        {\n          color: var(--color5);\n          background-color: var(--color1);\n       }\n        .card\n        {\n          background-color: var(--color1) !important;\n          text-align: center;\n          border-style: solid;\n          border-width: 5px;\n          border-color: var(--color5);\n        }\n        .card-body\n        {\n          background-color: var(--color3);;\n        }\n        .card-button\n        {\n          color: var(--color5) !important;\n          background-color: var(--color1) !important;\n          font-size: 300%;\n/*          font-weight: var(--bold-text); */\n        }\n        .card-title\n        {\n          color: var(--color5);\n/*          font-weight: var(--bold-text);*/\n          font-size: var(--big-text-size); \n         }\n        .card-text\n        {\n          color: var(--color5);\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .tableHeading\n        {\n          color:var(--container-title-color);\n        }\n        .tableText\n        {\n          color:var(--container-text-color);\n          font-size: var(--big-text-size);\n        }\n       .vert-pad\n        {\n            padding-top:var(--vert-pad);;\n            padding-bottom:var(--vert-pad);;\n        }\n        .horz-pad\n        {\n            padding-left:var(--horz-pad);;\n            padding-right:var(--horz-pad);;\n        }\n        .big-text\n        {\n            font-size: var(--big-text-size);\n        }\n        .bold-text\n        {\n            font-weight: var(--bold-text);\n        }\n        .back-button\n        {\n          color: var(--color5) !important;\n          background-color: var(--color1) !important;\n          font-size: 200%;\n          border: 2px solid var(--color5);\n/*          font-weight: var(--bold-text); */\n        }\n/* from https://www.w3schools.com/howto/howto_js_slideshow.asp */\n        /* Slideshow container */\n        .slideshow-container \n        {\n/*            max-width: 1000px; */\n            position: relative;\n            margin: auto;\n        }\n        \n        /* Hide the images by default */\n        .slideshowSlides \n        {\n            display: none; \n        }\n        \n        \n        /* Fading animation */\n        .fade \n        {\n            animation-name: fade;\n            animation-duration: 3.0s;\n        }\n        \n        @keyframes fade \n        {\n            from {opacity: .3}\n            to {opacity: 1}\n        }\n",
        "output": "str",
        "x": 190,
        "y": 80,
        "wires": [
            [
                "e4d7483b.d4bae8"
            ]
        ]
    },
    {
        "id": "e4d7483b.d4bae8",
        "type": "template",
        "z": "d7162906.0afcd8",
        "name": "navBar",
        "field": "payload.navBar",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- navBar -->\n    <div class='row' style=\"padding-top:10px;\">\n        <div class='col-12' align='center'>\n            <table width=\"900px\" background=\"/img/brantevikBanner.png\">\n                <tr>\n                    <td width=\"150px\" align=\"right\" style=\"padding-top:25px;padding-bottom:25px;padding-right:25px;\">\n                        <!-- <a href='/'><img src=\"/img/upArrow.png\" height=\"75px\"/></a> -->\n                    </td>\n                    <td width=\"600px\" align=\"center\" style=\"padding-top:25px;padding-bottom:25px;\">\n                        <h1 class=\"jumbotron-title big-text bold-text\">\n                            <span>Mitt Brantevik</span>\n                        </h1>\n                    </td>\n                    <td width=\"150px\" align=\"right\" style=\"padding-top:25px;padding-bottom:25px;padding-right:25px;\">\n                        <!-- <a href='/'><img src=\"/img/home.png\" height=\"75px\"/></a> -->\n                    </td>\n               </tr>\n            </table>\n        </div>\n    </div>\n",
        "output": "str",
        "x": 320,
        "y": 80,
        "wires": [
            [
                "30c36625.0c37ca"
            ]
        ]
    },
    {
        "id": "56f5d51f.3bd8bc",
        "type": "template",
        "z": "adce79c2.bd6fa8",
        "name": "HTML",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n{{{payload.head}}}\n  </head>\n  <body>\n{{{payload.body}}}\n{{{payload.foot}}}\n  </body>\n</html>",
        "output": "str",
        "x": 1130,
        "y": 80,
        "wires": [
            [
                "55c86631.39a728"
            ]
        ]
    },
    {
        "id": "687f3503.18d94c",
        "type": "template",
        "z": "adce79c2.bd6fa8",
        "name": "Foot",
        "field": "payload.foot",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <script src=\"/scripts/popper.js\"></script>\n    <script src=\"/scripts/bootstrap.js\"></script>",
        "output": "str",
        "x": 670,
        "y": 80,
        "wires": [
            [
                "b9f0df99.46a35"
            ]
        ]
    },
    {
        "id": "25f0c237.ce8a1e",
        "type": "template",
        "z": "adce79c2.bd6fa8",
        "name": "Head",
        "field": "payload.head",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <meta charset=\"UTF-8\">\n    <link rel=\"icon\" href=\"/img/favicon.ico?v=4\" type=\"image/x-icon\"/>\n    <title>{{payload.title}}</title>\n    <link rel=\"stylesheet\" href=\"/css/bootstrap.css\"/>\n    <link rel=\"stylesheet\" href=\"/jquery/jquery-ui.css\"/>\n    <link rel=\"stylesheet\" href=\"/jquery/jquery-ui-timepicker-addon.css\"/>\n    <script src=\"/jquery/jquery.js\"></script>\n    <script src=\"/jquery/jquery-ui.js\"></script>\n    <script src=\"/jquery/jquery-ui-timepicker-addon.js\"></script>\n    <script src=\"/scripts/plotly-latest.min.js\"></script>\n    <script src=\"/scripts/pako.min.js\"></script>\n{{{payload.extraScripts}}}\n    <style>\n{{{payload.css}}}\n    </style>\n    <style>\n{{{payload.extraCss}}}\n    </style>\n    <script>\n{{{payload.utilityScripts}}}\n    </script>\n    <script>\n{{{payload.javascript}}}\n    </script>",
        "output": "str",
        "x": 550,
        "y": 80,
        "wires": [
            [
                "687f3503.18d94c"
            ]
        ]
    },
    {
        "id": "55c86631.39a728",
        "type": "http response",
        "z": "adce79c2.bd6fa8",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1250,
        "y": 80,
        "wires": []
    },
    {
        "id": "a38619a7.d98538",
        "type": "template",
        "z": "adce79c2.bd6fa8",
        "name": "Utility Scripts",
        "field": "payload.utilityScripts",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "        var remoteApp = true;\n        var ws;\n        var userID = -1;\n        var useWebSocketsFlag = true;\n        var project = '{{{payload.project}}}';\n        var heartBeatImage = false;\n        var wsUri = '';\n        var wsConnected = false;\n\n        function setRemoteApp(remoteAppSet)\n        {\n            remoteApp  = remoteAppSet;\n        }\n        function webSocketConnected()\n        {\n            return wsConnected;\n        }\n        function useWebSockets(webSocketsFlag)\n        {\n            useWebSocketsFlag = webSocketsFlag;\n        }\n        function wsConnectC()\n        {\n            if (!useWebSocketsFlag)\n            {\n                return;\n            }\n            if (wsUri.length < 1)\n            {\n                var uri = window.location.href.split('://');\n                var wslead = 'ws://';\n                if (uri[0] == 'https') wslead = 'wss://';\n                var questionLocation = uri[1].indexOf('?');\n                if (questionLocation >= 0)\n                {\n                    uri[1] = uri[1].substring(0,questionLocation);\n//                    console.log(uri[1]);\n                }\n                if (uri[1].indexOf('/') < (uri[1].length - 1))\n                {\n                    wsUri = wslead + uri[1] + '/websocket';\n                }\n                else\n                {\n                    wsUri = wslead + uri[1] + 'websocket';\n                }\n            }\n            ws = new WebSocket(wsUri);\n            ws.onmessage = function(event)\n            {\n                onWebSocketMessage(JSON.parse(event.data));\n        \n            };\n            ws.onopen = function()\n            {\n                console.log(\"Websocket connected\");\n                wsConnected = true;\n                $('#webSocketStatus').html('Open');\n                $('#reOpenWebSocketButton').hide();\n                $('#webSocketStatusRow').css('padding-bottom','0px');\n                $('#webSocketStatusCard').hide();\n                onWebSocketOpen();\n            };\n            ws.onclose = function()\n            {\n                console.log(\"Websocket closed\");\n                wsConnected = false;\n                $('#webSocketStatus').html('Closed');\n                $('#reOpenWebSocketButton').show();\n                $('#webSocketStatusCard').show();\n                $('#webSocketStatusRow').css('padding-bottom','25px');\n                onWebSocketClose();\n                wsConnectC();\n            };\n        }\n\n        function getRandomInt(max)\n        {\n          return Math.floor(Math.random() * Math.floor(max));\n        }\n        $( document ).ready(function()\n        {\n            userID  = {{{payload.userID}}};\n            if (!useWebSocketsFlag)\n            {\n                $('#webSocketStatusRow').css('padding-bottom','0px');\n                $('#webSocketStatusCard').hide();\n            }\n            wsConnectC();\n            onDocumentReady();\n       });\n        $( function() \n        {\n            $( \"#acknowledgeDialog\" ).dialog(\n                {\n                    width:    500,\n                    autoOpen: false,\n                    buttons:\n                    [\n                        {\n                            text: \"Ok\",\n                            click: function() { $( this ).dialog( \"close\" );},\n                            showText: false\n                        },\n                   ]\n                });\n            $( \"#messageDialog\" ).dialog(\n                {\n                    width:    500,\n                    autoOpen: false,\n                    buttons:[]\n                });\n        } );\n        function optionDialog(headerText, title, text, buttonTexts, buttonFunctions)\n        {\n            var buttonDefinitions = [];\n            for (var ii = 0; ii < buttonTexts.length; ++ii)\n            {\n                buttonDefinitions[ii] = \n                    {\n                        text: buttonTexts[ii],\n                        click: buttonFunctions[ii],\n                        showText: false\n                    };\n            }\n            $( \"#optionDialog\" ).dialog( \"option\", \"title\", headerText );   \n            $( \"#optionDialog\" ).dialog( \"option\", \"buttons\", buttonDefinitions);\n            $( \"#optionDialogTitle\" ).html(title);\n            $( \"#optionDialogText\" ).html(text);\n            $( \"#optionDialog\" ).dialog( \"open\" );\n        }\n        $( function() \n        {\n            $( \"#optionDialog\" ).dialog(\n                {\n                    width:    500,\n                    autoOpen: false,\n                    buttons:\n                    [\n                        {\n                            text: \"Ok\",\n                            click: function() {$( this ).dialog( \"close\" );},\n                            showText: false\n                        },\n                        {\n                            text: \"Cancel\",\n                            click: function() {$( this ).dialog( \"close\" );},\n                            showText: false\n                        },\n                   ]\n                });\n        } );\n        function acknowledgeDialog(headerText, title, text)\n        {\n            $( \"#acknowledgeDialog\" ).dialog( \"option\", \"title\", headerText );    \n            $( \"#acknowledgeDialogTitle\" ).html(title);\n            $( \"#acknowledgeDialogText\" ).html(text);\n            $( \"#acknowledgeDialog\" ).dialog( \"open\" );\n        }\n        function messageDialog(headerText, title, text)\n        {\n            $( \"#messageDialog\" ).dialog( \"option\", \"title\", headerText );    \n            $( \"#messageDialogTitle\" ).html(title);\n            $( \"#messageDialogText\" ).html(text);\n            $( \"#messageDialog\" ).dialog( \"open\" );\n        }\n        function heartbeat()\n        {\n            heartBeatImage = !heartBeatImage;\n            var heartBeatImageSrc = '/img/heartRed.png';\n            if (heartBeatImage) heartBeatImageSrc = '/img/heartPink.png';\n            $('#heartBeatID').attr('src',heartBeatImageSrc);\n        }\n        function getCookie(extension)\n        {\n            var cookies = document.cookie.split(';');\n            var token = null;\n            var cookieName = project + extension + \"=\";\n            for (var icookie = 0; icookie < cookies.length; ++icookie)\n            {\n                var index = cookies[icookie].indexOf(cookieName);\n                if (index >= 0)\n                {\n                    token = cookies[icookie].substring(index + cookieName.length);\n                }\n            }\n            return token;\n        }\n        function sendActionMsg(topic,role,actionMsg)\n        {\n            var roleToken = \"\";\n            if (remoteApp) roleToken  = getCookie('Role');\n            if (roleToken == null)\n            {\n                location.reload();\n                return;\n            }\n            var webSocketMsg = \n            {\n                topic     : topic,\n                payload   : actionMsg,\n                userID    : userID,\n                token     : getCookie('Role'),\n                role      : role\n            };\n            ws.send(JSON.stringify(webSocketMsg));\n        }\n",
        "output": "str",
        "x": 410,
        "y": 80,
        "wires": [
            [
                "25f0c237.ce8a1e"
            ]
        ]
    },
    {
        "id": "132e93cb.ae000c",
        "type": "function",
        "z": "adce79c2.bd6fa8",
        "name": "Get project name and userID",
        "func": "function getRandomInt(max)\n{\n  return Math.floor(Math.random() * Math.floor(max));\n}\nmsg.payload['project'] = global.get('project')\nmsg.payload['userID'] = getRandomInt(32768);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 200,
        "y": 80,
        "wires": [
            [
                "a38619a7.d98538"
            ]
        ]
    },
    {
        "id": "395db2cd.82c91e",
        "type": "mongodb3 in",
        "z": "adce79c2.bd6fa8",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "accessLog",
        "operation": "insertOne",
        "x": 1070,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "b9f0df99.46a35",
        "type": "function",
        "z": "adce79c2.bd6fa8",
        "name": "IP filter",
        "func": "var ipfilter = [\n    \"127.0.0.16\"];\nvar ipAddress = ( msg.req.headers['x-forwarded-for'] || '').split(',').pop() || \n          msg.req.connection.remoteAddress || \n          msg.req.socket.remoteAddress || \n          msg.req.connection.socket.remoteAddress;\nif (ipAddress==undefined) return null;\nvar ipAddressSplit = ipAddress.split(\".\");\nfor (var ii =  0; ii < ipfilter.length; ++ii)\n{\n    var ipfilterSplit = ipfilter[ii].split(\".\");\n    if (ipAddress == ipfilter[ii])\n    { \n        return null;\n    }\n    if (ipfilterSplit[2] == '*')\n    {\n        if ((ipfilterSplit[0] == ipAddressSplit[0]) && (ipfilterSplit[1] == ipAddressSplit[1]))\n        {\n            return null;\n        }\n    }\n}\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 970,
        "y": 80,
        "wires": [
            [
                "56f5d51f.3bd8bc",
                "f3f83772.745e08"
            ]
        ]
    },
    {
        "id": "fed7a4fc.f63bf8",
        "type": "function",
        "z": "adce79c2.bd6fa8",
        "name": "parseIpRequest",
        "func": "var data = msg.payload.data.geo;\ndata['url'] = msg.extraInfo.url;\ndata['userID'] = msg.extraInfo.userID;\ndata['timeStamp'] = new Date().getTime();\nreturn {topic:'ipData', payload:data};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1020,
        "y": 220,
        "wires": [
            [
                "395db2cd.82c91e"
            ]
        ]
    },
    {
        "id": "b41b9de6.c56eb",
        "type": "http request",
        "z": "adce79c2.bd6fa8",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://tools.keycdn.com/geo.json?host={{{payload.ipAddress}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1010,
        "y": 180,
        "wires": [
            [
                "fed7a4fc.f63bf8"
            ]
        ]
    },
    {
        "id": "f3f83772.745e08",
        "type": "function",
        "z": "adce79c2.bd6fa8",
        "name": "ClientInfo",
        "func": "var ipAddress = ( msg.req.headers['x-forwarded-for'] || '').split(',').pop() || \n          msg.req.connection.remoteAddress || \n          msg.req.socket.remoteAddress || \n          msg.req.connection.socket.remoteAddress;\nvar url = msg.req.url;\nvar header = {};\nheader['User-Agent'] = 'keycdn-tools:' + global.get('ipRefWeb');\nreturn {\n    topic:'clientInfo', \n    headers: header,\n    payload:{\n        ipAddress   : ipAddress\n    },\n    extraInfo       : {url:url, userID:msg.payload.userID},\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1000,
        "y": 140,
        "wires": [
            [
                "b41b9de6.c56eb"
            ]
        ]
    },
    {
        "id": "1062d234.2ee27e",
        "type": "template",
        "z": "698c1306.31662c",
        "name": "mailfooter",
        "field": "payload.mailfooter",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!--\n    <div width=\"100%\" align=\"center\">\n        <hr>\n        <table align=\"center\">\n            <tr >\n                <td  align=\"right\" style='padding-right:10px;padding-top:0px;'>\n                    <img src=\"/img/mailYellow.png\" height=\"70px\"/>\n                </td>\n                <td  align=\"left\" style='padding-left:10px;padding-top:0px;'>\n                    <span class='jumbotron-title big-text' >info@bl-mc.se</span>\n                </td>\n            </tr>\n        </table>\n    </div>\n--> ",
        "output": "str",
        "x": 200,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "721e5b041cde047a",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "Body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- Body HTML -->\n   <h1 style=\"text-align:center;color:#415c71;\">{{{payload.errorMsg}}}</h1>\n   <p></p>\n   <h1 style=\"text-align:center;color:#415c71;\">Redirecting to HTTPS...</h1>\n",
        "output": "str",
        "x": 770,
        "y": 80,
        "wires": [
            [
                "8c6be08c3d726f73"
            ]
        ]
    },
    {
        "id": "07bacb5b77262b3d",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Insecure Connection",
        "output": "str",
        "x": 490,
        "y": 80,
        "wires": [
            [
                "3a39937ddaa75862"
            ]
        ]
    },
    {
        "id": "5129e0a4079ad82a",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "JavaScript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "        $( document ).ready(function()\n        {\n            setTimeout(function(){location.replace(\"{{{payload.httpsUrl}}}\");}, 3000);\n        });\n \n",
        "output": "str",
        "x": 350,
        "y": 80,
        "wires": [
            [
                "07bacb5b77262b3d"
            ]
        ]
    },
    {
        "id": "3a39937ddaa75862",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "navBarIcon",
        "field": "payload.navBarIcon",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "basicYellow.png",
        "output": "str",
        "x": 630,
        "y": 80,
        "wires": [
            [
                "721e5b041cde047a"
            ]
        ]
    },
    {
        "id": "8c6be08c3d726f73",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "navBar",
        "field": "payload.navBar",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- navBar -->\n    <div class=\"jumbotron\" width=\"100%\">\n        <table width=\"100%\">\n            <tr>\n                <td style=\"text-align:left; vertical-align:middle;\"  width=\"20%\">\n                </td>\n                <td width=\"60%\" style=\"text-align:center; vertical-align:middle;\">\n                    <h1 class=\"jumbotron-title\">\n                        <span>{{{payload.title}}}</span>\n                    </h1>\n                </td>\n                <td style=\"text-align:right; vertical-align:middle;\" width=\"20%\">\n                </td>\n            </tr>\n        </table>\n    </div>",
        "output": "str",
        "x": 900,
        "y": 80,
        "wires": [
            [
                "83802deb03eddd20"
            ]
        ]
    },
    {
        "id": "83802deb03eddd20",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "CSS",
        "field": "payload.css",
        "fieldType": "msg",
        "format": "css",
        "syntax": "mustache",
        "template": "        :root \n        {\n          --color1: #415c71;\n          --color2: #547792;\n          --color3: #9eb5c7;\n          --color4: #c6c2bb;\n          --color5: #fdc300;\n          --big-text-size :300%;\n          --bold-text :900;\n          --vert-pad : 25px;\n          --horz-pad : 25px;\n        }\n        body \n        {\n          background-color: white !important;\n          padding-left:25px;\n          padding-right:25px;\n        }\n        \n        img \n        {\n          object-fit: contain;\n        }\n        a\n        {\n            color: white;\n        }\n        a:visited \n        { \n            color: var(--white);\n        }\n        a:hover \n        { \n            color: var(--color5);\n        }\n\n        .jumbotron \n        {\n          background-color: var(--color2) !important;\n          color: white;\n          padding-top:25px;\n          padding-bottom:25px;\n        }\n        .jumbotron-title\n        {\n          color:var(--color5);\n        }\n        .jumbotron-button\n        {\n          color: white;\n          background-color: var(--color1);\n       }\n        .card\n        {\n          background-color: var(--color2) !important;\n          text-align: center;\n        }\n        .card-body\n        {\n          background-color: var(--color3);;\n        }\n        .card-button\n        {\n          color: var(--color5) !important;\n          background-color: var(--color1) !important;\n          font-weight: bold;\n        }\n        .card-title\n        {\n          color: var(--color5);\n          font-weight: var(--bold-text);\n          font-size: var(--big-text-size);\n         }\n        .card-text\n        {\n          color: white;\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .danger-card\n        {\n          background-color: yellow !important;\n          text-align: center;\n        }\n        .danger-card-body\n        {\n          background-color: yellow;\n        }\n        .danger-card-button\n        {\n          color: yellow !important;\n          background-color: red !important;\n          font-weight: bold;\n        }\n        .danger-card-title\n        {\n          color: red;\n          font-weight: var(--bold-text);\n          font-size: var(--big-text-size);\n         }\n        .danger-card-text\n        {\n          color: white;\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .tableHeading\n        {\n          color:var(--container-title-color);\n        }\n        .tableText\n        {\n          color:var(--container-text-color);\n          font-size: var(--big-text-size);\n        }\n       .vert-pad\n        {\n            padding-top:var(--vert-pad);;\n            padding-bottom:var(--vert-pad);;\n        }\n        .horz-pad\n        {\n            padding-left:var(--horz-pad);;\n            padding-right:var(--horz-pad);;\n        }\n        .big-text\n        {\n            font-size: var(--big-text-size);\n        }\n        .bold-text\n        {\n            font-weight: var(--bold-text);\n        }\n       .ui-dialog-titlebar-close \n        {\n            visibility: hidden;\n        }\n        input.inputLarger \n        { \n            transform: scale(3); \n            margin: 1px;\n        }\n        .googleSlide4by3-container \n        {\n            position: relative;\n            overflow: hidden;\n            padding-top: 75.0%;\n        }\n        .googleSlide4by3-iframe {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            border: 0;\n        }        \n        .custom-select\n        {\n            color: black;\n            background-color: white;\n            height:80px;\n            line-height:70px;\n        }\n",
        "output": "str",
        "x": 1050,
        "y": 80,
        "wires": [
            [
                "3e97c79390cf79f0"
            ]
        ]
    },
    {
        "id": "30495fc00067bd92",
        "type": "function",
        "z": "3fec913b325ae6ff",
        "name": "https check",
        "func": "let ireq = -1;\nfor (let ii = 0; ii < msg.req.rawHeaders.length; ++ii)\n{\n    if (msg.req.rawHeaders[ii] == \"X-Forwarded-Proto\") ireq = ii + 1;\n}\nif (ireq >= 0) \n{\n    if (msg.req.rawHeaders[ireq] == 'http')\n    {\n        msg.cookies = { };\n        let ireq2 = -1;\n        for (let ii = 0; ii < msg.req.rawHeaders.length; ++ii)\n        {\n            if (msg.req.rawHeaders[ii] == \"Host\") ireq2 = ii + 1;\n        }\n        if (ireq2 >= 0)\n        {\n            let host = msg.req.rawHeaders[ireq2];\n            let url = \"https://\" + host + msg.req.url;\n            msg.payload['httpsUrl'] = url;\n        }\n        else\n        {\n            msg.payload['httpsUrl'] = '';\n        }\n        msg.payload.errorMsg = \"Insecure Connection!\";\n        return [null,msg];\n    }\n}\nreturn [msg,null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 190,
        "y": 80,
        "wires": [
            [],
            [
                "5129e0a4079ad82a"
            ]
        ]
    },
    {
        "id": "124220290623f310",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "HTML",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n{{{payload.head}}}\n  </head>\n  <body>\n{{{payload.navBar}}}\n{{{payload.body}}}\n{{{payload.foot}}}\n  </body>\n</html>",
        "output": "str",
        "x": 650,
        "y": 220,
        "wires": [
            [
                "155aa92c7a1b80ab"
            ]
        ]
    },
    {
        "id": "370b2570c9f1209a",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "Foot",
        "field": "payload.foot",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <script src=\"/scripts/popper.js\"></script>\n    <script src=\"/scripts/bootstrap.js\"></script>",
        "output": "str",
        "x": 530,
        "y": 220,
        "wires": [
            [
                "124220290623f310"
            ]
        ]
    },
    {
        "id": "3e97c79390cf79f0",
        "type": "template",
        "z": "3fec913b325ae6ff",
        "name": "Head",
        "field": "payload.head",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <meta charset=\"UTF-8\">\n    <link rel=\"icon\" href=\"/img/favicon.ico?v=4\" type=\"image/x-icon\"/>\n    <title>{{payload.title}}</title>\n    <link rel=\"stylesheet\" href=\"/css/bootstrap.css\"/>\n    <link rel=\"stylesheet\" href=\"/jquery/jquery-ui.css\"/>\n    <link rel=\"stylesheet\" href=\"/jquery/jquery-ui-timepicker-addon.css\"/>\n    <script src=\"/jquery/jquery.js\"></script>\n    <script src=\"/jquery/jquery-ui.js\"></script>\n    <script src=\"/jquery/jquery-ui-timepicker-addon.js\"></script>\n    <script src=\"/scripts/plotly-latest.min.js\"></script>\n    <script src=\"/scripts/pako.min.js\"></script>\n    <style>\n{{{payload.css}}}\n    </style>\n    <script>\n    </script>\n    <script>\n{{{payload.javascript}}}\n    </script>\n",
        "output": "str",
        "x": 410,
        "y": 220,
        "wires": [
            [
                "370b2570c9f1209a"
            ]
        ]
    },
    {
        "id": "155aa92c7a1b80ab",
        "type": "http response",
        "z": "3fec913b325ae6ff",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 770,
        "y": 220,
        "wires": []
    },
    {
        "id": "f62ae826.1bfb58",
        "type": "mqtt in",
        "z": "8475ab9.3d26058",
        "name": "Subscribe Readings",
        "topic": "$(ARCHIVETOPIC)",
        "qos": "0",
        "datatype": "auto",
        "broker": "84d80994.260508",
        "inputs": 0,
        "x": 130,
        "y": 160,
        "wires": [
            [
                "7a299117.69d3"
            ]
        ]
    },
    {
        "id": "2132a017.ba23f",
        "type": "mqtt out",
        "z": "8475ab9.3d26058",
        "name": "Publish Setting",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "84d80994.260508",
        "x": 1040,
        "y": 500,
        "wires": []
    },
    {
        "id": "ee0ee61b.770a18",
        "type": "subflow:e13648d6.d698c8",
        "z": "8475ab9.3d26058",
        "x": 1250,
        "y": 440,
        "wires": []
    },
    {
        "id": "a3efdc0a.76eff",
        "type": "mongodb3 in",
        "z": "8475ab9.3d26058",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "archiver",
        "operation": "find.toArray",
        "x": 590,
        "y": 980,
        "wires": [
            [
                "28d7885b.29ba58"
            ]
        ]
    },
    {
        "id": "7a299117.69d3",
        "type": "json",
        "z": "8475ab9.3d26058",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 290,
        "y": 160,
        "wires": [
            [
                "764116fd.f6e648"
            ]
        ]
    },
    {
        "id": "81c39fe.b208a6",
        "type": "switch",
        "z": "8475ab9.3d26058",
        "name": "",
        "property": "payload.mqttDevice.deviceType",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "blinky-wind",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "blinky-DS18B20",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "blinky-turnstile",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "blinky-webcam",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "solar-regulator",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 630,
        "y": 160,
        "wires": [
            [
                "304b3835.9b6918"
            ],
            [
                "a988b405.392318"
            ],
            [
                "1c641721.29eb79"
            ],
            [
                "a91cdcd0.61dc6"
            ],
            [
                "cec57df7.c5e52"
            ]
        ]
    },
    {
        "id": "764116fd.f6e648",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Split MQTT topic",
        "func": "var mqttArray = msg.topic.split('/');\nvar device = \n{\n    project     : mqttArray[0],\n    deviceType  : mqttArray[1],\n    name        : mqttArray[2],\n    prop        : mqttArray[3],\n};\nreturn {topic : msg.topic, payload:{topic:'readings', mqttDevice : device, payload:msg.payload}};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 160,
        "wires": [
            [
                "81c39fe.b208a6"
            ]
        ]
    },
    {
        "id": "1c2ceb85.01cf44",
        "type": "gzip",
        "z": "8475ab9.3d26058",
        "name": "",
        "x": 990,
        "y": 440,
        "wires": [
            [
                "d0fb8153.688bb"
            ]
        ]
    },
    {
        "id": "d0fb8153.688bb",
        "type": "json",
        "z": "8475ab9.3d26058",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1110,
        "y": 440,
        "wires": [
            [
                "ee0ee61b.770a18"
            ]
        ]
    },
    {
        "id": "b6b8b063.9f62f",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Setup Archive Query",
        "func": "var projectionFilter =  \n{\n    projection:\n    {\n        _id                         :   0, \n        deviceType                  :   1,  \n        name                        :   1,  \n        timeStamp                   :   1 \n    } \n};\nfor (var ii = 0; ii < msg.payload.device.attr.length; ++ii)\n{\n    projectionFilter.projection[msg.payload.device.attr[ii]] = 1;\n}\nvar queryFilter = \n{\n    $and :\n    [\n        {\n            deviceType: msg.payload.device.deviceType\n        },\n        {\n            name: msg.payload.device.name\n        },\n        {\n            timeStamp :\n            {\n                $gte: msg.payload.device.startDate,\n                $lte: msg.payload.device.stopDate\n            }\n        }\n    ] \n    \n}\nvar newMsg = \n{\n    topic           : msg.topic,\n    userID          : msg.userID,\n    payload         : [queryFilter, projectionFilter],\n    device          : msg.payload.device,\n};\nreturn newMsg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 980,
        "wires": [
            [
                "a3efdc0a.76eff"
            ]
        ]
    },
    {
        "id": "28d7885b.29ba58",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Sort Archive Data",
        "func": "function objectLength( object ) {\n    var length = 0;\n    for( var key in object ) {\n        if( object.hasOwnProperty(key) ) {\n            ++length;\n        }\n    }\n    return length;\n}\n\nfunction sortByKey(arr, key) \n{\n    return arr.sort( function(a, b) \n        {\n            var x = a[key]; \n            var y = b[key];\n            return ((x < y) ? -1 : ((x > y) ? 1 : 0));\n        } );\n}\n\nvar numRecords = objectLength(msg.payload);\nif (numRecords < 1)\n{\n    return {\n        topic : msg.device.deviceType,\n        payload:{\n            topic           : msg.topic,\n            payload         : {device: msg.device, trace:null},\n            userID          : msg.userID,\n        }\n    };\n}\nvar records = [];\nfor (var ii = 0; ii < numRecords; ++ii) records[ii] = msg.payload[ii]; \nsortByKey(records, 'timeStamp');\nvar trace = [];\nfor (var ii = 0; ii < numRecords; ++ii)\n{\n    trace[ii] = {timeStamp: records[ii].timeStamp};\n    for (var ij = 0; ij < msg.device.attr.length; ++ij)\n    {\n        trace[ii][msg.device.attr[ij]] = records[ii][msg.device.attr[ij]];\n    }\n}\n\nreturn {\n    topic : msg.device.deviceType,\n    payload:{\n        topic           : msg.topic,\n        payload         : {device: msg.device, trace: trace},\n        userID          : msg.userID,\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 850,
        "y": 980,
        "wires": [
            [
                "36088082.3139d"
            ]
        ]
    },
    {
        "id": "36088082.3139d",
        "type": "switch",
        "z": "8475ab9.3d26058",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "blinky-wind",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "blinky-DS18B20",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "blinky-turnstile",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "solar-regulator",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 1030,
        "y": 980,
        "wires": [
            [
                "6d200160.afc65"
            ],
            [
                "62fb9e33.02bff"
            ],
            [
                "9b3bde89.b6f61"
            ],
            [
                "e8228b8.3e95678"
            ]
        ]
    },
    {
        "id": "4bda293b.6a4c38",
        "type": "switch",
        "z": "8475ab9.3d26058",
        "name": "Action Switch",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "setting",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "ping",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "readDatabase",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "renew",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 640,
        "y": 520,
        "wires": [
            [
                "d6984859.a267c8"
            ],
            [
                "a4b9417e.3c5d7"
            ],
            [
                "cc1f29ab.67bb78"
            ],
            [
                "14b7f9da.2d7c86"
            ]
        ]
    },
    {
        "id": "1e710224.de723e",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "Action Error Message Out",
        "links": [
            "7e343bf8.8fec14",
            "80b48a2e.fb2228",
            "d0705889.a79d18",
            "a8a88b3.a878478",
            "4d17b368.0e74ac",
            "3b3f00c.e1f7e",
            "c7b674e2.931c88",
            "6d4ae2aa.ffa1cc",
            "ae6d0749.651b58",
            "d8b0e2fe.3e47e",
            "ebb358f3.95c638",
            "bf657e74.6ac66",
            "ffb80136.883f8",
            "9ef4d388.4bcf7",
            "80c07ebe.4f177",
            "8c18e9cd.f40f08",
            "435b9182.cc3ac",
            "8d0f331.1da14d",
            "b7a01bb7.010988",
            "fb8b1545.8b1a38"
        ],
        "x": 775,
        "y": 660,
        "wires": []
    },
    {
        "id": "d6984859.a267c8",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Prep MQTT",
        "func": "var newMsg = msg.payload;\nnewMsg.userID = msg.userID\nreturn newMsg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 830,
        "y": 480,
        "wires": [
            [
                "2132a017.ba23f",
                "1c2ceb85.01cf44"
            ]
        ]
    },
    {
        "id": "a4b9417e.3c5d7",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Prep MQTT",
        "func": "var newMsg = msg.payload;\nnewMsg.userID = msg.userID\nreturn newMsg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 830,
        "y": 520,
        "wires": [
            [
                "2132a017.ba23f"
            ]
        ]
    },
    {
        "id": "cc1f29ab.67bb78",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "readDatabase out",
        "links": [
            "c4595efc.a717b"
        ],
        "x": 775,
        "y": 560,
        "wires": []
    },
    {
        "id": "c4595efc.a717b",
        "type": "link in",
        "z": "8475ab9.3d26058",
        "name": "Setup Archive in",
        "links": [
            "cc1f29ab.67bb78",
            "8257a0f.6bb886",
            "a66aeb44.77e748",
            "e826b9af.41ca18",
            "38378280.30819e",
            "1ba08149.e5642f",
            "c7ccca02.902f08",
            "8a054338.b6be3",
            "7ceba2d4.4dcf3c",
            "721a7865.6ff7e8",
            "3d600dd.1fe0cf2",
            "d958fbdd.fe1e48",
            "a92d4c9a.7f5e4",
            "b9a67318.b5255",
            "33c65adc.cedff6"
        ],
        "x": 175,
        "y": 980,
        "wires": [
            [
                "b6b8b063.9f62f"
            ]
        ]
    },
    {
        "id": "e6d1a4ad.2186e8",
        "type": "subflow:fee416c.fb205e8",
        "z": "8475ab9.3d26058",
        "x": 470,
        "y": 620,
        "wires": [
            [
                "4bda293b.6a4c38"
            ],
            [
                "1e710224.de723e"
            ]
        ]
    },
    {
        "id": "28ebc7b7.46b498",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Renew Token",
        "func": "msg.token.expDate = new Date().getTime() + msg.token.timeoutMin * 60000;\ndelete msg.token['iat']\nmsg.payload = JSON.parse(JSON.stringify(msg.token));\ndelete msg['token'];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1060,
        "wires": [
            [
                "5b671f90.f02c1"
            ]
        ]
    },
    {
        "id": "5b671f90.f02c1",
        "type": "JsonWebToken",
        "z": "8475ab9.3d26058",
        "name": "encrypt token",
        "tokenconfig": "6acefdd9.69f124",
        "x": 480,
        "y": 1060,
        "wires": [
            [
                "7569e60e.54a608"
            ]
        ]
    },
    {
        "id": "7569e60e.54a608",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Renew Cookies",
        "func": "var newMsg = \n{\n    topic : 'renew',\n    payload: \n    {\n        topic       : 'renew',\n        userID      : msg.userID,\n        role        : msg.token,\n        expDate     : msg.payload.expDate.toString(),\n        username    : msg.payload.username\n    }\n}\nreturn newMsg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 660,
        "y": 1060,
        "wires": [
            [
                "224d9b05.f92104"
            ]
        ]
    },
    {
        "id": "f4326ad5.3e47e8",
        "type": "link in",
        "z": "8475ab9.3d26058",
        "name": "Setup Renew in",
        "links": [
            "14b7f9da.2d7c86"
        ],
        "x": 175,
        "y": 1060,
        "wires": [
            [
                "28ebc7b7.46b498"
            ]
        ]
    },
    {
        "id": "14b7f9da.2d7c86",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "renew out",
        "links": [
            "f4326ad5.3e47e8"
        ],
        "x": 775,
        "y": 600,
        "wires": []
    },
    {
        "id": "224d9b05.f92104",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "renew out",
        "links": [
            "3b3f00c.e1f7e",
            "435b9182.cc3ac",
            "4d17b368.0e74ac",
            "7e343bf8.8fec14",
            "80b48a2e.fb2228",
            "80c07ebe.4f177",
            "8c18e9cd.f40f08",
            "8d0f331.1da14d",
            "9ef4d388.4bcf7",
            "a8a88b3.a878478",
            "ae6d0749.651b58",
            "b7a01bb7.010988",
            "bf657e74.6ac66",
            "d0705889.a79d18",
            "d8b0e2fe.3e47e",
            "ebb358f3.95c638",
            "ffb80136.883f8",
            "fb8b1545.8b1a38"
        ],
        "x": 775,
        "y": 1060,
        "wires": []
    },
    {
        "id": "3d5b02e.d3414fe",
        "type": "websocket out",
        "z": "8475ab9.3d26058",
        "name": "/blinky-wind/websocket",
        "server": "c1211ec2.5887d",
        "client": "",
        "x": 1080,
        "y": 40,
        "wires": []
    },
    {
        "id": "435b9182.cc3ac",
        "type": "link in",
        "z": "8475ab9.3d26058",
        "name": "blinky wind input socket",
        "links": [
            "1e710224.de723e",
            "224d9b05.f92104",
            "304b3835.9b6918",
            "6d200160.afc65"
        ],
        "x": 935,
        "y": 40,
        "wires": [
            [
                "3d5b02e.d3414fe"
            ]
        ]
    },
    {
        "id": "304b3835.9b6918",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "blinky-wind mqtt",
        "links": [
            "435b9182.cc3ac",
            "4c1a483.bd61eb8",
            "1a07dfbc.75c78",
            "b5c8eac4.7c3928",
            "cdf75a81.2fb1a8",
            "f42dd5f2.45fce8",
            "f5fe39ed.3730c8"
        ],
        "x": 815,
        "y": 40,
        "wires": []
    },
    {
        "id": "6d200160.afc65",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "blinky-wind-archive",
        "links": [
            "435b9182.cc3ac",
            "4c1a483.bd61eb8",
            "1a07dfbc.75c78",
            "b5c8eac4.7c3928",
            "cdf75a81.2fb1a8",
            "f42dd5f2.45fce8",
            "f5fe39ed.3730c8"
        ],
        "x": 1155,
        "y": 940,
        "wires": []
    },
    {
        "id": "35a68632.eb7a7a",
        "type": "websocket in",
        "z": "8475ab9.3d26058",
        "name": "/blinky-wind/websocket",
        "server": "c1211ec2.5887d",
        "client": "",
        "x": 140,
        "y": 540,
        "wires": [
            [
                "e6d1a4ad.2186e8"
            ]
        ]
    },
    {
        "id": "a3294720.d3e8c8",
        "type": "websocket out",
        "z": "8475ab9.3d26058",
        "name": "/blinky-DS18B20/websocket",
        "server": "fc576385.12f95",
        "client": "",
        "x": 1100,
        "y": 100,
        "wires": []
    },
    {
        "id": "8d0f331.1da14d",
        "type": "link in",
        "z": "8475ab9.3d26058",
        "name": "blinky DS18B20 input socket",
        "links": [
            "1e710224.de723e",
            "224d9b05.f92104",
            "a988b405.392318",
            "62fb9e33.02bff"
        ],
        "x": 935,
        "y": 100,
        "wires": [
            [
                "a3294720.d3e8c8"
            ]
        ]
    },
    {
        "id": "a988b405.392318",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "blinky-DS18B20 mqtt",
        "links": [
            "8d0f331.1da14d",
            "4c1a483.bd61eb8",
            "3f5e997d.8aa756",
            "416a2a7a.685b94",
            "6b2597a0.5798c8",
            "8643a67.20cf058",
            "f42dd5f2.45fce8",
            "f5fe39ed.3730c8",
            "59f5e2e2.dc188c"
        ],
        "x": 815,
        "y": 100,
        "wires": []
    },
    {
        "id": "2569df2b.b3dbf",
        "type": "websocket in",
        "z": "8475ab9.3d26058",
        "name": "/blinky-DS18B20/websocket",
        "server": "fc576385.12f95",
        "client": "",
        "x": 160,
        "y": 600,
        "wires": [
            [
                "e6d1a4ad.2186e8"
            ]
        ]
    },
    {
        "id": "62fb9e33.02bff",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "blinky-DS18B20-archive",
        "links": [
            "4c1a483.bd61eb8",
            "8d0f331.1da14d",
            "3f5e997d.8aa756",
            "6b2597a0.5798c8",
            "8643a67.20cf058",
            "f42dd5f2.45fce8",
            "f5fe39ed.3730c8",
            "59f5e2e2.dc188c"
        ],
        "x": 1155,
        "y": 980,
        "wires": []
    },
    {
        "id": "3be76d54.182da2",
        "type": "websocket out",
        "z": "8475ab9.3d26058",
        "name": "/blinky-turnstile/websocket",
        "server": "417794ff.011e5c",
        "client": "",
        "x": 1090,
        "y": 160,
        "wires": []
    },
    {
        "id": "b7a01bb7.010988",
        "type": "link in",
        "z": "8475ab9.3d26058",
        "name": "blinky turnstile input socket",
        "links": [
            "1c641721.29eb79",
            "1e710224.de723e",
            "224d9b05.f92104",
            "9b3bde89.b6f61",
            "a91cdcd0.61dc6"
        ],
        "x": 935,
        "y": 160,
        "wires": [
            [
                "3be76d54.182da2"
            ]
        ]
    },
    {
        "id": "1c641721.29eb79",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "blinky-turnstile mqtt",
        "links": [
            "4c1a483.bd61eb8",
            "b7a01bb7.010988",
            "8f53ee48.a6ce7",
            "416a2a7a.685b94",
            "8643a67.20cf058",
            "59f5e2e2.dc188c"
        ],
        "x": 815,
        "y": 160,
        "wires": []
    },
    {
        "id": "9b3bde89.b6f61",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "blinky-turnstile-archive",
        "links": [
            "4c1a483.bd61eb8",
            "b7a01bb7.010988",
            "8f53ee48.a6ce7",
            "416a2a7a.685b94",
            "8643a67.20cf058",
            "59f5e2e2.dc188c"
        ],
        "x": 1155,
        "y": 1020,
        "wires": []
    },
    {
        "id": "564c3db7.9dbbe4",
        "type": "websocket in",
        "z": "8475ab9.3d26058",
        "name": "/blinky-turnstile/websocket",
        "server": "417794ff.011e5c",
        "client": "",
        "x": 150,
        "y": 660,
        "wires": [
            [
                "e6d1a4ad.2186e8"
            ]
        ]
    },
    {
        "id": "231ccb57.2806a4",
        "type": "link in",
        "z": "8475ab9.3d26058",
        "name": "To Websocket Router action switch",
        "links": [],
        "x": 385,
        "y": 720,
        "wires": [
            [
                "e6d1a4ad.2186e8"
            ]
        ]
    },
    {
        "id": "a91cdcd0.61dc6",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "blinky-webcam mqtt",
        "links": [
            "416a2a7a.685b94",
            "8f53ee48.a6ce7",
            "b7a01bb7.010988",
            "fb8b1545.8b1a38"
        ],
        "x": 815,
        "y": 220,
        "wires": []
    },
    {
        "id": "cbfd6d0b.ae8cd",
        "type": "websocket out",
        "z": "8475ab9.3d26058",
        "name": "/blinky-webcam/websocket",
        "server": "dddd1a95.f87278",
        "client": "",
        "x": 1100,
        "y": 220,
        "wires": []
    },
    {
        "id": "fb8b1545.8b1a38",
        "type": "link in",
        "z": "8475ab9.3d26058",
        "name": "blinky webcam input socket",
        "links": [
            "1e710224.de723e",
            "224d9b05.f92104",
            "a91cdcd0.61dc6"
        ],
        "x": 935,
        "y": 220,
        "wires": [
            [
                "cbfd6d0b.ae8cd"
            ]
        ]
    },
    {
        "id": "d8b49ab3.5aa988",
        "type": "websocket in",
        "z": "8475ab9.3d26058",
        "name": "/blinky-webcam/websocket",
        "server": "dddd1a95.f87278",
        "client": "",
        "x": 150,
        "y": 720,
        "wires": [
            [
                "e6d1a4ad.2186e8"
            ]
        ]
    },
    {
        "id": "9c6a524.b3b2fb",
        "type": "mongodb3 in",
        "z": "8475ab9.3d26058",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "devices",
        "operation": "find.toArray",
        "x": 590,
        "y": 1200,
        "wires": [
            [
                "6c2c0c22.4116e4"
            ]
        ]
    },
    {
        "id": "6c2c0c22.4116e4",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Parse query",
        "func": "var newMsg = \n{\n    topic   :   msg.topic,\n    payload:\n    {\n        topic   :   msg.topic,\n        userID  :   msg.userID,\n        payload :  msg.payload[0]\n    }\n}\nreturn newMsg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 1200,
        "wires": [
            [
                "23e88c82.a83354"
            ]
        ]
    },
    {
        "id": "f22bcd6.812bb3",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Prep get Devices Query",
        "func": "msg.payload = \n{\n    $and : [ {deviceType: msg.payload.deviceType}, {name: msg.payload.name} ]};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 1200,
        "wires": [
            [
                "9c6a524.b3b2fb"
            ]
        ]
    },
    {
        "id": "23e88c82.a83354",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "getDevices output",
        "links": [
            "cdf75a81.2fb1a8"
        ],
        "x": 955,
        "y": 1200,
        "wires": []
    },
    {
        "id": "aafed30c.beeb9",
        "type": "link in",
        "z": "8475ab9.3d26058",
        "name": "getDevices input",
        "links": [
            "db8bf165.d43ca"
        ],
        "x": 175,
        "y": 1200,
        "wires": [
            [
                "f22bcd6.812bb3"
            ]
        ]
    },
    {
        "id": "5ff9b161.b23a4",
        "type": "mqtt in",
        "z": "8475ab9.3d26058",
        "name": "Subscribe Webcam",
        "topic": "blinky-lite-v2/blinky-webcam/+/image",
        "qos": "0",
        "datatype": "auto",
        "broker": "84d80994.260508",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 130,
        "y": 320,
        "wires": [
            [
                "9053c41d.fd4868"
            ]
        ]
    },
    {
        "id": "9053c41d.fd4868",
        "type": "function",
        "z": "8475ab9.3d26058",
        "name": "Split MQTT topic",
        "func": "var mqttArray = msg.topic.split('/');\nvar device = \n{\n    project     : mqttArray[0],\n    deviceType  : mqttArray[1],\n    name        : mqttArray[2],\n    prop        : mqttArray[3],\n};\nmsg['filename'] = 'html-static/img/blinky-webcam/' + device.deviceType + '-' + device.name + '.jpg';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 320,
        "wires": [
            [
                "bfd2291c.645028"
            ]
        ]
    },
    {
        "id": "a73244ae.eb9828",
        "type": "file",
        "z": "8475ab9.3d26058",
        "name": "",
        "filename": "",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 650,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "bfd2291c.645028",
        "type": "base64",
        "z": "8475ab9.3d26058",
        "name": "",
        "action": "",
        "property": "payload",
        "x": 520,
        "y": 320,
        "wires": [
            [
                "a73244ae.eb9828"
            ]
        ]
    },
    {
        "id": "cec57df7.c5e52",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "solar-regulator mqtt",
        "links": [
            "f5fe39ed.3730c8"
        ],
        "x": 815,
        "y": 280,
        "wires": []
    },
    {
        "id": "e8228b8.3e95678",
        "type": "link out",
        "z": "8475ab9.3d26058",
        "name": "solar-regulator-archive",
        "links": [
            "f5fe39ed.3730c8"
        ],
        "x": 1155,
        "y": 1060,
        "wires": []
    },
    {
        "id": "c7da9dac.c1515",
        "type": "mongodb3 in",
        "z": "2b074b3a.632fb4",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "devices",
        "operation": "find.toArray",
        "x": 710,
        "y": 140,
        "wires": [
            [
                "ef3db445.b303c8"
            ]
        ]
    },
    {
        "id": "ef3db445.b303c8",
        "type": "function",
        "z": "2b074b3a.632fb4",
        "name": "Parse query",
        "func": "var water = null;\nvar windAir = null;\nfor (var ii = 0; ii < 2; ++ii)\n{\n    if ((msg.payload[ii].deviceType == 'blinky-DS18B20')  && (msg.payload[ii].name == 'Brantevik') ) water = msg.payload[ii];\n    if ((msg.payload[ii].deviceType == 'blinky-wind')  && (msg.payload[ii].name == 'Brantevik') ) windAir = msg.payload[ii];\n}\nvar newPayload = \n{\n    waterTimeStamp  : water.timeStamp,\n    waterTemp       : water.tempA.value,\n    windSpeed       : windAir.windSpeed.value,\n    windDirection   : windAir.windDirection.value\n};\nif (msg.topic == undefined)\n{\n    msg.payload = newPayload;\n    return [null,msg];\n}\nvar newMsg = \n{\n    topic   :   msg.topic,\n    payload:\n    {\n        topic   :   msg.topic,\n        userID  :   msg.userID,\n        payload :   [water, windAir,flow.get('espotPrice')]\n    }\n}\nreturn [newMsg,null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 140,
        "wires": [
            [
                "e4b5cdfb.1cf63"
            ],
            [
                "2a2d7c4e.b4fe14"
            ]
        ]
    },
    {
        "id": "a379e264.0ddd5",
        "type": "function",
        "z": "2b074b3a.632fb4",
        "name": "Prep get Devices Query",
        "func": "msg.payload = \n{\n    $or : [ \n        {$and : [ {deviceType: 'blinky-DS18B20'}, {name: 'Brantevik'} ]},\n        {$and : [ {deviceType: 'blinky-wind'}, {name: 'Brantevik'} ]}\n        ]\n     \n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 440,
        "y": 140,
        "wires": [
            [
                "c7da9dac.c1515"
            ]
        ]
    },
    {
        "id": "8377d459.45b4f8",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/brantevik.json",
        "url": "/brantevik.json",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 140,
        "wires": [
            [
                "a379e264.0ddd5"
            ]
        ]
    },
    {
        "id": "2a2d7c4e.b4fe14",
        "type": "http response",
        "z": "2b074b3a.632fb4",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1180,
        "y": 140,
        "wires": []
    },
    {
        "id": "6506cd6c.93ac74",
        "type": "link in",
        "z": "2b074b3a.632fb4",
        "name": "brantevik device query in",
        "links": [
            "56e4449c.aa565c",
            "187857b3.a24488",
            "efc341f5.3b27c"
        ],
        "x": 345,
        "y": 100,
        "wires": [
            [
                "a379e264.0ddd5"
            ]
        ]
    },
    {
        "id": "e4b5cdfb.1cf63",
        "type": "link out",
        "z": "2b074b3a.632fb4",
        "name": "brantevik device query out",
        "links": [
            "6b2597a0.5798c8",
            "f42dd5f2.45fce8",
            "f5fe39ed.3730c8"
        ],
        "x": 1055,
        "y": 120,
        "wires": []
    },
    {
        "id": "11446558.79091b",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantevik Vder",
        "output": "str",
        "x": 460,
        "y": 320,
        "wires": [
            [
                "ca138de2.f6762"
            ]
        ]
    },
    {
        "id": "2eb15a26.4e1336",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "navBarIcon",
        "field": "payload.navBarIcon",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "BrantevikLogo.png",
        "output": "str",
        "x": 470,
        "y": 280,
        "wires": [
            [
                "11446558.79091b"
            ]
        ]
    },
    {
        "id": "e2242fbb.bffa4",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/brantevik-weather-widget",
        "url": "/brantevik-weather-widget",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 170,
        "y": 240,
        "wires": [
            [
                "1ea7cffebed6852b"
            ]
        ]
    },
    {
        "id": "e14c805b.d1dae",
        "type": "websocket out",
        "z": "2b074b3a.632fb4",
        "name": "/brantevik-weather-widget",
        "server": "e865fc91.88a2a",
        "client": "",
        "x": 1250,
        "y": 820,
        "wires": []
    },
    {
        "id": "f5fe39ed.3730c8",
        "type": "link in",
        "z": "2b074b3a.632fb4",
        "name": "mybrantevik-widget web socket input",
        "links": [
            "304b3835.9b6918",
            "62fb9e33.02bff",
            "6d200160.afc65",
            "a988b405.392318",
            "cec57df7.c5e52",
            "e4b5cdfb.1cf63",
            "e8228b8.3e95678",
            "f06ef656.ad1c18"
        ],
        "x": 1105,
        "y": 820,
        "wires": [
            [
                "e14c805b.d1dae",
                "690bd22475a99ce7"
            ]
        ]
    },
    {
        "id": "2f1b0478.24543c",
        "type": "json",
        "z": "2b074b3a.632fb4",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 370,
        "y": 820,
        "wires": [
            [
                "9c6fa88d.798128"
            ]
        ]
    },
    {
        "id": "9c6fa88d.798128",
        "type": "function",
        "z": "2b074b3a.632fb4",
        "name": "Shift msg",
        "func": "return msg.payload;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 500,
        "y": 820,
        "wires": [
            [
                "82d5a7b5.21ed68"
            ]
        ]
    },
    {
        "id": "89399675.118c88",
        "type": "websocket in",
        "z": "2b074b3a.632fb4",
        "name": "/brantevik-weather-widget",
        "server": "e865fc91.88a2a",
        "client": "",
        "x": 150,
        "y": 820,
        "wires": [
            [
                "2f1b0478.24543c"
            ]
        ]
    },
    {
        "id": "efc341f5.3b27c",
        "type": "link out",
        "z": "2b074b3a.632fb4",
        "name": "mybrantevik-widget web socket out",
        "links": [
            "6506cd6c.93ac74"
        ],
        "x": 715,
        "y": 840,
        "wires": []
    },
    {
        "id": "b744aba3.c55a18",
        "type": "subflow:adce79c2.bd6fa8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1230,
        "y": 360,
        "wires": []
    },
    {
        "id": "82d5a7b5.21ed68",
        "type": "switch",
        "z": "2b074b3a.632fb4",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "readDatabase",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "getDevices",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 630,
        "y": 820,
        "wires": [
            [
                "b9a67318.b5255"
            ],
            [
                "efc341f5.3b27c"
            ]
        ]
    },
    {
        "id": "b9a67318.b5255",
        "type": "link out",
        "z": "2b074b3a.632fb4",
        "name": "mybrantevik-widget archive request",
        "links": [
            "c4595efc.a717b"
        ],
        "x": 715,
        "y": 800,
        "wires": []
    },
    {
        "id": "ca138de2.f6762",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(true);\n        var programStarted = false;\n        var validArchiveData = false;\n\n        function onDocumentReady()\n        {\n/*\n            var picNum =  Math.floor(Math.random() * 16) + 1;\n            if (picNum < 10)\n            {\n                $(\"#widgetTable\").attr(\"background\",\"/img/brantevikPics/BrantePic0\" + picNum.toString() +\".jpg\");\n            }\n            else\n            {\n                $(\"#widgetTable\").attr(\"background\",\"/img/brantevikPics/BrantePic\" + picNum.toString() +\".jpg\");\n            }\n*/\n            setTimeout(function()\n            {\n                $(\"#widgetTable\").attr(\"background\",'img/blinky-webcam/blinky-webcam-01.jpg' +'?t=' + new Date().getTime().toString());\n            }, 10);\n            setInterval(function()\n            {\n                $(\"#widgetTable\").attr(\"background\",'img/blinky-webcam/blinky-webcam-01.jpg' +'?t=' + new Date().getTime().toString());\n            }, 60000);\n\n            $(\"#historyChartContainer\").hide();\n            $(window).resize(function()\n            {\n                resizeText();\n            });\n        }\n        function onWebSocketOpen()\n        {\n            if (!programStarted)\n            {\n                programStarted = true;\n                var webSocketMsg = \n                {\n                    topic     : 'getDevices',\n                    payload   : {},\n                    userID    : userID,\n                };\n                ws.send(JSON.stringify(webSocketMsg));\n            }\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n            switch(msg.topic)\n            {\n                case 'readings':\n                    var device = JSON.parse(pako.inflate(msg.payload, { to: 'string' }));\n                    device.timeStamp = new Date().getTime();\n                    var time = new Date(device.timeStamp).toLocaleString('en-SE',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit', second: '2-digit'}).replace(',', '');\n                    $('#waterTempDate').text('Brantevik ' + time);\n                    if ((device.deviceType == \"blinky-DS18B20\")     && (device.name == \"Brantevik\")) updateWaterTemp(device);\n                    if ((device.deviceType == \"blinky-wind\")     && (device.name == \"Brantevik\"))\n                    {\n                        updateWind(device);\n                        updateAirTemp(device);\n                    }\n                    break;\n                case 'readDatabase':\n                    if (msg.userID == userID)\n                    {\n                        putArchiveValues(msg.payload);\n                    }\n                    break;\n                case 'getDevices':\n                    if (msg.userID == userID)\n                    {\n                        var time = new Date().toLocaleString('en-SE',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit', second: '2-digit'}).replace(',', '');\n                        $('#waterTempDate').text('Brantevik ' + time);\n                        updateWaterTemp(msg.payload[0]);\n                        updateWind(msg.payload[1]);\n                        updateAirTemp(msg.payload[1]);\n//                        updateEspotPrice(msg.payload[2])\n                     }\n                    break;\n                default:\n                    break;\n            }\n        }\n        function getStatus()\n        {\n            $(\"#historyChartContainer\").hide();\n            $(\"#status\").show();\n        }\n        function resizeText()\n        {\n            if($('#status').is(\":visible\")) return;\n            if (validArchiveData)\n            {\n                windowWidth = $( '#historyChartContainer' ).width();\n                var width = $(\"#historyChartContainer\").width() * 0.92;\n                var height = historyPlotHeightRatio * width;\n                historyPlotLayout.width = width.toFixed(0);\n                historyPlotLayout.height = height.toFixed(0);\n                Plotly.newPlot('historyChart', [historyPlotTrace1,historyPlotTrace2], historyPlotLayout, {displayModeBar: false, staticPlot: true});\n                return;\n            }\n        }\n",
        "output": "str",
        "x": 730,
        "y": 240,
        "wires": [
            [
                "de9d819b.fe1b9"
            ]
        ]
    },
    {
        "id": "e2dfd322.f1489",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n{{{payload.script.updateReadings}}}\n{{{payload.script.archive}}}\n",
        "output": "str",
        "x": 720,
        "y": 360,
        "wires": [
            [
                "f1ac07b2.ceee48"
            ]
        ]
    },
    {
        "id": "f1ac07b2.ceee48",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div id=\"status\" width=\"100%\" align=\"center\">\n        <table id=\"widgetTable\" width=\"100%\" background=\"/img/blinky-webcam/blinky-webcam-01.jpg\" style=\"background-size:100%;background-repeat:no-repeat;background-position:center;height:75.0vw\">\n            <tr class=\"widget-line-height\">\n                <td align='center' width=\"100%\" style=\"padding-top:0vw;padding-bottom:0vw;\">\n                    <span id=\"waterTempDate\" style=\"font-size: 5vw; color:white;\"></span> \n                </td>\n            </tr>\n            <tr>\n                <td width=\"100%\">\n                    <table width=\"100%\">\n                        <tr class=\"widget-line-height\">\n                            <td align='left' width=\"40%\" style=\"padding-left:10vw;\">\n                                <span id='airTempLabel' style='font-size: 6vw; color:white;' >Luft</span>\n                            </td>\n                            <td align='right' width=\"60%\" style=\"padding-right:10vw;\"> \n                                <span id='airTemp' style='font-size: 6vw; color:white;' ></span>\n                            </td>\n                        </tr>\n                        <tr class=\"widget-line-height\">\n                            <td align='left'  width=\"40%\" style=\"padding-left:10vw;\">\n                                <span id='waterTempLabel' style='font-size: 6vw; color:white;' >Vatten</span>\n                            </td>\n                            <td  align='right' width=\"60%\" style=\"padding-right:10vw;\">\n                                <span id='waterTemp' style='font-size: 6vw; color:white;' ></span>\n                            </td>\n                        </tr>\n                        <tr class=\"widget-line-height\">\n                            <td align='left'  width=\"40%\" style=\"padding-left:10vw;\">\n                                <span id='windLabel' style='font-size: 6vw; color:white;' >Vindstyrka</span>\n                            </td>\n                            <td  align='right' width=\"60%\" style=\"padding-right:10vw;\">\n                                <span id='wind' style='font-size: 6vw; color:white;' ></span>\n                            </td>\n                        </tr>\n                        <tr class=\"widget-line-height\">\n                            <td align='left'  width=\"40%\" style=\"padding-left:10vw;\">\n                                <span id='gustsLabel' style='font-size: 6vw; color:white;' >Vindbyar</span>\n                            </td>\n                            <td  align='right' width=\"60%\" style=\"padding-right:10vw;\">\n                                <span id='gusts' style='font-size: 6vw; color:white;' ></span>\n                            </td>\n                        </tr>\n<!--\n                        <tr class=\"widget-line-height\">\n                            <td align='left'  width=\"40%\" style=\"padding-left:10vw;\">\n                                <span id='levelLabel' style='font-size: 6vw; color:white;' >Havsniv</span>\n                            </td>\n                            <td  align='right' width=\"60%\" style=\"padding-right:10vw;\">\n                                <span id='level' style='font-size: 6vw; color:white;' ></span>\n                            </td>\n                        </tr>\n\n                        <tr class=\"widget-line-height\">\n                            <td align='left'  width=\"40%\" style=\"padding-left:10vw;\">\n                                <span id='espotPriceLabel' style='font-size: 6vw; color:white;' >SE4 ePris</span>\n                            </td>\n                            <td  align='right' width=\"60%\" style=\"padding-right:10vw;\">\n                                <span id='espotPrice' style='font-size: 5.5vw; color:white;' ></span>\n                            </td>\n                        </tr>\n-->                        \n                    </table>\n                </td>\n            </tr>\n            <tr>\n                <td align='center' style=\"padding-top:8vw;padding-bottom:1vw;\">\n                    <table width=\"100%\">\n                        <tr class=\"widget-line-height\">\n                            <td align='left' style=\"padding-left:3vw;\">\n                                <span id='powerWhite' style=\"font-size: 3vw; color:white;\"></span><a href='/' target='_blank' id='blinkyLinkWhite' style=\"font-size: 3vw; color: white;text-decoration: underline;\">Mitt Brantevik</a>\n                            </td>\n                            <td align='right' style=\"padding-right:3vw;\">\n                                <span id=\"dataFetchMessage\" style=\"font-size: 3vw; color:white;\"></span>\n                            </td>\n                            <td align='right' style=\"padding-right:3vw;\">\n                                <button class='btn button-link' id=\"historyButton\" style=\"font-size: 3vw; color:white; border-color:white;\" onclick=\"getArchive(168)\" >Historik</button>\n                            </td>\n                        </tr>\n                    </table>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div id=\"historyChartContainer\" width=\"100%\" align=\"center\">\n        <table width=\"100%\">\n            <tr>\n                <td width=\"100%\">\n                    <div id=\"historyChart\" width=\"100%\" align=\"center\" style=\"border-width: 2px; border-style: solid; border-color: '#557a95'; border-radius: 3vw;background-color: #ecf2fe;\"></div>\n                </td>\n            </tr>\n            <tr>\n                <td align='center' >\n                    <table width=\"100%\">\n                        <tr>\n                            <td align='left' style=\"padding-left:3vw;\">\n                                <span id='powerBlack' style=\"font-size: 3vw; color:black;\">Powered by </span><a href='https://www.bl-mc.se' id='blinkyLinkBlack' style=\"font-size: 3vw; color: black;text-decoration: underline;\" target='_blank'>Blinky-Lite</a>\n                            </td>\n                            <td align='center' style=\"padding-right:3vw;\">\n                                <button class='btn button-link' id=\"tempButton\" style=\"font-size: 3vw; color:black; border-color:black;\" onclick=\"displayTemp()\" >Temp.</button>\n                            </td>\n                            <td align='center' style=\"padding-right:3vw;\">\n                                <button class='btn button-link' id=\"windButton\" style=\"font-size: 3vw; color:black; border-color:black;\" onclick=\"displayWind()\" >Vind</button>\n                            </td>\n                            <td align='center' style=\"padding-right:3vw;\">\n                                <button class='btn button-link' id=\"levelButton\" style=\"font-size: 3vw; color:black; border-color:black;\" onclick=\"displayLevel()\" >Niv</button>\n                            </td>\n                            <td align='center' style=\"padding-right:3vw;\">\n                                <button class='btn button-link' id=\"allButton\" style=\"font-size: 3vw; color:black; border-color:black;\" onclick=\"displayAll()\" >Allt</button>\n                            </td>\n                            <td align='right' style=\"padding-right:3vw;\">\n                                <button class='btn button-link' id=\"backButton\" style=\"font-size: 3vw; color:black; border-color:black;\" onclick=\"getStatus()\" >tillbaka</button>\n                            </td>\n                        </tr>\n                    </table>\n                </td>\n            </tr>\n        </table>\n    </div>\n",
        "output": "str",
        "x": 930,
        "y": 360,
        "wires": [
            [
                "eac0118b.f84"
            ]
        ]
    },
    {
        "id": "de9d819b.fe1b9",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.updateReadings",
        "field": "payload.script.updateReadings",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Update Readings Javascript\n        function updateAirTemp(device)\n        {\n            if ((new Date().getTime() - device.timeStamp) < 3600000)\n            {\n                $('#airTemp').text(device.temperature.value.toFixed(1) + ' C');\n            }\n        }\n        function updateWaterTemp(device)\n        {\n            if ((new Date().getTime() - device.timeStamp) < 3600000)\n            {\n                $('#waterTemp').text(device.tempA.value.toFixed(1) + ' C');\n                var level = device.refDistance.value - device.ultraDistanceAvg.value;\n//              $('#level').text(level.toFixed(0) + ' cm');\n//              $('#waterTemp').text('?');\n            }\n        }\n        function updateWind(device)\n        {\n            if ((new Date().getTime() - device.timeStamp) < 3600000)\n            {\n                $('#wind').text(getDirectionText(device.windDirection1.value) + ' ' + device.windSpeed1.value.toFixed(1) + ' m/s');\n                $('#gusts').text(getDirectionText(device.windDirection2.value) + ' ' + device.gusts.value.toFixed(1) + ' m/s');\n            }\n        }\n        function updateEspotPrice(device)\n        {\n             $('#espotPrice').text(device.price.value.toFixed(2) + ' SEK/kW-hr');\n        }\n        function getDirectionText(wd)\n        {\n            var dirText = '';           \n            if ((  0.0 <= wd) && (wd <=  22.5)) dirText = 'N ';\n            if (( 22.5 <  wd) && (wd <=  67.5)) dirText = 'NO';\n            if (( 67.5 <  wd) && (wd <= 112.5)) dirText = 'O ';\n            if ((112.5 <  wd) && (wd <= 157.5)) dirText = 'SO';\n            if ((157.5 <  wd) && (wd <= 202.5)) dirText = 'S ';\n            if ((202.5 <  wd) && (wd <= 247.5)) dirText = 'SV';\n            if ((247.5 <  wd) && (wd <= 292.5)) dirText = 'V ';\n            if ((292.5 <  wd) && (wd <= 337.5)) dirText = 'NV';\n            if ((337.5 <  wd) && (wd <= 360.0)) dirText = 'N ';\n            return dirText;\n        }\n",
        "output": "str",
        "x": 760,
        "y": 280,
        "wires": [
            [
                "e67f95a4.5dbfa8"
            ]
        ]
    },
    {
        "id": "eac0118b.f84",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "CSS",
        "field": "payload.css",
        "fieldType": "msg",
        "format": "css",
        "syntax": "mustache",
        "template": "        :root \n        {\n          --color1: #415c71;\n          --color2: #547792;\n          --color3: #9eb5c7;\n          --color4: #c6c2bb;\n          --color5: #fdc300;\n          --big-text-size :300%;\n          --bold-text :900;\n          --vert-pad : 25px;\n          --horz-pad : 25px;\n        }\n        body \n        {\n            max-width: 100%;\n            background-color: transparent !important;\n        }\n        .widget-line-height\n        {\n            line-height: 7.3vw;\n        }\n        img \n        {\n          object-fit: contain;\n        }\n        a\n        {\n            color: white;\n        }\n        a:visited \n        { \n            color: var(--white);\n        }\n        a:hover \n        { \n            color: var(--color5);\n        }\n\n        .jumbotron \n        {\n          background-color: var(--color2) !important;\n          color: white;\n          padding-top:25px;\n          padding-bottom:25px;\n        }\n        .jumbotron-title\n        {\n          color:var(--color5);\n        }\n        .jumbotron-button\n        {\n          color: white;\n          background-color: var(--color1);\n       }\n        .card\n        {\n          background-color: var(--color2) !important;\n          text-align: center;\n        }\n        .card-body\n        {\n          background-color: var(--color3);;\n        }\n        .card-button\n        {\n          color: var(--color5) !important;\n          background-color: var(--color1) !important;\n          font-weight: bold;\n        }\n        .card-title\n        {\n          color: var(--color5);\n          font-weight: var(--bold-text);\n          font-size: var(--big-text-size);\n         }\n        .card-text\n        {\n          color: white;\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .danger-card\n        {\n          background-color: yellow !important;\n          text-align: center;\n        }\n        .danger-card-body\n        {\n          background-color: yellow;\n        }\n        .danger-card-button\n        {\n          color: yellow !important;\n          background-color: red !important;\n          font-weight: bold;\n        }\n        .danger-card-title\n        {\n          color: red;\n          font-weight: var(--bold-text);\n          font-size: var(--big-text-size);\n         }\n        .danger-card-text\n        {\n          color: white;\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .tableHeading\n        {\n          color:var(--container-title-color);\n        }\n        .tableText\n        {\n          color:var(--container-text-color);\n          font-size: var(--big-text-size);\n        }\n       .vert-pad\n        {\n            padding-top:var(--vert-pad);;\n            padding-bottom:var(--vert-pad);;\n        }\n        .horz-pad\n        {\n            padding-left:var(--horz-pad);;\n            padding-right:var(--horz-pad);;\n        }\n        .big-text\n        {\n            font-size: var(--big-text-size);\n        }\n        .bold-text\n        {\n            font-weight: var(--bold-text);\n        }\n       .ui-dialog-titlebar-close \n        {\n            visibility: hidden;\n        }\n        input.inputLarger \n        { \n            transform: scale(3); \n            margin: 1px;\n        }\n        .googleSlide4by3-container \n        {\n            position: relative;\n            overflow: hidden;\n            padding-top: 75.0%;\n        }\n        .googleSlide4by3-iframe {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            border: 0;\n        }        \n        .custom-select\n        {\n            color: black;\n            background-color: white;\n            height:80px;\n            line-height:70px;\n        }\n        .button-link \n        {\n            background: none!important;\n            border-type: solid;\n            padding: 2px!important;\n            cursor: pointer;\n        }\n",
        "output": "str",
        "x": 1070,
        "y": 360,
        "wires": [
            [
                "b744aba3.c55a18"
            ]
        ]
    },
    {
        "id": "e67f95a4.5dbfa8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.archive",
        "field": "payload.script.archive",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Archive JavaScript\n        var archiveRequestList = [];\n        var archiveList = [];\n        function getArchive(hours)\n        { \n            if (validArchiveData)\n            {\n                var width = $(\"#status\").width() * 0.92;\n                var height = $(\"#status\").height() * 0.87;\n                historyPlotLayout.width = width.toFixed(0);\n                historyPlotLayout.height = height.toFixed(0);\n                $(\"#status\").hide();\n                $(\"#historyChartContainer\").show();\n//                Plotly.newPlot('historyChart', [historyPlotTrace1,historyPlotTrace2, historyPlotTrace3, historyPlotTrace5], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n                Plotly.newPlot('historyChart', [historyPlotTrace1,historyPlotTrace2, historyPlotTrace3], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n                return;\n            }\n            $(\"#historyButton\").hide();\n            $(\"#dataFetchMessage\").text('Hmtar data...');\n\n            archiveRequestList = [];\n            archiveList = [];\n            var stopDate = new Date().getTime();\n            var startDate = stopDate - hours * 3600000;\n            if (startDate < 1627166453473) startDate = 1627166453473; //when ultra distance was added\n            archiveRequestList[0] = \n            {\n                deviceType : 'blinky-DS18B20',\n                name : 'Brantevik', \n                attr : ['tempA','ultraDistanceAvg','refDistance'],\n                startDate: startDate, \n                stopDate: stopDate,\n            };\n            archiveRequestList[1] = \n            {\n                deviceType : 'blinky-wind',\n                name : 'Brantevik', \n                attr : ['temperature','windSpeed2','windDirection2','gusts'],\n                startDate: startDate, \n                stopDate: stopDate,\n            };\n\n            getArchiveValues();\n        }\n        function getArchiveValues()\n        {\n            var actionMsg = \n                {\n                    device      : archiveRequestList[0]\n                };\n//            sendActionMsg('readDatabase','readDatabase', actionMsg);\n            var webSocketMsg = \n            {\n                topic     : 'readDatabase',\n                payload   : actionMsg,\n                userID    : userID,\n            };\n            ws.send(JSON.stringify(webSocketMsg));\n            archiveRequestList.shift();\n            return;\n        }\n        function putArchiveValues(data)\n        {\n            archiveList.push(data);\n            if (archiveRequestList.length > 0)\n            {\n                getArchiveValues();\n            }\n            else\n            {\n                plotArchive();\n            }\n        }\n        var historyPlotLayout = \n        {\n            plot_bgcolor:\"#ecf2fe\",\n            paper_bgcolor:\"#ecf2fe\",\n            showlegend  : true,\n            legend      : { x: 0, y: 1.15,\"orientation\": \"h\"},\n            height      : '100',\n            width       : '200',\n            xaxis       :\n            {\n//                    title: 'Hours since ' + new Date(archiveList[0].device.stopDate).toLocaleString(),\n                type: 'date',\n                tickformat: '%d-%m %H:%M', // For more time formatting types, see: https://github.com/d3/d3-time-format/blob/master/README.md\n                fixedrange      : true,\n                dtick : 86400000\n            },\n            yaxis:\n            {\n                title           : '',\n                titlefont       : {color: 'black'},\n                tickfont        : {color: 'black'},\n                gridcolor       : 'grey',\n                zerolinecolor   : 'grey',\n                linecolor       : 'grey',\n                fixedrange      : true\n//                    range           : [0,30],\n//                    dtick           :  5\n\n            },\n            margin: \n            {\n                l: 35,\n                r: 5,\n                b: 25,\n                t: 1,\n                pad: 0\n            }\n        };\n        var historyPlotTrace1 = \n        {\n            x: [],\n            y: [],\n            name: 'Hav (C)',\n            hovertemplate: '%{y}C',\n            yaxis: 'y1',\n            type: 'scatter',\n            mode: 'lines',\n            line: { color:  '#557a95',width:2},\n            visible: true\n\n        };\n        var historyPlotTrace2 = \n        {\n            x: [],\n            y: [],\n            name: 'Luft (C)',\n            hovertemplate: '%{y}C',\n            yaxis: 'y1',\n            type: 'scatter',\n            mode: 'lines',\n            line: { color:  '#f2a31f',width:2},\n            visible: true\n\n        };\n        var historyPlotTrace3 = \n        {\n            x: [],\n            y: [],\n            text: [],\n            name: 'Vind (m/s)',\n            hovertemplate: '<b>%{text}</b> %{y}m/S',\n            yaxis: 'y1',\n            type: 'scatter',\n            mode: 'lines',\n            line: { color:  'red',width:2},\n            visible: true\n\n        };\n        var historyPlotTrace4 = \n        {\n            x: [],\n            y: [],\n            name: 'byar (m/s)',\n            hovertemplate: '%{y}cm',\n            yaxis: 'y1',\n            type: 'scatter',\n            mode: 'lines',\n            line: { color:  'black',width:1, dash: 'dot',},\n            visible: true\n\n        };\n        var historyPlotTrace5 = \n        {\n            x: [],\n            y: [],\n            name: 'niv (cm)',\n            hovertemplate: '%{y}cm',\n            yaxis: 'y1',\n            type: 'scatter',\n            mode: 'lines',\n            line: { color:  'green',width:2},\n            visible: true\n\n        };\n         var historyPlotHeightRatio = 1.0;\n        function plotArchive()\n        {\n            $(\"#dataFetchMessage\").text('');\n            $(\"#historyButton\").show();\n            \n            var width = $(\"#status\").width() * 0.92;\n            var height = $(\"#status\").height() * 0.87;\n            historyPlotHeightRatio = height / width;\n            historyPlotLayout.width = width.toFixed(0);\n            historyPlotLayout.height = height.toFixed(0);\n            \n            $(\"#status\").hide();\n            $(\"#historyChartContainer\").show();\n            validArchiveData = true;\n            historyPlotTrace1.x = [];\n            historyPlotTrace1.y = [];\n            historyPlotTrace2.x = [];\n            historyPlotTrace2.y = [];\n            historyPlotTrace3.x = [];\n            historyPlotTrace3.y = [];\n            historyPlotTrace3.text = [];\n            historyPlotTrace4.x = [];\n            historyPlotTrace4.y = [];\n            historyPlotTrace4.text = [];\n            historyPlotTrace5.x = [];\n            historyPlotTrace5.y = [];\n            var waterTempBeginTime = 1627166453473; //10pm July 24 2021 is 1627158411481\n            for (var ii = 0; ii < archiveList[0].trace.length; ++ii)\n            {\n                var x = archiveList[0].trace[ii].timeStamp;\n                var y = archiveList[0].trace[ii][archiveList[0].device.attr[0]];\n                if ((x > waterTempBeginTime) && (y > 0))\n                {\n                    historyPlotTrace1.x.push(x);\n                    historyPlotTrace1.y.push(y) ;\n                }\n            }\n            for (var ii = 0; ii < archiveList[1].trace.length; ++ii)\n            {\n                var x = archiveList[1].trace[ii].timeStamp;\n                if (x > waterTempBeginTime)\n                {\n                    historyPlotTrace2.x.push(x);\n                    historyPlotTrace2.y.push(archiveList[1].trace[ii][archiveList[1].device.attr[0]]) ;\n                    historyPlotTrace3.x.push(x);\n                    historyPlotTrace3.y.push(archiveList[1].trace[ii][archiveList[1].device.attr[1]]) ;\n                    historyPlotTrace3.text.push(getDirectionText(archiveList[1].trace[ii][archiveList[1].device.attr[2]]));\n                    historyPlotTrace4.x.push(x);\n                    historyPlotTrace4.y.push(archiveList[1].trace[ii][archiveList[1].device.attr[3]]) ;\n                    historyPlotTrace4.text.push(getDirectionText(archiveList[1].trace[ii][archiveList[1].device.attr[2]]));\n                }\n            }\n            for (var ii = 0; ii < archiveList[0].trace.length; ++ii)\n            {\n                var x = archiveList[0].trace[ii].timeStamp;\n                var ultraDistanceAvg = archiveList[0].trace[ii][archiveList[0].device.attr[1]];\n                var refDistance      = archiveList[0].trace[ii][archiveList[0].device.attr[2]];\n                if (x > waterTempBeginTime)\n                {\n                    historyPlotTrace5.x.push(x);\n                    historyPlotTrace5.y.push(refDistance - ultraDistanceAvg) ;\n                }\n            }\n//            Plotly.newPlot('historyChart', [historyPlotTrace1,historyPlotTrace2,historyPlotTrace3,historyPlotTrace5], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n            Plotly.newPlot('historyChart', [historyPlotTrace1,historyPlotTrace2,historyPlotTrace3], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n        }\n        function displayTemp()\n        {\n            Plotly.newPlot('historyChart', [historyPlotTrace1,historyPlotTrace2], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n            return;\n        }\n        function displayWind()\n        {\n            Plotly.newPlot('historyChart', [historyPlotTrace3,historyPlotTrace4], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n            return;\n        }\n        function displayLevel()\n        {\n            Plotly.newPlot('historyChart', [historyPlotTrace5], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n            return;\n        }\n        function displayAll()\n        {\n//            Plotly.newPlot('historyChart', [historyPlotTrace1,historyPlotTrace2, historyPlotTrace3, historyPlotTrace5], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n            Plotly.newPlot('historyChart', [historyPlotTrace1,historyPlotTrace2, historyPlotTrace3], historyPlotLayout, {displayModeBar: false, staticPlot: false});\n            return;\n        }\n",
        "output": "str",
        "x": 730,
        "y": 320,
        "wires": [
            [
                "e2dfd322.f1489"
            ]
        ]
    },
    {
        "id": "a972d9ab.0fcfd8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card' id=\"longAgo\">\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"100%\" align=\"center\">\n                                            <span  class='card-title'>Lnge sedan...</span>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" >\n                                            <img id=\"brantePic\" src=\"/img/brantevikPics/BrantePic00.jpg\" height=\"600px\"/>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                    <div class='card' id=\"headline\">\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/bsf'>Mer info</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Nyheter</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 565px; overflow:hidden; max-height:565px;\" >\n                                            <iframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vT6dGH77Hrwq0-1M4_7dXphGSUruQsQm0LV0L895oBhjFq_dpUJ9UHtikmyDkWcygzxgd6E_sijmsDj/embed?start=true&loop=true&delayms=6000\" frameborder=\"0\" width=\"750\" height=\"600\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/activities\">Aktiviteter</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                         <a class=\"btn btn-block card-button\" href=\"/todo\">Kul i solen</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                         <a class=\"btn btn-block card-button\" href=\"/restaurants\">Mat och dryck</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                         <a class=\"btn btn-block card-button\" href=\"https://www.blinky-lite.se/espotPrice?name=SE4\">El-Prissensor</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-2'>\n                            </div>\n                            <div class='col-md-8'>\n<!--\n                                <p class='card-title'>Vdret just nu</p> \n-->\n                             </div>\n                            <div class='col-md-2'>\n                            </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <div class='row'>\n                                <div class='col-md-12'>\n\n                                    <div style=\"height: 75vw; overflow:hidden; max-height:635px;\">\n                                        <iframe scrolling=\"no\" width=\"100%\" height=\"100%\" style=\"border:0;background: #9eb5c7;\" src=\"/brantevik-weather-widget\" allowtransparency=\"true\"></iframe>\n                                    </div>\n                               </div>\n                            </div>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1140,
        "wires": [
            [
                "4595d546.0ef14c"
            ]
        ]
    },
    {
        "id": "736640bd.dccde",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1140,
        "wires": [
            [
                "79c5e14a.ff3b2"
            ]
        ]
    },
    {
        "id": "5e3b8709.00aa88",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let numberBrantePics = 17;\n\n        function onDocumentReady()\n        {\n\n            var picNum =  Math.floor(Math.random() * numberBrantePics) + 1;\n            if (picNum < 10)\n            {\n                $(\"#brantePic\").attr(\"src\",\"/img/brantevikPics/BrantePic0\" + picNum.toString() +\".jpg\");\n            }\n            else\n            {\n                $(\"#brantePic\").attr(\"src\",\"/img/brantevikPics/BrantePic\" + picNum.toString() +\".jpg\");\n            }\n\n            $('#headline').hide();\n            setTimeout(changeHeadline, 6000);\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function changeHeadline()\n        {\n            $('#longAgo').fadeOut(1000, fadeInNewHeadLine);\n\n        }\n        function fadeInNewHeadLine()\n        {\n            $('#headline').fadeIn(1000);\n        }\n        \n",
        "output": "str",
        "x": 710,
        "y": 1140,
        "wires": [
            [
                "736640bd.dccde"
            ]
        ]
    },
    {
        "id": "d8e50beb.98d0b8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Mitt Brantevik",
        "output": "str",
        "x": 560,
        "y": 1140,
        "wires": [
            [
                "5e3b8709.00aa88"
            ]
        ]
    },
    {
        "id": "fafa9afc.e8fb48",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/",
        "url": "/",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 1140,
        "wires": [
            [
                "a8ae5af196f0af35"
            ]
        ]
    },
    {
        "id": "f82e9f6d.7a78",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Kul i solen</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" id=\"slideshow\"></div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/cycle\">Cykling</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/bath\">Bad</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                                <tr >\n                                    <td  align=\"center\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/gronet\">Grnet</a>\n                                    </td>\n                                    <td  align=\"center\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/sail\">Segling</a>\n                                    </td>\n                                    <td  align=\"center\">\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1300,
        "wires": [
            [
                "d6c3718c.10d1f"
            ]
        ]
    },
    {
        "id": "38be5715.7fea78",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1300,
        "wires": [
            [
                "fd066317.f89a"
            ]
        ]
    },
    {
        "id": "c614ea0d.426f78",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let slideShowSlides = [];\n        let slideIndex = 0;\n\n        function onDocumentReady()\n        {\n            createSlideShow(10,\"/img/BrantevikThingsToDoPics\");\n            showSlides();\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function createSlideShow(numPics,imageDirectory)\n        {\n            let slidesshowContainer = document.createElement('div');\n            slidesshowContainer.setAttribute('class', 'slideshow-container');\n            for (let ii = 0; ii < numPics; ++ii)\n            {\n                let slideshowSlide = document.createElement('div');\n                slideshowSlide.setAttribute('class', 'slideshowSlides fade');\n                let slideshowSlideImg = document.createElement('img');\n                slideshowSlideImg.setAttribute('src', imageDirectory + '/pic' + (ii + 1).toString() + '.png');\n                slideshowSlideImg.setAttribute('style', 'width:100%');\n                slideshowSlide.appendChild(slideshowSlideImg);\n                slidesshowContainer.appendChild(slideshowSlide);\n                slideShowSlides.push(slideshowSlide);\n            }\n            document.getElementById('slideshow').appendChild(slidesshowContainer);\n            return;\n        }\n        function showSlides() \n        {\n            for (let ii = 0; ii < slideShowSlides.length; ii++)\n            {\n                slideShowSlides[ii].style.display = \"none\";\n            }\n            slideIndex++;\n            if (slideIndex > slideShowSlides.length) {slideIndex = 1}\n            slideShowSlides[slideIndex-1].style.display = \"block\";\n            setTimeout(showSlides, 3000); // Change image every 2 seconds\n        }",
        "output": "str",
        "x": 710,
        "y": 1300,
        "wires": [
            [
                "38be5715.7fea78"
            ]
        ]
    },
    {
        "id": "e6619631.b046f8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Branteviks Kul i solen",
        "output": "str",
        "x": 560,
        "y": 1300,
        "wires": [
            [
                "c614ea0d.426f78"
            ]
        ]
    },
    {
        "id": "7eb14e9.0b8dab",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo",
        "url": "/todo",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 1300,
        "wires": [
            [
                "ba3b805eed633709"
            ]
        ]
    },
    {
        "id": "1d897ed.7bae081",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Bad</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" id=\"slideshow\"></div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/bath/map\">Badstllen</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                           </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1400,
        "wires": [
            [
                "aabf4656.076108"
            ]
        ]
    },
    {
        "id": "9ab6cfa7.9c10c",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1400,
        "wires": [
            [
                "e27d3d65.43fe5"
            ]
        ]
    },
    {
        "id": "87f80e.ac5557f",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Badstllen i Brantevik",
        "output": "str",
        "x": 560,
        "y": 1400,
        "wires": [
            [
                "da5a963203c34c2f"
            ]
        ]
    },
    {
        "id": "e7383ef6.ca6d4",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/bath",
        "url": "/todo/bath",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 1400,
        "wires": [
            [
                "e72b83ab1fccf824"
            ]
        ]
    },
    {
        "id": "e1a92896.8be2b8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo/bath'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Badstllen  Karta</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"40px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\">\n                                            <iframe src=\"https://www.google.com/maps/d/u/0/embed?mid=1L98foG-CqAUDTY4PxEw6K1P7vpbD7cP2\" width=\"800\" height=\"600\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1460,
        "wires": [
            [
                "ee4c8924.72b548"
            ]
        ]
    },
    {
        "id": "bba84aa8.51ba88",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1460,
        "wires": [
            [
                "32ab265c.6e442a"
            ]
        ]
    },
    {
        "id": "31eb36d8.a3084a",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 1460,
        "wires": [
            [
                "bba84aa8.51ba88"
            ]
        ]
    },
    {
        "id": "5d0603af.2d6fec",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantevik Badstllen Karta ",
        "output": "str",
        "x": 560,
        "y": 1460,
        "wires": [
            [
                "31eb36d8.a3084a"
            ]
        ]
    },
    {
        "id": "543d8672.4ccd48",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/bath/map",
        "url": "/todo/bath/map",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 1460,
        "wires": [
            [
                "cb5acacfb2667868"
            ]
        ]
    },
    {
        "id": "4595d546.0ef14c",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1140,
        "wires": []
    },
    {
        "id": "d6c3718c.10d1f",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1300,
        "wires": []
    },
    {
        "id": "aabf4656.076108",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1400,
        "wires": []
    },
    {
        "id": "ee4c8924.72b548",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1460,
        "wires": []
    },
    {
        "id": "c3a86ac6.d68698",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Karta</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\">\n                                             <iframe src=\"https://www.google.com/maps/d/u/0/embed?mid=1kMtdw72Vteq6-Ua1A0HCbZ4hVld1frLd\" width=\"800\" height=\"600\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n    ",
        "output": "str",
        "x": 1130,
        "y": 1220,
        "wires": [
            [
                "14a6d4b9.ce794b"
            ]
        ]
    },
    {
        "id": "a397ce69.b1144",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1220,
        "wires": [
            [
                "db14c381.e49f7"
            ]
        ]
    },
    {
        "id": "125d8ae5.b1df65",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 1220,
        "wires": [
            [
                "a397ce69.b1144"
            ]
        ]
    },
    {
        "id": "931efe46.16a55",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantevik Karta ",
        "output": "str",
        "x": 560,
        "y": 1220,
        "wires": [
            [
                "125d8ae5.b1df65"
            ]
        ]
    },
    {
        "id": "dbc99eb5.398b8",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/map",
        "url": "/map",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 1220,
        "wires": [
            [
                "6f5cd19eb00b19ae"
            ]
        ]
    },
    {
        "id": "14a6d4b9.ce794b",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1220,
        "wires": []
    },
    {
        "id": "365d2074.06e0a",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Cykling</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" id=\"slideshow\"></div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/cycle/tur1\">Gislv tur</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/cycle/tur2\">Gladsax tur</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                           </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1540,
        "wires": [
            [
                "e12d85c1.0510c8"
            ]
        ]
    },
    {
        "id": "583d5d9.c3c7da4",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1540,
        "wires": [
            [
                "ba54bb7.dacc848"
            ]
        ]
    },
    {
        "id": "20f7d092.c524",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantevik Cykling",
        "output": "str",
        "x": 560,
        "y": 1540,
        "wires": [
            [
                "8bfc46018aaf1fe5"
            ]
        ]
    },
    {
        "id": "21a94ada.915736",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/cycle",
        "url": "/todo/cycle",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 1540,
        "wires": [
            [
                "90e4237d4ffffd97"
            ]
        ]
    },
    {
        "id": "e12d85c1.0510c8",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1540,
        "wires": []
    },
    {
        "id": "5f628e6a.156d1",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo/cycle'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Gislv tur</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\">\n                                            <iframe src=\"https://www.google.com/maps/d/u/0/embed?mid=1N6YyckM81IVvZWOuFlek9zOmmbP0r0WT\" width=\"800\" height=\"600\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1600,
        "wires": [
            [
                "f5506065.4eb82"
            ]
        ]
    },
    {
        "id": "2993082b.9a5e38",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1600,
        "wires": [
            [
                "851f0d78.9dd91"
            ]
        ]
    },
    {
        "id": "f5cecf06.89159",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 1600,
        "wires": [
            [
                "2993082b.9a5e38"
            ]
        ]
    },
    {
        "id": "1b2f758f.ca89ea",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Gislv tur",
        "output": "str",
        "x": 560,
        "y": 1600,
        "wires": [
            [
                "f5cecf06.89159"
            ]
        ]
    },
    {
        "id": "dcdd7264.9ca1c",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/cycle/tur1",
        "url": "/todo/cycle/tur1",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 1600,
        "wires": [
            [
                "ac9832e570eb65af"
            ]
        ]
    },
    {
        "id": "f5506065.4eb82",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1600,
        "wires": []
    },
    {
        "id": "7485eaed.7e2114",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo/cycle'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Gladsax tur</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\">\n                                            <iframe src=\"https://www.google.com/maps/d/u/0/embed?mid=1-ryEeDcDlovvB-1UWU5VLqblUHj9kfzR\" width=\"800\" height=\"600\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1660,
        "wires": [
            [
                "9e092c69.8539b"
            ]
        ]
    },
    {
        "id": "a68f1d0b.9b02",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1660,
        "wires": [
            [
                "afa88842.756b58"
            ]
        ]
    },
    {
        "id": "851dd4ae.a976e8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 1660,
        "wires": [
            [
                "a68f1d0b.9b02"
            ]
        ]
    },
    {
        "id": "9eac337a.df2a3",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Gladsax tur",
        "output": "str",
        "x": 560,
        "y": 1660,
        "wires": [
            [
                "851dd4ae.a976e8"
            ]
        ]
    },
    {
        "id": "f11f87d5.6bbc68",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/cycle/tur2",
        "url": "/todo/cycle/tur2",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 1660,
        "wires": [
            [
                "c6f16d2495d42f9b"
            ]
        ]
    },
    {
        "id": "9e092c69.8539b",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1660,
        "wires": []
    },
    {
        "id": "79c5e14a.ff3b2",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1140,
        "wires": [
            [
                "a972d9ab.0fcfd8"
            ]
        ]
    },
    {
        "id": "db14c381.e49f7",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1220,
        "wires": [
            [
                "c3a86ac6.d68698"
            ]
        ]
    },
    {
        "id": "fd066317.f89a",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1300,
        "wires": [
            [
                "f82e9f6d.7a78"
            ]
        ]
    },
    {
        "id": "e27d3d65.43fe5",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1400,
        "wires": [
            [
                "1d897ed.7bae081"
            ]
        ]
    },
    {
        "id": "32ab265c.6e442a",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1460,
        "wires": [
            [
                "e1a92896.8be2b8"
            ]
        ]
    },
    {
        "id": "ba54bb7.dacc848",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1540,
        "wires": [
            [
                "365d2074.06e0a"
            ]
        ]
    },
    {
        "id": "851f0d78.9dd91",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1600,
        "wires": [
            [
                "5f628e6a.156d1"
            ]
        ]
    },
    {
        "id": "afa88842.756b58",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1660,
        "wires": [
            [
                "7485eaed.7e2114"
            ]
        ]
    },
    {
        "id": "1a1a676b.55eab9",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Grnet</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" id=\"slideshow\"></div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1720,
        "wires": [
            [
                "c7c4b87f.2ca7c8"
            ]
        ]
    },
    {
        "id": "90f09e1a.646b1",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1720,
        "wires": [
            [
                "3a446093.5e22f"
            ]
        ]
    },
    {
        "id": "4c7220ba.e90a2",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Grnet",
        "output": "str",
        "x": 560,
        "y": 1720,
        "wires": [
            [
                "61eaeeafc0b3f6c5"
            ]
        ]
    },
    {
        "id": "b4ccd2f2.986ca",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/gronet",
        "url": "/todo/gronet",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 1720,
        "wires": [
            [
                "62fb0c57476eb887"
            ]
        ]
    },
    {
        "id": "c7c4b87f.2ca7c8",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1720,
        "wires": []
    },
    {
        "id": "3a446093.5e22f",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1720,
        "wires": [
            [
                "1a1a676b.55eab9"
            ]
        ]
    },
    {
        "id": "b7c01454.da29c8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Segling</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" id=\"slideshow\"></div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/sail/jaktenHoppet\">Jakten Hoppet</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo/sail/museum\">Sjfartsmuseet</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                           </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1780,
        "wires": [
            [
                "abab2ca1.f9317"
            ]
        ]
    },
    {
        "id": "ec093ff7.10a48",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1780,
        "wires": [
            [
                "cd1cd69a.6c3128"
            ]
        ]
    },
    {
        "id": "d0d22251.c8a21",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantevik Segling",
        "output": "str",
        "x": 560,
        "y": 1780,
        "wires": [
            [
                "2dbd1d09b863686b"
            ]
        ]
    },
    {
        "id": "2bab1d11.4568e2",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/sail",
        "url": "/todo/sail",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 1780,
        "wires": [
            [
                "bfc1d1b53ba81b5b"
            ]
        ]
    },
    {
        "id": "abab2ca1.f9317",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1780,
        "wires": []
    },
    {
        "id": "cd1cd69a.6c3128",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1780,
        "wires": [
            [
                "b7c01454.da29c8"
            ]
        ]
    },
    {
        "id": "2b2b204.8ab1ae",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo/sail'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Sjfartsmuseet</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" id=\"slideshow\"></div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"http://www.branteviksmuseum.se/\" target=\"_blank\">Websida</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                           </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1110,
        "y": 1900,
        "wires": [
            [
                "b4196528.12c958"
            ]
        ]
    },
    {
        "id": "4c690f46.ed348",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 840,
        "y": 1900,
        "wires": [
            [
                "384aa21c.4d773e"
            ]
        ]
    },
    {
        "id": "a66b3aba.c717d8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantevik Sjfartsmuseet",
        "output": "str",
        "x": 540,
        "y": 1900,
        "wires": [
            [
                "04220470e2deb0c5"
            ]
        ]
    },
    {
        "id": "81913d22.1b7c9",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/sail/museum",
        "url": "/todo/sail/museum",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 1900,
        "wires": [
            [
                "4ded33c5c3a34424"
            ]
        ]
    },
    {
        "id": "b4196528.12c958",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1250,
        "y": 1900,
        "wires": []
    },
    {
        "id": "384aa21c.4d773e",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 980,
        "y": 1900,
        "wires": [
            [
                "2b2b204.8ab1ae"
            ]
        ]
    },
    {
        "id": "4ead6af1.26e7a4",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-2'>\n                            </div>\n                            <div class='col-md-8'>\n                                <p class='card-title'>Vdret just nu</p>\n                             </div>\n                            <div class='col-md-2'>\n                            </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <div class='row'>\n                                <div class='col-md-12'>\n\n                                    <div style=\"height: 60vw; overflow:hidden; max-height:550px;\">\n                                        <iframe scrolling=\"no\" width=\"100%\" height=\"100%\" style=\"border:0;background: #9eb5c7;\" src=\"/brantevik-weather-widget\" allowtransparency=\"true\"></iframe>\n                                    </div>\n                               </div>\n                            </div>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-2'>\n                            </div>\n                            <div class='col-md-8'>\n                                <p class='card-title'>Nyheter</p>\n                             </div>\n                            <div class='col-md-2'>\n                            </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div id='headline1' style=\"width: 800px; height: 565px; overflow:hidden; max-height:565px;\" >\n                                            <iframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vQyeXwm2-F1pTn5FtRMZRl7l_CHhhi2W4V0qmpsteqi_meFTJRchpktSVhX4284Zp7Ax-Gm7kIteAA7/embed?start=true&loop=true&delayms=3000\" frameborder=\"0\" width=\"750\" height=\"600\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\" ></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div id='headline2' style=\"width: 800px; height: 565px; overflow:hidden; max-height:565px;\" >\n                                            <iframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vS6AUEiT08EBNztgwkl2zG2FqGkk9KiESrL6Ih5UF_Ip1ErA2DEwWud5cOlC9lCfedxDi2PbxIFE88g/embed?start=true&loop=true&delayms=3000\" frameborder=\"0\" width=\"750\" height=\"600\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div id='headline3' style=\"width: 800px; height: 565px; overflow:hidden; max-height:565px;\" >\n                                            <iframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vT6dGH77Hrwq0-1M4_7dXphGSUruQsQm0LV0L895oBhjFq_dpUJ9UHtikmyDkWcygzxgd6E_sijmsDj/embed?start=true&loop=true&delayms=3000\" frameborder=\"0\" width=\"750\" height=\"600\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/todo\">Aktiviteter</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                         <a class=\"btn btn-block card-button\" href=\"/restaurants\">Mat och dryck</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                                <tr >\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                    </td>\n                                    <td align=\"center\" style=\"padding-top:15px;\">\n                                        <a class=\"btn btn-block card-button\" href=\"/map\">Karta</a>\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                    </td>\n                                    <td align=\"center\" style=\"padding-top:15px;\">\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1110,
        "y": 2180,
        "wires": [
            [
                "f56dc0df.af507"
            ]
        ]
    },
    {
        "id": "60069956.3b33e8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 840,
        "y": 2180,
        "wires": [
            [
                "bb861ad.1e358e8"
            ]
        ]
    },
    {
        "id": "28815a0d.2cfc66",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        var numHeadlines = 3;\n        var headlineShowing = 1;\n        var showHeadline = 0;\n        var showHeadlineName = '';\n        var closeHeadlineName = '';\n\n        function onDocumentReady()\n        {\n            if (numHeadlines > 1)\n            {\n                for (var ih = 2; ih <= numHeadlines; ++ih)\n                {\n                    var headlineName = '#headline' + ih.toString();\n                    $(headlineName).hide();\n\n                }\n            }\n            setInterval(changeHeadline, 6000);\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function changeHeadline()\n        {\n            if (numHeadlines == 1) return;\n            showHeadline = headlineShowing + 1;\n            if (showHeadline > numHeadlines) showHeadline = 1;\n            \n            showHeadlineName =  '#headline' + showHeadline.toString();\n            closeHeadlineName =  '#headline' + headlineShowing.toString();\n            $(closeHeadlineName).fadeOut(1000, fadeInNewHeadLine);\n            headlineShowing = showHeadline;\n            \n        }\n        function fadeInNewHeadLine()\n        {\n            $(showHeadlineName).fadeIn(1000);\n        }\n        \n",
        "output": "str",
        "x": 690,
        "y": 2180,
        "wires": [
            [
                "60069956.3b33e8"
            ]
        ]
    },
    {
        "id": "b27eebf6.3f9ad8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Mitt Brantevik",
        "output": "str",
        "x": 540,
        "y": 2180,
        "wires": [
            [
                "28815a0d.2cfc66"
            ]
        ]
    },
    {
        "id": "28c13965.54ca56",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/demo",
        "url": "/demo",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 2180,
        "wires": [
            [
                "80b0433d849aa7c0"
            ]
        ]
    },
    {
        "id": "f56dc0df.af507",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1250,
        "y": 2180,
        "wires": []
    },
    {
        "id": "bb861ad.1e358e8",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 980,
        "y": 2180,
        "wires": [
            [
                "4ead6af1.26e7a4"
            ]
        ]
    },
    {
        "id": "5fa0eb6f.aaee94",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Mat och dryck</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" id=\"slideshow\"></div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/restaurants/branterogen\">Brantergen</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/restaurants/bfisk\">Branteviks Fisk</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                                <tr >\n                                    <td  align=\"center\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                        <a class=\"btn btn-block card-button\" href=\"/restaurants/bobergs\">Hamngrden</a>\n                                    </td>\n                                    <td  align=\"center\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                        <a class=\"btn btn-block card-button\" href=\"/restaurants/hornans\">Hrnan</a>\n                                    </td>\n                                    <td  align=\"center\">\n                                    </td>\n                                </tr>\n                                <tr >\n                                    <td  align=\"center\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                        <a class=\"btn btn-block card-button\" href=\"/restaurants/map\">Karta</a>\n                                    </td>\n                                    <td  align=\"center\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                    </td>\n                                    <td  align=\"center\">\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1110,
        "y": 2060,
        "wires": [
            [
                "9dd31905.0c96b8"
            ]
        ]
    },
    {
        "id": "37bef886.a63238",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 840,
        "y": 2060,
        "wires": [
            [
                "27a7bd39.b82db2"
            ]
        ]
    },
    {
        "id": "bc9dbda9.4a96c",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let slideShowSlides = [];\n        let slideIndex = 0;\n\n        function onDocumentReady()\n        {\n            createSlideShow(5,\"/img/BrantevikRestaurantsPics\");\n            showSlides();\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function createSlideShow(numPics,imageDirectory)\n        {\n            let slidesshowContainer = document.createElement('div');\n            slidesshowContainer.setAttribute('class', 'slideshow-container');\n            for (let ii = 0; ii < numPics; ++ii)\n            {\n                let slideshowSlide = document.createElement('div');\n                slideshowSlide.setAttribute('class', 'slideshowSlides fade');\n                let slideshowSlideImg = document.createElement('img');\n                slideshowSlideImg.setAttribute('src', imageDirectory + '/pic' + (ii + 1).toString() + '.png');\n                slideshowSlideImg.setAttribute('style', 'width:100%');\n                slideshowSlide.appendChild(slideshowSlideImg);\n                slidesshowContainer.appendChild(slideshowSlide);\n                slideShowSlides.push(slideshowSlide);\n            }\n            document.getElementById('slideshow').appendChild(slidesshowContainer);\n            return;\n        }\n        function showSlides() \n        {\n            for (let ii = 0; ii < slideShowSlides.length; ii++)\n            {\n                slideShowSlides[ii].style.display = \"none\";\n            }\n            slideIndex++;\n            if (slideIndex > slideShowSlides.length) {slideIndex = 1}\n            slideShowSlides[slideIndex-1].style.display = \"block\";\n            setTimeout(showSlides, 3000); // Change image every 2 seconds\n        }",
        "output": "str",
        "x": 690,
        "y": 2060,
        "wires": [
            [
                "37bef886.a63238"
            ]
        ]
    },
    {
        "id": "399d3166.42c6ae",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Branteviks Mat och dryck",
        "output": "str",
        "x": 540,
        "y": 2060,
        "wires": [
            [
                "bc9dbda9.4a96c"
            ]
        ]
    },
    {
        "id": "261b1347.119eec",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/restaurants",
        "url": "/restaurants",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 2060,
        "wires": [
            [
                "ed0ab6e3ee4893fe"
            ]
        ]
    },
    {
        "id": "9dd31905.0c96b8",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1250,
        "y": 2060,
        "wires": []
    },
    {
        "id": "27a7bd39.b82db2",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 980,
        "y": 2060,
        "wires": [
            [
                "5fa0eb6f.aaee94"
            ]
        ]
    },
    {
        "id": "cf59bf40.1bc3b",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/restaurants'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Restaurang Karta</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\">\n                                            <iframe src=\"https://www.google.com/maps/d/embed?mid=128ExFR4aP0s5v8THxOPhPdli8jpTdgff\" width=\"800\" height=\"600\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n    ",
        "output": "str",
        "x": 1110,
        "y": 2120,
        "wires": [
            [
                "5eaa88bc.b27358"
            ]
        ]
    },
    {
        "id": "fd58a48b.468718",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 840,
        "y": 2120,
        "wires": [
            [
                "fdfffbff.7fabf8"
            ]
        ]
    },
    {
        "id": "fe395598.7274c8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 690,
        "y": 2120,
        "wires": [
            [
                "fd58a48b.468718"
            ]
        ]
    },
    {
        "id": "e55005cc.7e9a98",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantevik Restauranger Karta ",
        "output": "str",
        "x": 540,
        "y": 2120,
        "wires": [
            [
                "fe395598.7274c8"
            ]
        ]
    },
    {
        "id": "b7fa4959.6e2eb8",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/restaurants/map",
        "url": "/restaurants/map",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 2120,
        "wires": [
            [
                "cb67a67c51d4c615"
            ]
        ]
    },
    {
        "id": "5eaa88bc.b27358",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1250,
        "y": 2120,
        "wires": []
    },
    {
        "id": "fdfffbff.7fabf8",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 980,
        "y": 2120,
        "wires": [
            [
                "cf59bf40.1bc3b"
            ]
        ]
    },
    {
        "id": "ddb57677726f36af",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantevik Vder",
        "output": "str",
        "x": 580,
        "y": 480,
        "wires": [
            [
                "1e6e4ae4db54bdc8"
            ]
        ]
    },
    {
        "id": "1e1bd070a3020c97",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "navBarIcon",
        "field": "payload.navBarIcon",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "BrantevikLogo.png",
        "output": "str",
        "x": 430,
        "y": 480,
        "wires": [
            [
                "ddb57677726f36af"
            ]
        ]
    },
    {
        "id": "fe92e495f7e76265",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/w",
        "url": "/w",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 480,
        "wires": [
            [
                "f8558b390d4d1b7d"
            ]
        ]
    },
    {
        "id": "40d1ca7794c75846",
        "type": "subflow:adce79c2.bd6fa8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1230,
        "y": 560,
        "wires": []
    },
    {
        "id": "1e6e4ae4db54bdc8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(true);\n        programStarted = false;\n\n        function onDocumentReady()\n        {\n\n            $(\"#widgetTable\").attr(\"background\",'img/blinky-webcam/blinky-webcam-01.jpg' +'?t=' + new Date().getTime().toString());\n/*\n            setInterval(function()\n            {\n                $(\"#widgetTable\").attr(\"background\",'img/blinky-webcam/blinky-webcam-01.jpg' +'?t=' + new Date().getTime().toString());\n            }, 180000);\n*/\n        }\n        function onWebSocketOpen()\n        {\n            if (!programStarted)\n            {\n                programStarted = true;\n                var webSocketMsg = \n                {\n                    topic     : 'getDevices',\n                    payload   : {},\n                    userID    : userID,\n                };\n                ws.send(JSON.stringify(webSocketMsg));\n            }\n            else\n            {\n                $(\"#widgetTable\").attr(\"background\",'img/blinky-webcam/blinky-webcam-01.jpg' +'?t=' + new Date().getTime().toString());\n            }\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n            switch(msg.topic)\n            {\n                case 'readings':\n                    var device = JSON.parse(pako.inflate(msg.payload, { to: 'string' }));\n                    device.timeStamp = new Date().getTime();\n                    var time = new Date(device.timeStamp).toLocaleString('en-SE',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit', second: '2-digit'}).replace(',', '');\n                    $('#waterTempDate').text('Brantevik');\n                    if ((device.deviceType == \"blinky-DS18B20\")     && (device.name == \"Brantevik\")) updateWaterTemp(device);\n                    if ((device.deviceType == \"blinky-wind\")     && (device.name == \"Brantevik\"))\n                    {\n                        updateAirTemp(device);\n                    }\n                    break;\n                case 'getDevices':\n                    if (msg.userID == userID)\n                    {\n                        var time = new Date().toLocaleString('en-SE',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit', second: '2-digit'}).replace(',', '');\n                        $('#waterTempDate').text('Brantevik');\n                        updateWaterTemp(msg.payload[0]);\n                        updateAirTemp(msg.payload[1]);\n                     }\n                    break;\n                default:\n                    break;\n            }\n        }\n",
        "output": "str",
        "x": 730,
        "y": 480,
        "wires": [
            [
                "bfa74fca52af109a"
            ]
        ]
    },
    {
        "id": "77f50b2033b0eb02",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n{{{payload.script.updateReadings}}}\n",
        "output": "str",
        "x": 720,
        "y": 560,
        "wires": [
            [
                "9070c845d25ab0c1"
            ]
        ]
    },
    {
        "id": "9070c845d25ab0c1",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div id=\"status\" width=\"100%\" align=\"center\">\n        <table id=\"widgetTable\" width=\"100%\" background=\"/img/blinky-webcam/blinky-webcam-01.jpg\" style=\"background-size:100% 100%;background-repeat:no-repeat;\">\n            <tr >\n                <td align='center' width=\"100%\" style=\"padding-top:11vw;padding-bottom:0vw;\">\n                    <span id=\"waterTempDate\" style=\"font-size: 10vw; color:white;\"></span> \n                </td>\n            </tr>\n            <tr>\n                <td width=\"100%\"  style=\"padding-bottom:25vw;\">\n                    <table width=\"100%\">\n                        <tr >\n                            <td align='left' width=\"40%\" style=\"padding-left:14vw;\">\n                                <span id='airTempLabel' style='font-size: 12vw; color:white;' >Luft</span>\n                            </td>\n                            <td align='right' width=\"60%\" style=\"padding-right:14vw;\"> \n                                <span id='airTemp' style='font-size: 12vw; color:white;' ></span>\n                            </td>\n                        </tr>\n                        <tr >\n                            <td align='left'  width=\"40%\" style=\"padding-left:14vw;\">\n                                <span id='waterTempLabel' style='font-size: 12vw; color:white;' >Vatten</span>\n                            </td>\n                            <td  align='right' width=\"60%\" style=\"padding-right:14vw;\">\n                                <span id='waterTemp' style='font-size: 12vw; color:white;' ></span>\n                            </td>\n                        </tr>\n                    </table>\n                </td>\n            </tr>\n        </table>\n    </div>\n",
        "output": "str",
        "x": 930,
        "y": 560,
        "wires": [
            [
                "7a4dd1eef26baf46"
            ]
        ]
    },
    {
        "id": "bfa74fca52af109a",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.updateReadings",
        "field": "payload.script.updateReadings",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Update Readings Javascript\n        function updateAirTemp(device)\n        {\n            if ((new Date().getTime() - device.timeStamp) < 3600000)\n            {\n                $('#airTemp').text(device.temperature.value.toFixed(1) + ' C');\n            }\n        }\n        function updateWaterTemp(device)\n        {\n            if ((new Date().getTime() - device.timeStamp) < 3600000)\n            {\n                $('#waterTemp').text(device.tempA.value.toFixed(1) + ' C');\n                var level = device.refDistance.value - device.ultraDistanceAvg.value;\n            }\n        }\n",
        "output": "str",
        "x": 760,
        "y": 520,
        "wires": [
            [
                "77f50b2033b0eb02"
            ]
        ]
    },
    {
        "id": "7a4dd1eef26baf46",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "CSS",
        "field": "payload.css",
        "fieldType": "msg",
        "format": "css",
        "syntax": "mustache",
        "template": "        :root \n        {\n          --color1: #415c71;\n          --color2: #547792;\n          --color3: #9eb5c7;\n          --color4: #c6c2bb;\n          --color5: #fdc300;\n          --big-text-size :300%;\n          --bold-text :900;\n          --vert-pad : 25px;\n          --horz-pad : 25px;\n        }\n        body \n        {\n            max-width: 100%;\n            background-color: var(--color1); !important;\n        }\n        img \n        {\n          object-fit: contain;\n        }\n        a\n        {\n            text-decoration: none; \n        }\n        a:visited \n        { \n            text-decoration: none;\n        }\n        a:hover \n        { \n            text-decoration: none; \n        }\n\n        .jumbotron \n        {\n          background-color: var(--color2) !important;\n          color: white;\n          padding-top:25px;\n          padding-bottom:25px;\n        }\n        .jumbotron-title\n        {\n          color:var(--color5);\n        }\n        .jumbotron-button\n        {\n          color: white;\n          background-color: var(--color1);\n       }\n        .card\n        {\n          background-color: var(--color2) !important;\n          text-align: center;\n        }\n        .card-body\n        {\n          background-color: var(--color3);;\n        }\n        .card-button\n        {\n          color: var(--color5) !important;\n          background-color: var(--color1) !important;\n          font-weight: bold;\n        }\n        .card-title\n        {\n          color: var(--color5);\n          font-weight: var(--bold-text);\n          font-size: var(--big-text-size);\n         }\n        .card-text\n        {\n          color: white;\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .danger-card\n        {\n          background-color: yellow !important;\n          text-align: center;\n        }\n        .danger-card-body\n        {\n          background-color: yellow;\n        }\n        .danger-card-button\n        {\n          color: yellow !important;\n          background-color: red !important;\n          font-weight: bold;\n        }\n        .danger-card-title\n        {\n          color: red;\n          font-weight: var(--bold-text);\n          font-size: var(--big-text-size);\n         }\n        .danger-card-text\n        {\n          color: white;\n          text-align: left;\n          font-size: var(--big-text-size);\n        }\n        .tableHeading\n        {\n          color:var(--container-title-color);\n        }\n        .tableText\n        {\n          color:var(--container-text-color);\n          font-size: var(--big-text-size);\n        }\n       .vert-pad\n        {\n            padding-top:var(--vert-pad);;\n            padding-bottom:var(--vert-pad);;\n        }\n        .horz-pad\n        {\n            padding-left:var(--horz-pad);;\n            padding-right:var(--horz-pad);;\n        }\n        .big-text\n        {\n            font-size: var(--big-text-size);\n        }\n        .bold-text\n        {\n            font-weight: var(--bold-text);\n        }\n       .ui-dialog-titlebar-close \n        {\n            visibility: hidden;\n        }\n        input.inputLarger \n        { \n            transform: scale(3); \n            margin: 1px;\n        }\n        .googleSlide4by3-container \n        {\n            position: relative;\n            overflow: hidden;\n            padding-top: 75.0%;\n        }\n        .googleSlide4by3-iframe {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            border: 0;\n        }        \n        .custom-select\n        {\n            color: black;\n            background-color: white;\n            height:80px;\n            line-height:70px;\n        }\n        .button-link \n        {\n            background: none!important;\n            border-type: solid;\n            padding: 2px!important;\n            cursor: pointer;\n        }\n",
        "output": "str",
        "x": 1070,
        "y": 560,
        "wires": [
            [
                "40d1ca7794c75846"
            ]
        ]
    },
    {
        "id": "fe39b6d6b15f3766",
        "type": "websocket in",
        "z": "2b074b3a.632fb4",
        "name": "/w/websocket",
        "server": "4fbbe9375c5eb4a7",
        "client": "",
        "x": 110,
        "y": 760,
        "wires": [
            [
                "2f1b0478.24543c"
            ]
        ]
    },
    {
        "id": "690bd22475a99ce7",
        "type": "websocket out",
        "z": "2b074b3a.632fb4",
        "name": "/w/websocket",
        "server": "4fbbe9375c5eb4a7",
        "client": "",
        "x": 1220,
        "y": 760,
        "wires": []
    },
    {
        "id": "1ea7cffebed6852b",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 480,
        "y": 240,
        "wires": [
            [
                "2eb15a26.4e1336"
            ]
        ]
    },
    {
        "id": "f8558b390d4d1b7d",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 260,
        "y": 480,
        "wires": [
            [
                "1e1bd070a3020c97"
            ]
        ]
    },
    {
        "id": "4ded33c5c3a34424",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 1900,
        "wires": [
            [
                "a66b3aba.c717d8"
            ]
        ]
    },
    {
        "id": "bfc1d1b53ba81b5b",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1780,
        "wires": [
            [
                "d0d22251.c8a21"
            ]
        ]
    },
    {
        "id": "62fb0c57476eb887",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1720,
        "wires": [
            [
                "4c7220ba.e90a2"
            ]
        ]
    },
    {
        "id": "c6f16d2495d42f9b",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1660,
        "wires": [
            [
                "9eac337a.df2a3"
            ]
        ]
    },
    {
        "id": "ac9832e570eb65af",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1600,
        "wires": [
            [
                "1b2f758f.ca89ea"
            ]
        ]
    },
    {
        "id": "90e4237d4ffffd97",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1540,
        "wires": [
            [
                "20f7d092.c524"
            ]
        ]
    },
    {
        "id": "cb5acacfb2667868",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1460,
        "wires": [
            [
                "5d0603af.2d6fec"
            ]
        ]
    },
    {
        "id": "e72b83ab1fccf824",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1400,
        "wires": [
            [
                "87f80e.ac5557f"
            ]
        ]
    },
    {
        "id": "ba3b805eed633709",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1300,
        "wires": [
            [
                "e6619631.b046f8"
            ]
        ]
    },
    {
        "id": "6f5cd19eb00b19ae",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1220,
        "wires": [
            [
                "931efe46.16a55"
            ]
        ]
    },
    {
        "id": "ed0ab6e3ee4893fe",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 2060,
        "wires": [
            [
                "399d3166.42c6ae"
            ]
        ]
    },
    {
        "id": "cb67a67c51d4c615",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 2120,
        "wires": [
            [
                "e55005cc.7e9a98"
            ]
        ]
    },
    {
        "id": "80b0433d849aa7c0",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 2180,
        "wires": [
            [
                "b27eebf6.3f9ad8"
            ]
        ]
    },
    {
        "id": "a8ae5af196f0af35",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 1140,
        "wires": [
            [
                "d8e50beb.98d0b8"
            ]
        ]
    },
    {
        "id": "a0c306616ea83b2d",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"25%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/'>tillbaka</a>\n                                        </td>\n                                        <td width=\"50%\" align=\"center\">\n                                            <span  class='card-title'>Aktiviteter</span>\n                                        </td>\n                                        <td width=\"25%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 800px; height: 600px; overflow:hidden; max-height:600px;\" id=\"slideshow\"></div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'></div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/activities/jaktenHoppet\">Jakten Hoppet</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                    <td  width=\"42.5%\" align=\"center\">\n                                        <a class=\"btn btn-block card-button\" href=\"/activities/musicStars\">Musik</a>\n                                    </td>\n                                    <td  width=\"5%\" align=\"center\">\n                                    </td>\n                                </tr>\n                                <tr >\n                                    <td  align=\"center\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                    </td>\n                                    <td  align=\"center\">\n                                    </td>\n                                    <td  align=\"center\" style=\"padding-top:15px;\">\n                                    </td>\n                                    <td  align=\"center\">\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1110,
        "y": 2280,
        "wires": [
            [
                "479f870468500381"
            ]
        ]
    },
    {
        "id": "799246f6f5a2b4f8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 840,
        "y": 2280,
        "wires": [
            [
                "1f6048acf1146aae"
            ]
        ]
    },
    {
        "id": "580d51858e8f9453",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Branteviks Aktiviteter",
        "output": "str",
        "x": 540,
        "y": 2280,
        "wires": [
            [
                "ecca307d1d6ba633"
            ]
        ]
    },
    {
        "id": "3d57e38a35e885fc",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/activities",
        "url": "/activities",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 2280,
        "wires": [
            [
                "136edfe956dd9dc8"
            ]
        ]
    },
    {
        "id": "479f870468500381",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1250,
        "y": 2280,
        "wires": []
    },
    {
        "id": "1f6048acf1146aae",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 980,
        "y": 2280,
        "wires": [
            [
                "a0c306616ea83b2d"
            ]
        ]
    },
    {
        "id": "136edfe956dd9dc8",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 320,
        "y": 2280,
        "wires": [
            [
                "580d51858e8f9453"
            ]
        ]
    },
    {
        "id": "f477aaa981e2fe74",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/todo/sail'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Jakten Hoppet</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 850px; overflow:hidden; max-height:850px;\">\n                                            <iframe src=\"https://www.jaktenhoppet.com/\"  frameborder=\"0\" width=\"850\" height=\"850\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 1840,
        "wires": [
            [
                "32bfec86c2924b6c"
            ]
        ]
    },
    {
        "id": "798e1611ccbefb39",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 1840,
        "wires": [
            [
                "bf242e400d9fc356"
            ]
        ]
    },
    {
        "id": "24576d567dc45257",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 1840,
        "wires": [
            [
                "798e1611ccbefb39"
            ]
        ]
    },
    {
        "id": "c282e46dc0119888",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Jakten hoppet",
        "output": "str",
        "x": 560,
        "y": 1840,
        "wires": [
            [
                "24576d567dc45257"
            ]
        ]
    },
    {
        "id": "556d110fe94bc167",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/todo/sail/jaktenHoppet",
        "url": "/todo/sail/jaktenHoppet",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 1840,
        "wires": [
            [
                "edacfcf8ed01c0b4"
            ]
        ]
    },
    {
        "id": "32bfec86c2924b6c",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 1840,
        "wires": []
    },
    {
        "id": "bf242e400d9fc356",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 1840,
        "wires": [
            [
                "f477aaa981e2fe74"
            ]
        ]
    },
    {
        "id": "edacfcf8ed01c0b4",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 1840,
        "wires": [
            [
                "c282e46dc0119888"
            ]
        ]
    },
    {
        "id": "146b73e30d6dc5c1",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/activities'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Jakten Hoppet</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1000px; overflow:hidden; max-height:1000px;\">\n                                            <iframe src=\"https://www.jaktenhoppet.com/\"  frameborder=\"0\" width=\"850\" height=\"1000px\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 2360,
        "wires": [
            [
                "1ec9153f763c9333"
            ]
        ]
    },
    {
        "id": "e995d44acff8688e",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 2360,
        "wires": [
            [
                "831cf85f98b1c39b"
            ]
        ]
    },
    {
        "id": "631e0212bdb2e418",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 2360,
        "wires": [
            [
                "e995d44acff8688e"
            ]
        ]
    },
    {
        "id": "c28e362fbe655809",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Jakten hoppet",
        "output": "str",
        "x": 560,
        "y": 2360,
        "wires": [
            [
                "631e0212bdb2e418"
            ]
        ]
    },
    {
        "id": "c2d0318af08d8a37",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/activities/jaktenHoppet",
        "url": "/activities/jaktenHoppet",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 2360,
        "wires": [
            [
                "0317fc156ab417b6"
            ]
        ]
    },
    {
        "id": "1ec9153f763c9333",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 2360,
        "wires": []
    },
    {
        "id": "831cf85f98b1c39b",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 2360,
        "wires": [
            [
                "146b73e30d6dc5c1"
            ]
        ]
    },
    {
        "id": "0317fc156ab417b6",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 2360,
        "wires": [
            [
                "c28e362fbe655809"
            ]
        ]
    },
    {
        "id": "19715895763561f5",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/activities'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Musik under stjrnorna</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1200px; overflow:hidden; max-height:1200px;\">\n                                            <iframe src=\"https://musikunderstjarnorna.se/\"  frameborder=\"0\" width=\"850\" height=\"1200\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 2440,
        "wires": [
            [
                "12d9b4b5bb9473b6"
            ]
        ]
    },
    {
        "id": "6846433bcdbfb7ea",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 2440,
        "wires": [
            [
                "db2d891c1ff73db6"
            ]
        ]
    },
    {
        "id": "9c8fa0a5c6a28e69",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 2440,
        "wires": [
            [
                "6846433bcdbfb7ea"
            ]
        ]
    },
    {
        "id": "2dec0b2926ea05f4",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Musik under stjrnorna",
        "output": "str",
        "x": 560,
        "y": 2440,
        "wires": [
            [
                "9c8fa0a5c6a28e69"
            ]
        ]
    },
    {
        "id": "f9e17854a902711a",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/activities/musicStars",
        "url": "/activities/musicStars",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 2440,
        "wires": [
            [
                "6f5f362387b7a110"
            ]
        ]
    },
    {
        "id": "12d9b4b5bb9473b6",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 2440,
        "wires": []
    },
    {
        "id": "db2d891c1ff73db6",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 2440,
        "wires": [
            [
                "19715895763561f5"
            ]
        ]
    },
    {
        "id": "6f5f362387b7a110",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 2440,
        "wires": [
            [
                "2dec0b2926ea05f4"
            ]
        ]
    },
    {
        "id": "1fd65cec8fc03333",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/restaurants'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Hrnan p Brantevik</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1200px; overflow:hidden; max-height:1200px;\">\n                                            <iframe src=\"https://www.hornanpabrantevik.com/hnder-p-hrnan\"  frameborder=\"0\" width=\"850\" height=\"1200\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 2520,
        "wires": [
            [
                "1190a3eb264aeb70"
            ]
        ]
    },
    {
        "id": "66abc14ab2c3cbbd",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 2520,
        "wires": [
            [
                "b7a9fd9ec42b9d55"
            ]
        ]
    },
    {
        "id": "9676bf17bfac04e8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 2520,
        "wires": [
            [
                "66abc14ab2c3cbbd"
            ]
        ]
    },
    {
        "id": "7dd80ee6bec9e0d6",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Hrnan p Brantevik",
        "output": "str",
        "x": 560,
        "y": 2520,
        "wires": [
            [
                "9676bf17bfac04e8"
            ]
        ]
    },
    {
        "id": "6c7c07941da4b87e",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/restaurants/hornans",
        "url": "/restaurants/hornans",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 2520,
        "wires": [
            [
                "55759b2d2e92ee42"
            ]
        ]
    },
    {
        "id": "1190a3eb264aeb70",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 2520,
        "wires": []
    },
    {
        "id": "b7a9fd9ec42b9d55",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 2520,
        "wires": [
            [
                "1fd65cec8fc03333"
            ]
        ]
    },
    {
        "id": "55759b2d2e92ee42",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 2520,
        "wires": [
            [
                "7dd80ee6bec9e0d6"
            ]
        ]
    },
    {
        "id": "9712066e4324de90",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/restaurants'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Hrnan p Brantevik</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1200px; overflow:hidden; max-height:1200px;\">\n                                            <iframe src=\"https://www.hornanpabrantevik.com/hnder-p-hrnan\"  frameborder=\"0\" width=\"850\" height=\"1200\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 2600,
        "wires": [
            [
                "f4a2305a9e296853"
            ]
        ]
    },
    {
        "id": "8c2bb1c427ac45ea",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 2600,
        "wires": [
            [
                "91f2547743e277da"
            ]
        ]
    },
    {
        "id": "4646854789a77ed2",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 2600,
        "wires": [
            [
                "8c2bb1c427ac45ea"
            ]
        ]
    },
    {
        "id": "08867a3c0593cfe5",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Hrnan p Brantevik",
        "output": "str",
        "x": 560,
        "y": 2600,
        "wires": [
            [
                "4646854789a77ed2"
            ]
        ]
    },
    {
        "id": "e228f3affa8a01e7",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/restaurants/hornans",
        "url": "/restaurants/hornans",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 2600,
        "wires": [
            [
                "ac61d606497b4872"
            ]
        ]
    },
    {
        "id": "f4a2305a9e296853",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 2600,
        "wires": []
    },
    {
        "id": "91f2547743e277da",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 2600,
        "wires": [
            [
                "9712066e4324de90"
            ]
        ]
    },
    {
        "id": "ac61d606497b4872",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 2600,
        "wires": [
            [
                "08867a3c0593cfe5"
            ]
        ]
    },
    {
        "id": "964a203e0bf5cd74",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/restaurants'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Branteviks Fisk</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1200px; overflow:hidden; max-height:1200px;\">\n                                            <iframe src=\"https://www.branteviksfisk.se/\"  frameborder=\"0\" width=\"850\" height=\"1200\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 2680,
        "wires": [
            [
                "49948b35301c2e1a"
            ]
        ]
    },
    {
        "id": "214331d00aa4c6b5",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 2680,
        "wires": [
            [
                "10c4dbf216501871"
            ]
        ]
    },
    {
        "id": "942ec4d740c8bf8f",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 2680,
        "wires": [
            [
                "214331d00aa4c6b5"
            ]
        ]
    },
    {
        "id": "47857160c197b50e",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Branteviks Fisk",
        "output": "str",
        "x": 560,
        "y": 2680,
        "wires": [
            [
                "942ec4d740c8bf8f"
            ]
        ]
    },
    {
        "id": "a0aeea4f1b7b5bfb",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/restaurants/bfisk",
        "url": "/restaurants/bfisk",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 2680,
        "wires": [
            [
                "8a6f74a77cf2e873"
            ]
        ]
    },
    {
        "id": "49948b35301c2e1a",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 2680,
        "wires": []
    },
    {
        "id": "10c4dbf216501871",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 2680,
        "wires": [
            [
                "964a203e0bf5cd74"
            ]
        ]
    },
    {
        "id": "8a6f74a77cf2e873",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 2680,
        "wires": [
            [
                "47857160c197b50e"
            ]
        ]
    },
    {
        "id": "3636f6fbc071a595",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/restaurants'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Bobergs p Hamngrden</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1200px; overflow:hidden; max-height:1200px;\">\n                                            <iframe src=\"https://www.hamngarden.se/eat-bobergs\"  frameborder=\"0\" width=\"850\" height=\"1200\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 2760,
        "wires": [
            [
                "3a7340a415853234"
            ]
        ]
    },
    {
        "id": "86789d91e5fd9240",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 2760,
        "wires": [
            [
                "e26410a3be33e777"
            ]
        ]
    },
    {
        "id": "549484deff2a617d",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 2760,
        "wires": [
            [
                "86789d91e5fd9240"
            ]
        ]
    },
    {
        "id": "5665f5834b3fd33a",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Bobergs p Hamngrden",
        "output": "str",
        "x": 560,
        "y": 2760,
        "wires": [
            [
                "549484deff2a617d"
            ]
        ]
    },
    {
        "id": "53a03325d9dd5009",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/restaurants/bobergs",
        "url": "/restaurants/bobergs",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 2760,
        "wires": [
            [
                "767cc7133b0c9a33"
            ]
        ]
    },
    {
        "id": "3a7340a415853234",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 2760,
        "wires": []
    },
    {
        "id": "e26410a3be33e777",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 2760,
        "wires": [
            [
                "3636f6fbc071a595"
            ]
        ]
    },
    {
        "id": "767cc7133b0c9a33",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 2760,
        "wires": [
            [
                "5665f5834b3fd33a"
            ]
        ]
    },
    {
        "id": "7e2206b84a6ab073",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/restaurants'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Brantergen</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1200px; overflow:hidden; max-height:1200px;\">\n                                            <iframe src=\"https://www.branterogen.se/\"  frameborder=\"0\" width=\"850\" height=\"1200\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 2840,
        "wires": [
            [
                "3d13a2a42a334a28"
            ]
        ]
    },
    {
        "id": "168d6e6d6d787d1a",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 2840,
        "wires": [
            [
                "a8bc3c2e44050595"
            ]
        ]
    },
    {
        "id": "2a988de96873a899",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 2840,
        "wires": [
            [
                "168d6e6d6d787d1a"
            ]
        ]
    },
    {
        "id": "7f177522c74e45d4",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantergen",
        "output": "str",
        "x": 560,
        "y": 2840,
        "wires": [
            [
                "2a988de96873a899"
            ]
        ]
    },
    {
        "id": "526f1c3cd0bb64f5",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/restaurants/branterogen",
        "url": "/restaurants/branterogen",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 2840,
        "wires": [
            [
                "47cddb697e791202"
            ]
        ]
    },
    {
        "id": "3d13a2a42a334a28",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 2840,
        "wires": []
    },
    {
        "id": "a8bc3c2e44050595",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 2840,
        "wires": [
            [
                "7e2206b84a6ab073"
            ]
        ]
    },
    {
        "id": "47cddb697e791202",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 2840,
        "wires": [
            [
                "7f177522c74e45d4"
            ]
        ]
    },
    {
        "id": "ecca307d1d6ba633",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let slideShowSlides = [];\n        let slideIndex = 0;\n\n        function onDocumentReady()\n        {\n            createSlideShow(10,\"/img/BrantevikThingsToDoPics\");\n            showSlides();\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function createSlideShow(numPics,imageDirectory)\n        {\n            let slidesshowContainer = document.createElement('div');\n            slidesshowContainer.setAttribute('class', 'slideshow-container');\n            for (let ii = 0; ii < numPics; ++ii)\n            {\n                let slideshowSlide = document.createElement('div');\n                slideshowSlide.setAttribute('class', 'slideshowSlides fade');\n                let slideshowSlideImg = document.createElement('img');\n                slideshowSlideImg.setAttribute('src', imageDirectory + '/pic' + (ii + 1).toString() + '.png');\n                slideshowSlideImg.setAttribute('style', 'width:100%');\n                slideshowSlide.appendChild(slideshowSlideImg);\n                slidesshowContainer.appendChild(slideshowSlide);\n                slideShowSlides.push(slideshowSlide);\n            }\n            document.getElementById('slideshow').appendChild(slidesshowContainer);\n            return;\n        }\n        function showSlides() \n        {\n            for (let ii = 0; ii < slideShowSlides.length; ii++)\n            {\n                slideShowSlides[ii].style.display = \"none\";\n            }\n            slideIndex++;\n            if (slideIndex > slideShowSlides.length) {slideIndex = 1}\n            slideShowSlides[slideIndex-1].style.display = \"block\";\n            setTimeout(showSlides, 3000); // Change image every 2 seconds\n        }",
        "output": "str",
        "x": 690,
        "y": 2280,
        "wires": [
            [
                "799246f6f5a2b4f8"
            ]
        ]
    },
    {
        "id": "8bfc46018aaf1fe5",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let slideShowSlides = [];\n        let slideIndex = 0;\n\n        function onDocumentReady()\n        {\n            createSlideShow(14,\"/img/BrantevikCyclingPics\");\n            showSlides();\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function createSlideShow(numPics,imageDirectory)\n        {\n            let slidesshowContainer = document.createElement('div');\n            slidesshowContainer.setAttribute('class', 'slideshow-container');\n            for (let ii = 0; ii < numPics; ++ii)\n            {\n                let slideshowSlide = document.createElement('div');\n                slideshowSlide.setAttribute('class', 'slideshowSlides fade');\n                let slideshowSlideImg = document.createElement('img');\n                slideshowSlideImg.setAttribute('src', imageDirectory + '/pic' + (ii + 1).toString() + '.png');\n                slideshowSlideImg.setAttribute('style', 'width:100%');\n                slideshowSlide.appendChild(slideshowSlideImg);\n                slidesshowContainer.appendChild(slideshowSlide);\n                slideShowSlides.push(slideshowSlide);\n            }\n            document.getElementById('slideshow').appendChild(slidesshowContainer);\n            return;\n        }\n        function showSlides() \n        {\n            for (let ii = 0; ii < slideShowSlides.length; ii++)\n            {\n                slideShowSlides[ii].style.display = \"none\";\n            }\n            slideIndex++;\n            if (slideIndex > slideShowSlides.length) {slideIndex = 1}\n            slideShowSlides[slideIndex-1].style.display = \"block\";\n            setTimeout(showSlides, 3000); // Change image every 2 seconds\n        }",
        "output": "str",
        "x": 710,
        "y": 1540,
        "wires": [
            [
                "583d5d9.c3c7da4"
            ]
        ]
    },
    {
        "id": "da5a963203c34c2f",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let slideShowSlides = [];\n        let slideIndex = 0;\n\n        function onDocumentReady()\n        {\n            createSlideShow(10,\"/img/BrantevikSwimmingPics\");\n            showSlides();\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function createSlideShow(numPics,imageDirectory)\n        {\n            let slidesshowContainer = document.createElement('div');\n            slidesshowContainer.setAttribute('class', 'slideshow-container');\n            for (let ii = 0; ii < numPics; ++ii)\n            {\n                let slideshowSlide = document.createElement('div');\n                slideshowSlide.setAttribute('class', 'slideshowSlides fade');\n                let slideshowSlideImg = document.createElement('img');\n                slideshowSlideImg.setAttribute('src', imageDirectory + '/pic' + (ii + 1).toString() + '.png');\n                slideshowSlideImg.setAttribute('style', 'width:100%');\n                slideshowSlide.appendChild(slideshowSlideImg);\n                slidesshowContainer.appendChild(slideshowSlide);\n                slideShowSlides.push(slideshowSlide);\n            }\n            document.getElementById('slideshow').appendChild(slidesshowContainer);\n            return;\n        }\n        function showSlides() \n        {\n            for (let ii = 0; ii < slideShowSlides.length; ii++)\n            {\n                slideShowSlides[ii].style.display = \"none\";\n            }\n            slideIndex++;\n            if (slideIndex > slideShowSlides.length) {slideIndex = 1}\n            slideShowSlides[slideIndex-1].style.display = \"block\";\n            setTimeout(showSlides, 3000); // Change image every 2 seconds\n        }",
        "output": "str",
        "x": 710,
        "y": 1400,
        "wires": [
            [
                "9ab6cfa7.9c10c"
            ]
        ]
    },
    {
        "id": "61eaeeafc0b3f6c5",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let slideShowSlides = [];\n        let slideIndex = 0;\n\n        function onDocumentReady()\n        {\n            createSlideShow(22,\"/img/GronetPics\");\n            showSlides();\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function createSlideShow(numPics,imageDirectory)\n        {\n            let slidesshowContainer = document.createElement('div');\n            slidesshowContainer.setAttribute('class', 'slideshow-container');\n            for (let ii = 0; ii < numPics; ++ii)\n            {\n                let slideshowSlide = document.createElement('div');\n                slideshowSlide.setAttribute('class', 'slideshowSlides fade');\n                let slideshowSlideImg = document.createElement('img');\n                slideshowSlideImg.setAttribute('src', imageDirectory + '/pic' + (ii + 1).toString() + '.png');\n                slideshowSlideImg.setAttribute('style', 'width:100%');\n                slideshowSlide.appendChild(slideshowSlideImg);\n                slidesshowContainer.appendChild(slideshowSlide);\n                slideShowSlides.push(slideshowSlide);\n            }\n            document.getElementById('slideshow').appendChild(slidesshowContainer);\n            return;\n        }\n        function showSlides() \n        {\n            for (let ii = 0; ii < slideShowSlides.length; ii++)\n            {\n                slideShowSlides[ii].style.display = \"none\";\n            }\n            slideIndex++;\n            if (slideIndex > slideShowSlides.length) {slideIndex = 1}\n            slideShowSlides[slideIndex-1].style.display = \"block\";\n            setTimeout(showSlides, 3000); // Change image every 2 seconds\n        }",
        "output": "str",
        "x": 710,
        "y": 1720,
        "wires": [
            [
                "90f09e1a.646b1"
            ]
        ]
    },
    {
        "id": "2dbd1d09b863686b",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let slideShowSlides = [];\n        let slideIndex = 0;\n\n        function onDocumentReady()\n        {\n            createSlideShow(21,\"/img/SailingPics\");\n            showSlides();\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function createSlideShow(numPics,imageDirectory)\n        {\n            let slidesshowContainer = document.createElement('div');\n            slidesshowContainer.setAttribute('class', 'slideshow-container');\n            for (let ii = 0; ii < numPics; ++ii)\n            {\n                let slideshowSlide = document.createElement('div');\n                slideshowSlide.setAttribute('class', 'slideshowSlides fade');\n                let slideshowSlideImg = document.createElement('img');\n                slideshowSlideImg.setAttribute('src', imageDirectory + '/pic' + (ii + 1).toString() + '.png');\n                slideshowSlideImg.setAttribute('style', 'width:100%');\n                slideshowSlide.appendChild(slideshowSlideImg);\n                slidesshowContainer.appendChild(slideshowSlide);\n                slideShowSlides.push(slideshowSlide);\n            }\n            document.getElementById('slideshow').appendChild(slidesshowContainer);\n            return;\n        }\n        function showSlides() \n        {\n            for (let ii = 0; ii < slideShowSlides.length; ii++)\n            {\n                slideShowSlides[ii].style.display = \"none\";\n            }\n            slideIndex++;\n            if (slideIndex > slideShowSlides.length) {slideIndex = 1}\n            slideShowSlides[slideIndex-1].style.display = \"block\";\n            setTimeout(showSlides, 3000); // Change image every 2 seconds\n        }",
        "output": "str",
        "x": 710,
        "y": 1780,
        "wires": [
            [
                "ec093ff7.10a48"
            ]
        ]
    },
    {
        "id": "04220470e2deb0c5",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n        let slideShowSlides = [];\n        let slideIndex = 0;\n\n        function onDocumentReady()\n        {\n            createSlideShow(4,\"/img/MuseumShowPics\");\n            showSlides();\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n        function createSlideShow(numPics,imageDirectory)\n        {\n            let slidesshowContainer = document.createElement('div');\n            slidesshowContainer.setAttribute('class', 'slideshow-container');\n            for (let ii = 0; ii < numPics; ++ii)\n            {\n                let slideshowSlide = document.createElement('div');\n                slideshowSlide.setAttribute('class', 'slideshowSlides fade');\n                let slideshowSlideImg = document.createElement('img');\n                slideshowSlideImg.setAttribute('src', imageDirectory + '/pic' + (ii + 1).toString() + '.png');\n                slideshowSlideImg.setAttribute('style', 'width:100%');\n                slideshowSlide.appendChild(slideshowSlideImg);\n                slidesshowContainer.appendChild(slideshowSlide);\n                slideShowSlides.push(slideshowSlide);\n            }\n            document.getElementById('slideshow').appendChild(slidesshowContainer);\n            return;\n        }\n        function showSlides() \n        {\n            for (let ii = 0; ii < slideShowSlides.length; ii++)\n            {\n                slideShowSlides[ii].style.display = \"none\";\n            }\n            slideIndex++;\n            if (slideIndex > slideShowSlides.length) {slideIndex = 1}\n            slideShowSlides[slideIndex-1].style.display = \"block\";\n            setTimeout(showSlides, 3000); // Change image every 2 seconds\n        }",
        "output": "str",
        "x": 690,
        "y": 1900,
        "wires": [
            [
                "4c690f46.ed348"
            ]
        ]
    },
    {
        "id": "4414ad8d3c06984c",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/restaurants/branterogen'>Meny</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Brantergen</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1200px; overflow:hidden; max-height:1200px;\">\n                                            <img src=\"https://docs.google.com/drawings/d/e/2PACX-1vRXLAuSPLJao3NCNZmBV-CKdavVcc0_zO9bT9MbtpuRodjqQst5_XLj7xDJkIXOUq3DUYFkHHJbIKam/pub?w=800&amp;h=1200\">\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 2900,
        "wires": [
            [
                "a1b515aa37cd97ec"
            ]
        ]
    },
    {
        "id": "79adbb84ef795de0",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 2900,
        "wires": [
            [
                "7609387d3e4184c6"
            ]
        ]
    },
    {
        "id": "71582c0b18b4bfc6",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 2900,
        "wires": [
            [
                "79adbb84ef795de0"
            ]
        ]
    },
    {
        "id": "c6330547ac8e5733",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Brantergen",
        "output": "str",
        "x": 560,
        "y": 2900,
        "wires": [
            [
                "71582c0b18b4bfc6"
            ]
        ]
    },
    {
        "id": "43e61c8bfa0620f5",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/restaurants/branterogenHeadline",
        "url": "/restaurants/branterogenHeadline",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 170,
        "y": 2900,
        "wires": [
            [
                "96c06acbe4811339"
            ]
        ]
    },
    {
        "id": "a1b515aa37cd97ec",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 2900,
        "wires": []
    },
    {
        "id": "7609387d3e4184c6",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 2900,
        "wires": [
            [
                "4414ad8d3c06984c"
            ]
        ]
    },
    {
        "id": "96c06acbe4811339",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 400,
        "y": 2900,
        "wires": [
            [
                "c6330547ac8e5733"
            ]
        ]
    },
    {
        "id": "6e32e73da03d062c",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "    <div width=\"100%\" align=\"center\">\n        <table width=\"900px\">\n            <tr >\n                <td  width=\"100%\" style=\"padding-top:10px;\">\n                    <div class='card'>\n                        <div class='row'>\n                            <div class='col-md-12'>\n                                <table width=\"100%\">\n                                    <tr>\n                                        <td width=\"20%\" align=\"left\" style=\"padding-left:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a class=\"btn back-button\" href='/'>tillbaka</a>\n                                        </td>\n                                        <td width=\"60%\" align=\"center\">\n                                            <span  class='card-title'>Samhllsfrening</span>\n                                        </td>\n                                        <td width=\"20%\" align=\"right\" style=\"padding-right:20px;padding-top:10px;padding-bottom:10px;\">\n                                            <a href='/'><img src=\"/img/home.png\" height=\"70px\"/></a>\n                                        </td>\n                                   </tr>\n                                </table>\n                             </div>\n                        </div>\n                        <div class='card-body' align=\"center\">\n                            <table width=\"100%\" align=\"center\">\n                                <tr >\n                                    <td  width=\"100%\" align=\"center\">\n                                        <div style=\"width: 850px; height: 1200px; overflow:hidden; max-height:1200px;\">\n                                            <iframe src=\"https://www.brantevik.se/\"  frameborder=\"0\" width=\"850\" height=\"1200\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"></iframe>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n{{{payload.mailfooter}}}\n",
        "output": "str",
        "x": 1130,
        "y": 3000,
        "wires": [
            [
                "373d065162fe540b"
            ]
        ]
    },
    {
        "id": "cc854f3780bc9fc8",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "javascript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "{{{payload.script.global}}}\n",
        "output": "str",
        "x": 860,
        "y": 3000,
        "wires": [
            [
                "6906bddcc864c830"
            ]
        ]
    },
    {
        "id": "377570f810780280",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "script.global",
        "field": "payload.script.global",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "// Global Javascript\n        useWebSockets(false);\n\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n",
        "output": "str",
        "x": 710,
        "y": 3000,
        "wires": [
            [
                "cc854f3780bc9fc8"
            ]
        ]
    },
    {
        "id": "8b92f9f669c05e92",
        "type": "template",
        "z": "2b074b3a.632fb4",
        "name": "Set Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Branteviks Samhllsfrening",
        "output": "str",
        "x": 560,
        "y": 3000,
        "wires": [
            [
                "377570f810780280"
            ]
        ]
    },
    {
        "id": "8ef4c9f1c3f1c0ce",
        "type": "http in",
        "z": "2b074b3a.632fb4",
        "name": "/bsf",
        "url": "/bsf",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 3000,
        "wires": [
            [
                "0ee39c1dcef93858"
            ]
        ]
    },
    {
        "id": "373d065162fe540b",
        "type": "subflow:d7162906.0afcd8",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 1270,
        "y": 3000,
        "wires": []
    },
    {
        "id": "6906bddcc864c830",
        "type": "subflow:698c1306.31662c",
        "z": "2b074b3a.632fb4",
        "x": 1000,
        "y": 3000,
        "wires": [
            [
                "6e32e73da03d062c"
            ]
        ]
    },
    {
        "id": "0ee39c1dcef93858",
        "type": "subflow:3fec913b325ae6ff",
        "z": "2b074b3a.632fb4",
        "name": "",
        "x": 360,
        "y": 3000,
        "wires": [
            [
                "8b92f9f669c05e92"
            ]
        ]
    },
    {
        "id": "5d93334c.7b160c",
        "type": "inject",
        "z": "e17f7487.2a78e8",
        "name": "project",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "project",
        "payload": "PROJECT",
        "payloadType": "env",
        "x": 100,
        "y": 60,
        "wires": [
            [
                "e06b15ee.c3bf78"
            ]
        ]
    },
    {
        "id": "e06b15ee.c3bf78",
        "type": "function",
        "z": "e17f7487.2a78e8",
        "name": "Save Project Name",
        "func": "global.set(msg.topic,msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 280,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "4caf3fb1.f3572",
        "type": "inject",
        "z": "e17f7487.2a78e8",
        "name": "maxDbSize",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "maxDbSize",
        "payload": "MAXDBSIZE",
        "payloadType": "env",
        "x": 100,
        "y": 120,
        "wires": [
            [
                "2208dd06.5d2ba2"
            ]
        ]
    },
    {
        "id": "2208dd06.5d2ba2",
        "type": "function",
        "z": "e17f7487.2a78e8",
        "name": "Save maxDbSize",
        "func": "global.set(msg.topic,Number(msg.payload));\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 320,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "c7984811.67e8f8",
        "type": "inject",
        "z": "e17f7487.2a78e8",
        "name": "ipRefWeb",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "ipRefWeb",
        "payload": "IPREFWEB",
        "payloadType": "env",
        "x": 90,
        "y": 180,
        "wires": [
            [
                "daa5f679.c0a968"
            ]
        ]
    },
    {
        "id": "daa5f679.c0a968",
        "type": "function",
        "z": "e17f7487.2a78e8",
        "name": "Save ipRefWeb",
        "func": "global.set(msg.topic,msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 310,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "2666eb47.cb2c24",
        "type": "http in",
        "z": "90f83725.6dae08",
        "name": "/access-log",
        "url": "/access-log",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 120,
        "wires": [
            [
                "0d2c724aedf49eca"
            ]
        ]
    },
    {
        "id": "c41bff2c.e8b63",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "Body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- Body HTML -->\n    <div id='querySetup'>\n        <div class='row'>\n            <div class='col-md-12'>\n                <table id='plotSetupTable'>\n                    <tr>\n                        <td align=\"center\">\n                            <span>Start Date</span>\n                        </td>\n                        <td align=\"center\">\n                            <span>Stop Date</span>\n                        </td>\n                        <td align=\"center\">\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"center\">\n                            <input class=\"form-control\" id=\"startDate\" type=\"text\"/>\n                        </td>\n                        <td align=\"center\">\n                            <input class=\"form-control\" id=\"stopDate\" type=\"text\"/>\n                        </td>\n                        <td align=\"center\">\n                            <button width=100% class=\"btn jumbotron-button\" id=\"getDataButton\" type=\"button\" onclick=\"getData()\">Get Data</button>\n                        </td>\n                    </tr>\n                </table>\n                <table width='100%' id='accessLogTable'>\n                    <thead>\n                        <tr>\n                            <th width='10%'>url</th>\n                            <th width='10%'>ip</th>\n                            <th width='7%' >country</th>\n                            <th width='6%' >region</th>\n                            <th width='7%' >city</th>\n                            <th width='20%'>rdns</th>\n                            <th width='10%'>isp</th>\n                            <th width='10%'>Date</th>\n                            <th width='10%'>Time</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"accessLogTableBody\"></tbody>\n                </table>\n            </div>\n       </div>\n    </div>\n",
        "output": "str",
        "x": 1030,
        "y": 120,
        "wires": [
            [
                "56402369.244bec"
            ]
        ]
    },
    {
        "id": "56402369.244bec",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Access Log",
        "output": "str",
        "x": 1150,
        "y": 120,
        "wires": [
            [
                "e4c1258f.54e248"
            ]
        ]
    },
    {
        "id": "3836124.ae654ee",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "JavaScript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "        useWebSockets(true);\n        function onDocumentReady()\n        {\n            var now = new Date();\n            console.log(now.toLocaleString('en-US',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit'}).replace(',', ''));\n            var then = new Date(now.getTime() - 3600 * 24 * 1000);\n            $( \"#startDate\" ).val(then.toLocaleString('en-US',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit'}).replace(',', ''));\n            $( \"#stopDate\" ).val(now.toLocaleString('en-US',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit'}).replace(',', ''));\n            $( function()\n            {\n                $('#startDate').datetimepicker();\n            } );\n            $( function()\n            {\n                $('#stopDate').datetimepicker();\n            } );\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n            if (msg.userID == userID)\n            {\n                switch(msg.topic)\n                {\n                    case 'getAccessLog':\n                        displayData(msg);\n                        break;\n                    case 'permissionError':\n                        acknowledgeDialog('Permission', 'Error', msg.payload);\n                        break;\n                    case 'loginExpired':\n                        location.reload();\n                        break;\n                    default:\n                    // code block\n                }\n            }\n        }\n        function getData()\n        {\n            var startDate = new Date($( \"#startDate\" ).val()).getTime();\n            var stopDate = new Date($( \"#stopDate\" ).val()).getTime();\n            $(\"#accessLogTableBody\").remove();\n            var actionMsg = \n                {\n                    startDate   : startDate,\n                    stopDate    : stopDate,\n                };\n            sendActionMsg('getAccessLog', 'readDatabase', actionMsg);\n\n        }\n        function displayData(msg)\n        {\n            console.log(msg)\n            var markup = '<tbody id=\"accessLogTableBody\">';\n            for (var ii = 0; ii < msg.payload.length; ++ii)\n            {\n                markup = markup + addRow(msg.payload[ii]);\n            }\n            markup = markup + '</tbody>';\n            $(\"#accessLogTable\").append(markup);\n        }\n\n        function addRow(record)\n        {\n            var markup = '<tr>';\n            markup = markup + '<td>' + record.url + '</td>';\n            markup = markup + '<td>' + record.ip + '</td>';\n            markup = markup + '<td>' + record.country + '</td>';\n            markup = markup + '<td>' + record.region + '</td>';\n            markup = markup + '<td>' + record.city + '</td>';\n            markup = markup + '<td>' + record.rdns + '</td>';\n            markup = markup + '<td>' + record.isp + '</td>';\n            markup = markup + '<td>' + new Date(record.timeStamp).toLocaleDateString() + '</td>';\n            markup = markup + '<td>' + new Date(record.timeStamp).toLocaleTimeString() + '</td>';\n            markup = markup + '</tr>';\n            return markup;\n            \n        }\n",
        "output": "str",
        "x": 890,
        "y": 120,
        "wires": [
            [
                "c41bff2c.e8b63"
            ]
        ]
    },
    {
        "id": "47b50e0.c7354f4",
        "type": "websocket in",
        "z": "90f83725.6dae08",
        "name": "/access-log/websocket",
        "server": "47794345.2e8b8c",
        "client": "",
        "x": 160,
        "y": 200,
        "wires": [
            [
                "d29bdb5c.25fd58"
            ]
        ]
    },
    {
        "id": "b9aba820.9dbf78",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Setup AccessLog Query",
        "func": "var projectionFilter =  \n{\n    projection:\n    {\n        _id : 0, \n    } \n};\nvar queryFilter = \n{\n    timeStamp :\n    {\n        $gte: msg.payload.startDate,\n        $lte: msg.payload.stopDate\n    }\n}\nvar newMsg = \n{\n    topic           : 'getAccessLog',\n    userID          : msg.userID,\n    payload         : [queryFilter, projectionFilter],\n};\nreturn newMsg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 650,
        "y": 200,
        "wires": [
            [
                "aef63175.9e1f7"
            ]
        ]
    },
    {
        "id": "aef63175.9e1f7",
        "type": "mongodb3 in",
        "z": "90f83725.6dae08",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "accessLog",
        "operation": "find.toArray",
        "x": 920,
        "y": 200,
        "wires": [
            [
                "c60d9fa2.da0d4"
            ]
        ]
    },
    {
        "id": "c60d9fa2.da0d4",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Sort Archive Data",
        "func": "function objectLength( object ) {\n    var length = 0;\n    for( var key in object ) {\n        if( object.hasOwnProperty(key) ) {\n            ++length;\n        }\n    }\n    return length;\n}\n\nfunction sortByKey(arr, key) \n{\n    return arr.sort( function(a, b) \n        {\n            var x = a[key]; \n            var y = b[key];\n            return ((x < y) ? 1 : ((x > y) ? -1 : 0));\n        } );\n}\n\nvar numRecords = objectLength(msg.payload);\nif (numRecords < 1)\n{\n    return {\n        topic : msg.device.name,\n        payload:{\n            topic           : 'getAccessLog',\n            payload         : null,\n            userID          : msg.userID,\n        }\n    };\n}\nvar records = [];\nfor (var ii = 0; ii < numRecords; ++ii) records[ii] = msg.payload[ii]; \nsortByKey(records, 'timeStamp');\n\nreturn {\n    payload:{\n        topic           : 'getAccessLog',\n        payload         : records,\n        userID          : msg.userID,\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1170,
        "y": 200,
        "wires": [
            [
                "7a08c826.6c9ca8"
            ]
        ]
    },
    {
        "id": "7a08c826.6c9ca8",
        "type": "websocket out",
        "z": "90f83725.6dae08",
        "name": "/access-log/websocket",
        "server": "47794345.2e8b8c",
        "client": "",
        "x": 1380,
        "y": 200,
        "wires": []
    },
    {
        "id": "7db6e983.ea0948",
        "type": "http in",
        "z": "90f83725.6dae08",
        "name": "/settings-log",
        "url": "/settings-log",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 300,
        "wires": [
            [
                "d717c30bb68bca37"
            ]
        ]
    },
    {
        "id": "207a1450.67f23c",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "Body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- Body HTML -->\n    <div id='querySetup'>\n        <div class='row'>\n            <div class='col-md-12'>\n                <table id='plotSetupTable'>\n                    <tr>\n                        <td align=\"center\">\n                            <span>Start Date</span>\n                        </td>\n                        <td align=\"center\">\n                            <span>Stop Date</span>\n                        </td>\n                        <td align=\"center\">\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"center\">\n                            <input class=\"form-control\" id=\"startDate\" type=\"text\"/>\n                        </td>\n                        <td align=\"center\">\n                            <input class=\"form-control\" id=\"stopDate\" type=\"text\"/>\n                        </td>\n                        <td align=\"center\">\n                            <button width=100% class=\"btn jumbotron-button\" id=\"getDataButton\" type=\"button\" onclick=\"getData()\">Get Data</button>\n                        </td>\n                    </tr>\n                </table>\n                <table width='100%' id='settingsLogTable'>\n                    <thead>\n                        <tr>\n                            <th width='10%' >url</th>\n                            <th width='10%' >device</th>\n                            <th width='10%' >ip</th>\n                            <th width='7%'  >country</th>\n                            <th width='6%'  >region</th>\n                            <th width='7%'  >city</th>\n                            <th width='20%' >rdns</th>\n                            <th width='10%' >isp</th>\n                            <th width='10%' >Date</th>\n                            <th width='10%' >Time</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"settingsLogTableBody\"></tbody>\n                </table>\n            </div>\n       </div>\n   </div>\n    <div id=\"showDeviceDialog\" title=\"Device\" class='card'>\n        <p class='card-title' id='showDeviceDialogName'>Device</p>\n        <div class='card-body'>\n            <table id='showDeviceTable' width='100%'>\n                <thead>\n                    <tr>\n                        <th width='50%' >Attribute</th>\n                        <th width='50%' >Value</th>\n                    </tr>\n                </thead>\n                <tbody id=\"showDeviceTableBody\"></tbody>\n            </table>\n        </div>\n    </div>  ",
        "output": "str",
        "x": 1010,
        "y": 300,
        "wires": [
            [
                "c3c60f3c.51f22"
            ]
        ]
    },
    {
        "id": "c3c60f3c.51f22",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Settings Log",
        "output": "str",
        "x": 1130,
        "y": 300,
        "wires": [
            [
                "1f057b8c.e3a574"
            ]
        ]
    },
    {
        "id": "78d16800.4adc18",
        "type": "websocket in",
        "z": "90f83725.6dae08",
        "name": "/settings-log/websocket",
        "server": "fcd0f0f1.e1a0f",
        "client": "",
        "x": 160,
        "y": 380,
        "wires": [
            [
                "2f50dfa8.90179"
            ]
        ]
    },
    {
        "id": "8d3e512a.420f",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Setup SettingsLog Query",
        "func": "var projectionFilter =  \n{\n    projection:\n    {\n        _id : 0, \n    } \n};\nvar queryFilter = \n{\n    timeStamp :\n    {\n        $gte: msg.payload.startDate,\n        $lte: msg.payload.stopDate\n    }\n}\nvar newMsg = \n{\n    topic           : 'getSettingsLog',\n    userID          : msg.userID,\n    payload         : [queryFilter, projectionFilter],\n};\nreturn newMsg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 650,
        "y": 380,
        "wires": [
            [
                "ce493245.30ca8"
            ]
        ]
    },
    {
        "id": "ce493245.30ca8",
        "type": "mongodb3 in",
        "z": "90f83725.6dae08",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "settingsLog",
        "operation": "find.toArray",
        "x": 920,
        "y": 380,
        "wires": [
            [
                "e1eb29b.c5c23d8"
            ]
        ]
    },
    {
        "id": "e1eb29b.c5c23d8",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Sort Archive Data",
        "func": "function objectLength( object ) {\n    var length = 0;\n    for( var key in object ) {\n        if( object.hasOwnProperty(key) ) {\n            ++length;\n        }\n    }\n    return length;\n}\n\nfunction sortByKey(arr, key) \n{\n    return arr.sort( function(a, b) \n        {\n            var x = a[key]; \n            var y = b[key];\n            return ((x < y) ? 1 : ((x > y) ? -1 : 0));\n        } );\n}\n\nvar numRecords = objectLength(msg.payload);\nif (numRecords < 1)\n{\n    return {\n        topic : msg.device.name,\n        payload:{\n            topic           : 'getSettingsLog',\n            payload         : null,\n            userID          : msg.userID,\n        }\n    };\n}\nvar records = [];\nfor (var ii = 0; ii < numRecords; ++ii) records[ii] = msg.payload[ii]; \nsortByKey(records, 'timeStamp');\n\nreturn {\n    payload:{\n        topic           : 'getSettingsLog',\n        payload         : records,\n        userID          : msg.userID,\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1170,
        "y": 380,
        "wires": [
            [
                "89be3294.49e69"
            ]
        ]
    },
    {
        "id": "89be3294.49e69",
        "type": "websocket out",
        "z": "90f83725.6dae08",
        "name": "/settings-log/websocket",
        "server": "fcd0f0f1.e1a0f",
        "client": "",
        "x": 1390,
        "y": 380,
        "wires": []
    },
    {
        "id": "3ff05971.6144b6",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "JavaScript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "        var settingsHistory = null;\n        useWebSockets(true);\n        function onDocumentReady()\n        {\n            var now = new Date();\n            console.log(now.toLocaleString('en-US',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit'}).replace(',', ''));\n            var then = new Date(now.getTime() - 3600 * 24 * 1000);\n            $( \"#startDate\" ).val(then.toLocaleString('en-US',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit'}).replace(',', ''));\n            $( \"#stopDate\" ).val(now.toLocaleString('en-US',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit'}).replace(',', ''));\n            $( function()\n            {\n                $('#startDate').datetimepicker();\n            } );\n            $( function()\n            {\n                $('#stopDate').datetimepicker();\n            } );\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n            if (msg.userID == userID)\n            {\n                switch(msg.topic)\n                {\n                    case 'getSettingsLog':\n                        settingsHistory = msg.payload;\n                        displayData();\n                        break;\n                    case 'permissionError':\n                        acknowledgeDialog('Permission', 'Error', msg.payload);\n                        break;\n                    case 'loginExpired':\n                        location.reload();\n                        break;\n                    default:\n                    // code block\n                }\n            }\n        }\n        function getData()\n        {\n            var startDate = new Date($( \"#startDate\" ).val()).getTime();\n            var stopDate = new Date($( \"#stopDate\" ).val()).getTime();\n            settingsHistory = null;\n            $(\"#settingsLogTableBody\").remove();\n            var actionMsg = \n                {\n                    startDate   : startDate,\n                    stopDate    : stopDate,\n                };\n            sendActionMsg('getSettingsLog', 'readDatabase', actionMsg);\n        }\n        function displayData()\n        {\n            var markup = '<tbody id=\"settingsLogTableBody\">';\n            for (var ii = 0; ii < settingsHistory.length; ++ii)\n            {\n                markup = markup + addRow(ii);\n            }\n            markup = markup + '</tbody>';\n            $(\"#settingsLogTable\").append(markup);\n        }\n\n        function addRow(ii)\n        {\n            var markup = '<tr>';\n            markup = markup + '<td>' + settingsHistory[ii].ipInfo.url + '</td>';\n            markup = markup + '<td>' \n                +  '<button onclick=\"displayDevice(' + ii.toString() + ')\">' + settingsHistory[ii].device.deviceType  + '-' + settingsHistory[ii].device.name + '</button>' \n                + '</td>';\n            markup = markup + '<td>' + settingsHistory[ii].ipInfo.ip + '</td>';\n            markup = markup + '<td>' + settingsHistory[ii].ipInfo.country + '</td>';\n            markup = markup + '<td>' + settingsHistory[ii].ipInfo.region + '</td>';\n            markup = markup + '<td>' + settingsHistory[ii].ipInfo.city + '</td>';\n            markup = markup + '<td>' + settingsHistory[ii].ipInfo.rdns + '</td>';\n            markup = markup + '<td>' + settingsHistory[ii].ipInfo.isp + '</td>';\n            markup = markup + '<td>' + new Date(settingsHistory[ii].timeStamp).toLocaleDateString() + '</td>';\n            markup = markup + '<td>' + new Date(settingsHistory[ii].timeStamp).toLocaleTimeString() + '</td>';\n            markup = markup + '</tr>';\n            return markup;\n            \n        }\n        function displayDevice(index)\n        {\n            var actionArray = [];\n            var attrList = [];\n            var keys = Object.keys(settingsHistory[index].device);\n            for (var ii = 0; ii < keys.length; ++ii)\n            {\n                if (settingsHistory[index].device[keys[ii]].hasOwnProperty('type'))\n                {\n                    if (settingsHistory[index].device[keys[ii]].type == 'scalar')\n                    {\n                        if (settingsHistory[index].device[keys[ii]].action == 'setting')\n                        {\n                            actionArray.push(settingsHistory[index].device[keys[ii]]);\n                            attrList.push(keys[ii]);\n                        }\n                    }\n                }\n            }\n\n            var time = new Date(settingsHistory[index].timeStamp).toLocaleString('en-US',{year: 'numeric', month: '2-digit', day : '2-digit', hour12:false, hour: '2-digit', minute: '2-digit'}).replace(',', '');\n\n            $( \"#showDeviceDialogName\" ).html(settingsHistory[index].device.name + ' ' + time);\n            $( \"#showDeviceTableBody\" ).remove();\n            var markup = '<tbody id=\"showDeviceTableBody\">';\n\n            for (var ii = 0; ii < actionArray.length; ++ii)\n            {\n                markup = markup +'<tr>';\n                markup = markup + '<td align=\"left\">' + attrList[ii] + '</td>';\n                markup = markup + '<td>' + actionArray[ii].value.toString() + '</td>';\n                markup = markup + '</tr>';\n            }\n            markup = markup + '</tbody>';\n            $(\"#showDeviceTable\").append(markup);\n\n            $( \"#showDeviceDialog\" ).dialog( \"option\", \"title\", \"Device Setting\"); \n            $( \"#showDeviceDialog\" ).dialog( \"open\" );\n        }\n        $( function() \n        {\n            $( \"#showDeviceDialog\" ).dialog(\n                {\n//                    closeOnEscape: false,\n//                    open: function(event, ui) {$(\".ui-dialog-titlebar-close\", ui.dialog | ui).hide();},\n                    width:    640,\n                    autoOpen: false,\n                    buttons:\n                    [\n                        {\n                            text: \"Close\",\n                            click: function() {$( this ).dialog( \"close\" );},\n                            showText: false\n                        }\n                    ]\n                });\n        } );\n",
        "output": "str",
        "x": 870,
        "y": 300,
        "wires": [
            [
                "207a1450.67f23c"
            ]
        ]
    },
    {
        "id": "e4c1258f.54e248",
        "type": "subflow:f22a539a.a67b3",
        "z": "90f83725.6dae08",
        "name": "",
        "x": 1290,
        "y": 120,
        "wires": []
    },
    {
        "id": "1f057b8c.e3a574",
        "type": "subflow:f22a539a.a67b3",
        "z": "90f83725.6dae08",
        "name": "",
        "x": 1270,
        "y": 300,
        "wires": []
    },
    {
        "id": "3dbc8e22.aafca2",
        "type": "http in",
        "z": "90f83725.6dae08",
        "name": "/process-login",
        "url": "/process-login",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 620,
        "wires": [
            [
                "2623a5b9.60e51a"
            ]
        ]
    },
    {
        "id": "c7dcd2fd.f38ec",
        "type": "mongodb3 in",
        "z": "90f83725.6dae08",
        "service": "_ext_",
        "configNode": "9cd5ff5e.caf86",
        "name": "",
        "collection": "users",
        "operation": "findOne",
        "x": 510,
        "y": 620,
        "wires": [
            [
                "d0b46e62.c61f3"
            ]
        ]
    },
    {
        "id": "2623a5b9.60e51a",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "user query",
        "func": "msg.userData = {cred : {}, url : msg.payload.url};\nmsg.userData.cred = \n{\n    username : msg.payload.username, \n    password : msg.payload.password,\n};\nmsg.payload =  [{username : msg.userData.cred.username },  {projection  :{_id :   0}}]\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 310,
        "y": 620,
        "wires": [
            [
                "c7dcd2fd.f38ec"
            ]
        ]
    },
    {
        "id": "d0b46e62.c61f3",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Check username",
        "func": "function isEmpty(obj) {\n    for(var key in obj) {\n        if(obj.hasOwnProperty(key))\n            return false;\n    }\n    return true;\n}\nif (isEmpty(msg.payload))\n{\n    delete msg.userData['cred'];\n    msg.payload.errorMsg = 'Error: User not found';\n    return [msg, null];\n}\nvar pwcheck = \n{\n    \"topic\"     : \"checkPassword\",\n    \"txt\"       : msg.userData.cred.password,\n    \"hash\"      : msg.payload.password\n}\nmsg.payload.profile['expDate'] = -1;\nif ( msg.payload.profile.timeoutMin > 0)\n{\n    msg.payload.profile['expDate'] = new Date().getTime() + msg.payload.profile.timeoutMin * 60000;\n}\nmsg.payload.profile['username'] = msg.payload.username;\nmsg.userData.cred.profile = msg.payload.profile;\nmsg.payload = pwcheck;\nreturn [null,msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 730,
        "y": 620,
        "wires": [
            [
                "d1cf61fb.35fc1"
            ],
            [
                "2497b9a4.db7a46"
            ]
        ]
    },
    {
        "id": "2497b9a4.db7a46",
        "type": "bcrypt",
        "z": "90f83725.6dae08",
        "name": "decrypt password",
        "action": "verify",
        "field": "payload.txt",
        "hash": "payload.hash",
        "rounds": 10,
        "x": 930,
        "y": 660,
        "wires": [
            [
                "25cbcda4.aaf522"
            ]
        ]
    },
    {
        "id": "25cbcda4.aaf522",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Check password",
        "func": "if (msg.match == false)  \n{\n    delete msg.userData['cred'];\n    msg.payload.errorMsg = 'Error: Invalid password';\n    return [msg, null];\n\n}\nmsg.payload = msg.userData.cred.profile;\ndelete msg.userData['cred'];\ndelete msg['match'];\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1130,
        "y": 660,
        "wires": [
            [
                "abf9b132.7c298"
            ],
            [
                "3abe79d2.fee286"
            ]
        ]
    },
    {
        "id": "3abe79d2.fee286",
        "type": "JsonWebToken",
        "z": "90f83725.6dae08",
        "name": "get Token",
        "tokenconfig": "6acefdd9.69f124",
        "x": 940,
        "y": 740,
        "wires": [
            [
                "26477e37.472222"
            ]
        ]
    },
    {
        "id": "c10f4686.4bfa58",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "Body",
        "field": "payload.body",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!-- Body HTML -->\n    <h1 style=\"text-align:center;color:#415c71;\">{{{payload.errorMsg}}}</h1>\n    <form action=\"/process-login\" method=\"POST\">\n        <table align='center'>\n            <tr>\n                <td>\n                    <label for=\"username\" class=\"big-text\">User</label>\n                </td>\n                <td>\n                    <input name=\"username\" type=\"text\" class=\"big-text\"/>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label for=\"password\" class=\"big-text\">Password</label>\n                </td>\n                <td>\n                    <input name=\"password\" type=\"password\" class=\"big-text\"/>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                </td>\n                <td>\n                    <input type=\"submit\" class=\"btn jumbotron-button btn-block big-text bold-text\"/>\n                </td>\n            </tr>\n        </table>    \n        <input type=\"hidden\" name=\"url\" value=\"{{{userData.url}}}\" />\n    </form>  ",
        "output": "str",
        "x": 630,
        "y": 520,
        "wires": [
            [
                "67f4ab6d.c1fd04"
            ]
        ]
    },
    {
        "id": "7e91110a.c2165",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "Title",
        "field": "payload.title",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "Log-in",
        "output": "str",
        "x": 350,
        "y": 520,
        "wires": [
            [
                "5a857f25.a6af6"
            ]
        ]
    },
    {
        "id": "aff12a21.2e53c8",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "JavaScript",
        "field": "payload.javascript",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "        useWebSockets(false);\n        function onDocumentReady()\n        {\n        }\n        function onWebSocketOpen()\n        {\n        }\n        function onWebSocketClose()\n        {\n            \n        }\n        function onWebSocketMessage(msg)\n        {\n        }\n\n",
        "output": "str",
        "x": 210,
        "y": 520,
        "wires": [
            [
                "7e91110a.c2165"
            ]
        ]
    },
    {
        "id": "67f4ab6d.c1fd04",
        "type": "subflow:8341090a.df9758",
        "z": "90f83725.6dae08",
        "name": "",
        "x": 770,
        "y": 520,
        "wires": []
    },
    {
        "id": "5a857f25.a6af6",
        "type": "template",
        "z": "90f83725.6dae08",
        "name": "navBarIcon",
        "field": "payload.navBarIcon",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "basicYellow.png",
        "output": "str",
        "x": 490,
        "y": 520,
        "wires": [
            [
                "c10f4686.4bfa58"
            ]
        ]
    },
    {
        "id": "26477e37.472222",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Set project cookie",
        "func": "msg.cookies = { };\nmsg.cookies[global.get('project') + 'Role'] = msg.token;\nmsg.cookies[global.get('project') + 'Username'] = msg.payload.username;\nmsg.cookies[global.get('project') + 'ExpDate'] = msg.payload.expDate;\nmsg.statusCode = 302;\nmsg.headers = {};\nmsg.headers.location = '/'\nvar previousUrl = msg.userData.url;\nif(previousUrl == undefined)\n{\n    msg.headers.location = '/'\n}\nelse\n{\n    msg.headers.location = previousUrl;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1110,
        "y": 740,
        "wires": [
            [
                "fee60e7.48d0cf"
            ]
        ]
    },
    {
        "id": "fee60e7.48d0cf",
        "type": "http response",
        "z": "90f83725.6dae08",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1270,
        "y": 740,
        "wires": []
    },
    {
        "id": "e322d811.8b4178",
        "type": "link in",
        "z": "90f83725.6dae08",
        "name": "Login Error",
        "links": [
            "d1cf61fb.35fc1",
            "abf9b132.7c298"
        ],
        "x": 75,
        "y": 520,
        "wires": [
            [
                "aff12a21.2e53c8"
            ]
        ]
    },
    {
        "id": "d1cf61fb.35fc1",
        "type": "link out",
        "z": "90f83725.6dae08",
        "name": "No User",
        "links": [
            "e322d811.8b4178"
        ],
        "x": 855,
        "y": 600,
        "wires": []
    },
    {
        "id": "abf9b132.7c298",
        "type": "link out",
        "z": "90f83725.6dae08",
        "name": "Bad Password",
        "links": [
            "e322d811.8b4178"
        ],
        "x": 1315,
        "y": 620,
        "wires": []
    },
    {
        "id": "44733e49.ba7ec",
        "type": "subflow:495f0879.c831c8",
        "z": "90f83725.6dae08",
        "name": "",
        "x": 700,
        "y": 120,
        "wires": [
            [
                "3836124.ae654ee"
            ]
        ]
    },
    {
        "id": "64665cab.c46c24",
        "type": "subflow:495f0879.c831c8",
        "z": "90f83725.6dae08",
        "name": "",
        "env": [],
        "x": 690,
        "y": 300,
        "wires": [
            [
                "3ff05971.6144b6"
            ]
        ]
    },
    {
        "id": "1e9bf28b.344d8d",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Allowed Roles",
        "func": "msg.payload.allowedRoles = ['coreView'];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 500,
        "y": 120,
        "wires": [
            [
                "44733e49.ba7ec"
            ]
        ]
    },
    {
        "id": "b213f397.94307",
        "type": "function",
        "z": "90f83725.6dae08",
        "name": "Allowed Roles",
        "func": "msg.payload.allowedRoles = ['coreView'];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 500,
        "y": 300,
        "wires": [
            [
                "64665cab.c46c24"
            ]
        ]
    },
    {
        "id": "d29bdb5c.25fd58",
        "type": "subflow:fee416c.fb205e8",
        "z": "90f83725.6dae08",
        "name": "",
        "x": 390,
        "y": 200,
        "wires": [
            [
                "b9aba820.9dbf78"
            ],
            [
                "6b0f35.479560cc"
            ]
        ]
    },
    {
        "id": "6b0f35.479560cc",
        "type": "link out",
        "z": "90f83725.6dae08",
        "name": "Access Log Permission check",
        "links": [
            "29e4a.7f1061b68"
        ],
        "x": 535,
        "y": 240,
        "wires": []
    },
    {
        "id": "29e4a.7f1061b68",
        "type": "link in",
        "z": "90f83725.6dae08",
        "name": "Access Log Websocket in",
        "links": [
            "6b0f35.479560cc"
        ],
        "x": 1255,
        "y": 240,
        "wires": [
            [
                "7a08c826.6c9ca8"
            ]
        ]
    },
    {
        "id": "2f50dfa8.90179",
        "type": "subflow:fee416c.fb205e8",
        "z": "90f83725.6dae08",
        "name": "",
        "x": 390,
        "y": 380,
        "wires": [
            [
                "8d3e512a.420f"
            ],
            [
                "96bdbbff.532998"
            ]
        ]
    },
    {
        "id": "96bdbbff.532998",
        "type": "link out",
        "z": "90f83725.6dae08",
        "name": "Settings Log Permission check",
        "links": [
            "ad5167e6.cd9ed8"
        ],
        "x": 535,
        "y": 420,
        "wires": []
    },
    {
        "id": "ad5167e6.cd9ed8",
        "type": "link in",
        "z": "90f83725.6dae08",
        "name": "Settings Log Websocket in",
        "links": [
            "96bdbbff.532998"
        ],
        "x": 1255,
        "y": 420,
        "wires": [
            [
                "89be3294.49e69"
            ]
        ]
    },
    {
        "id": "0d2c724aedf49eca",
        "type": "subflow:3fec913b325ae6ff",
        "z": "90f83725.6dae08",
        "name": "",
        "x": 300,
        "y": 120,
        "wires": [
            [
                "1e9bf28b.344d8d"
            ]
        ]
    },
    {
        "id": "d717c30bb68bca37",
        "type": "subflow:3fec913b325ae6ff",
        "z": "90f83725.6dae08",
        "name": "",
        "x": 300,
        "y": 300,
        "wires": [
            [
                "b213f397.94307"
            ]
        ]
    }
]